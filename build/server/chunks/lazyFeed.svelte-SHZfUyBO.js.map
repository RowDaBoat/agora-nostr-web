{"version":3,"file":"lazyFeed.svelte-SHZfUyBO.js","sources":["../../../.svelte-kit/adapter-node/chunks/lazyFeed.svelte.js"],"sourcesContent":["import \"clsx\";\nimport { a as attr_class, s as stringify } from \"./index2.js\";\nfunction LoadingSpinner($$renderer, $$props) {\n  $$renderer.component(($$renderer2) => {\n    const { size = \"md\", class: className = \"\" } = $$props;\n    const sizeClasses = {\n      xs: \"w-3 h-3\",\n      sm: \"w-4 h-4\",\n      md: \"w-6 h-6\",\n      lg: \"w-8 h-8\",\n      xl: \"w-12 h-12\"\n    }[size];\n    const borderWidth = {\n      xs: \"border\",\n      sm: \"border-2\",\n      md: \"border-2\",\n      lg: \"border-3\",\n      xl: \"border-4\"\n    }[size];\n    $$renderer2.push(`<div${attr_class(`inline-block ${stringify(sizeClasses)} ${stringify(borderWidth)} border-current border-t-transparent rounded-full animate-spin ${stringify(className)}`)} role=\"status\" aria-label=\"Loading\"><span class=\"sr-only\">Loading...</span></div>`);\n  });\n}\nfunction LoadMoreTrigger($$renderer, $$props) {\n  $$renderer.component(($$renderer2) => {\n    const { onIntersect, hasMore, isLoading = false } = $$props;\n    if (\n      // Trigger 200px before reaching the element\n      hasMore\n    ) {\n      $$renderer2.push(\"<!--[-->\");\n      $$renderer2.push(`<div class=\"p-4 text-center\">`);\n      if (isLoading) {\n        $$renderer2.push(\"<!--[-->\");\n        LoadingSpinner($$renderer2, { size: \"md\" });\n      } else {\n        $$renderer2.push(\"<!--[!-->\");\n        $$renderer2.push(`<button class=\"px-4 py-2 text-muted-foreground hover:text-muted-foreground transition-colors\">Load more</button>`);\n      }\n      $$renderer2.push(`<!--]--></div>`);\n    } else {\n      $$renderer2.push(\"<!--[!-->\");\n    }\n    $$renderer2.push(`<!--]-->`);\n  });\n}\nfunction createLazyFeed(ndk, configGetter, options = {}) {\n  const { initialLimit = 20, pageSize = 20 } = options;\n  let subscription = ndk.$subscribe(configGetter);\n  let displayLimit = initialLimit;\n  let frozenEvents = [];\n  let pendingEvents = [];\n  const visibleEvents = frozenEvents.slice(0, displayLimit);\n  const hasMore = displayLimit < frozenEvents.length;\n  const isLoading = !subscription.eosed;\n  function loadMore() {\n    if (hasMore) {\n      displayLimit = Math.min(displayLimit + pageSize, frozenEvents.length);\n    }\n  }\n  function loadPendingEvents() {\n    if (pendingEvents.length > 0) {\n      const pendingCount = pendingEvents.length;\n      frozenEvents = [...pendingEvents, ...frozenEvents];\n      pendingEvents = [];\n      displayLimit = displayLimit + pendingCount;\n    }\n  }\n  return {\n    get events() {\n      return visibleEvents;\n    },\n    get allEvents() {\n      return frozenEvents;\n    },\n    get pendingEvents() {\n      return pendingEvents;\n    },\n    get hasMore() {\n      return hasMore;\n    },\n    get isLoading() {\n      return isLoading;\n    },\n    get eosed() {\n      return subscription.eosed;\n    },\n    get count() {\n      return subscription.count;\n    },\n    get totalCount() {\n      return frozenEvents.length;\n    },\n    get visibleCount() {\n      return visibleEvents.length;\n    },\n    get pendingCount() {\n      return pendingEvents.length;\n    },\n    loadMore,\n    loadPendingEvents\n  };\n}\nexport {\n  LoadMoreTrigger as L,\n  createLazyFeed as c\n};\n"],"names":[],"mappings":"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"}