import{d as Je,f,a as l,c as pe,s as E,b as de}from"./CvdcXPsy.js";import{p as Ke,s as Q,b as ge,u as je,a as _,c as r,d as n,t as k,e as Qe,g as e,r as o,f as w,h as G,n as ae}from"./-h67YDCL.js";import{i as g}from"./DG6c9x1x.js";import{e as xe}from"./DBJvd_ZN.js";import{a as he,p as Xe}from"./DoDeW8UU.js";import{s as O,a as se,b as Ze}from"./vjiKTA8K.js";import{b as et}from"./ByH5JKyU.js";import{p as _e}from"./6dG0wjw8.js";import{g as we}from"./D1jhUNbu.js";import{n as W,s as a,r as le,i as tt,A as rt}from"./CAJmB2zv.js";import{u as ie}from"./Xqq2-EA3.js";import{c as Fe}from"./BClDDyYv.js";import{f as ot}from"./ClJwdCiS.js";import{R as ne}from"./DKHnPTm-.js";var at=f('<div class="text-xs text-muted-foreground truncate"> </div>'),st=f('<div class="px-2 py-1"><button class="w-full px-3 py-2.5 rounded-lg bg-muted/50 transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div> <svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button></div> <div class="border-t border-border my-1"></div>',1),lt=de('<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),it=f('<button><svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <div class="flex-1"><div class="font-medium text-foreground">Following</div> <div class="text-xs text-muted-foreground">All posts from people you follow</div></div> <!></button>'),nt=f('<div class="border-t border-border my-1"></div>'),dt=f('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),vt=f('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),ct=de('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),ft=f('<button><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div> <!></button>'),ut=f('<!> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Follow Packs</div> <!></div>',1),mt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),pt=f('<button class="w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <svg class="w-3.5 h-3.5 text-primary flex-shrink-0" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div></button>'),gt=f('<div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium flex items-center justify-between"><span>Favorite Relays</span> <svg class="w-3 h-3 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div>',1),xt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),ht=de('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),_t=f('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div> <!></button>'),wt=f('<!> <!> <!> <!> <div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Agoras</div> <!></div> <div class="border-t border-border mt-1"><a href="/relay-feeds" class="block w-full px-4 py-2.5 text-sm text-center text-primary hover:bg-muted transition-colors">Browse Interesting Relays</a></div>',1),yt=f('<img alt=""/>'),kt=f('<div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),bt=de('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>'),Rt=f('<span class="font-medium flex-1 text-left whitespace-nowrap overflow-hidden text-ellipsis"> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',1),Mt=f('<div class="absolute left-0 mt-1 w-64 bg-popover border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),Ct=f('<div class="w-80 bg-card border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),zt=f('<div class="relative"><button><!> <!></button>  <!></div>');function Dt(Be,X){Ke(X,!0);const Z=_e(X,"active",3,!1),ve=_e(X,"collapsed",3,!1),F=_e(X,"iconOnly",3,!1);let M=Q(!1),ee=Q(null),te=Q(ge({top:0,left:0,width:0}));const Le=w(()=>W.$sessions?.follows||[]),Pe=w(()=>e(Le).size>0),ye=w(()=>!!W.$currentUser&&e(Pe));let re=Q(ge([])),oe=Q(ge([]));je(()=>{const i=ot.favoritePacks;if(i.length===0){_(re,[],!0);return}Promise.all(i.map(t=>W.fetchEvent(t))).then(t=>{_(re,t.filter(h=>h!==null),!0)}).catch(t=>{console.error("Failed to fetch favorite packs:",t),_(re,[],!0)})}),je(()=>{if(!W.$currentUser){_(oe,[],!0);return}W.fetchEvents({kinds:[39089],authors:[W.$currentUser.pubkey]}).then(i=>{_(oe,Array.from(i),!0)}).catch(i=>{console.error("Failed to fetch user packs:",i),_(oe,[],!0)})});const ce=w(()=>{const i=new Map;for(const t of e(oe))i.set(t.id,t);for(const t of e(re))i.set(t.id,t);return Array.from(i.values())}),ke=w(()=>!a.selectedRelay||N(a.selectedRelay)?null:ie(a.selectedRelay));function N(i){return i?.startsWith("followpack:")??!1}const Y=w(()=>{if(!a.selectedRelay||!N(a.selectedRelay))return null;const i=a.selectedRelay.replace("followpack:","");return e(ce).find(t=>t.id===i||t.encode()===i)}),be=w(()=>N(a.selectedRelay)&&e(Y)?e(Y).tagValue("title")||"Untitled Pack":a.selectedRelay&&e(ke)?.info?.name?e(ke).info.name:a.selectedRelay?a.selectedRelay.replace("wss://","").replace("ws://",""):"Following");function Ie(){if(Z()||F()){if(!e(M)&&e(ee)&&!F()){const i=e(ee).getBoundingClientRect();_(te,{top:i.bottom+4,left:i.left,width:i.width},!0)}_(M,!e(M))}else we("/")}function Ve(i){a.setSelectedRelay(i),_(M,!1)}function Ae(){a.setSelectedRelay(null),_(M,!1)}function Se(i){a.setSelectedRelay(`followpack:${i}`),_(M,!1)}function Re(){_(M,!1)}var fe=zt();{const i=t=>{var h=wt(),C=G(h);{var I=u=>{const v=w(()=>ie(a.selectedRelay));var b=st(),R=G(b),x=r(R);x.__click=()=>{_(M,!1),we(`/?relay=${encodeURIComponent(a.selectedRelay)}`)};var y=r(x);ne(y,{get relayUrl(){return a.selectedRelay},size:"md"});var p=n(y,2),c=r(p),D=r(c,!0);o(c);var A=n(c,2);{var S=z=>{var L=at(),m=r(L,!0);o(L),k(()=>E(m,e(v).info.description)),l(z,L)};g(A,z=>{e(v).info?.description&&z(S)})}o(p),ae(2),o(x),o(R),ae(2),k(z=>E(D,z),[()=>e(v).info?.name||a.selectedRelay.replace("wss://","").replace("ws://","")]),l(u,b)};g(C,u=>{a.selectedRelay&&!N(a.selectedRelay)&&!le?.isFavorite(a.selectedRelay)&&!tt(a.selectedRelay)&&u(I)})}var B=n(C,2);{var d=u=>{var v=it();v.__click=Ae;var b=n(r(v),4);{var R=x=>{var y=lt();l(x,y)};g(b,x=>{a.selectedRelay||x(R)})}o(v),k(()=>O(v,1,`w-full px-4 py-3 hover:bg-muted transition-colors text-left flex items-center gap-3 ${a.selectedRelay?"":"bg-muted/50"}`)),l(u,v)};g(B,u=>{e(ye)&&u(d)})}var s=n(B,2);{var V=u=>{var v=ut(),b=G(v);{var R=p=>{var c=nt();l(p,c)};g(b,p=>{e(ye)&&p(R)})}var x=n(b,2),y=n(r(x),2);xe(y,17,()=>e(ce),p=>p.id,(p,c)=>{const D=w(()=>e(c).tagValue("title")||"Untitled Pack"),A=w(()=>e(c).tagValue("image")),S=w(()=>e(c).tagValue("description")),z=w(()=>e(c).tags.filter(j=>j[0]==="p").length),L=w(()=>N(a.selectedRelay)&&e(Y)?.id===e(c).id);var m=ft();m.__click=()=>Se(e(c).id);var P=r(m);{var H=j=>{var T=dt();k(()=>se(T,"src",e(A))),l(j,T)},J=j=>{var T=vt();l(j,T)};g(P,j=>{e(A)?j(H):j(J,!1)})}var K=n(P,2),me=r(K),Te=r(me,!0);o(me);var ze=n(me,2),We=r(ze,!0);o(ze),o(K);var Ye=n(K,2);{var qe=j=>{var T=ct();l(j,T)};g(Ye,j=>{e(L)&&j(qe)})}o(m),k(()=>{O(m,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${e(L)?"bg-muted/50":""}`),E(Te,e(D)),E(We,e(S)||`${e(z)} members`)}),l(p,m)}),o(x),l(u,v)};g(s,u=>{e(ce).length>0&&u(V)})}var $=n(s,2);{var q=u=>{var v=gt(),b=n(G(v),2),R=n(r(b),2);xe(R,16,()=>le.relays,x=>x,(x,y)=>{const p=w(()=>ie(y));var c=pt();c.__click=()=>{_(M,!1),we(`/?relay=${encodeURIComponent(y)}`)};var D=r(c);ne(D,{get relayUrl(){return y},size:"md"});var A=n(D,2),S=r(A),z=r(S),L=r(z,!0);o(z),ae(2),o(S);var m=n(S,2);{var P=H=>{var J=mt(),K=r(J,!0);o(J),k(()=>E(K,e(p).info.description)),l(H,J)};g(m,H=>{e(p).info?.description&&H(P)})}o(A),o(c),k(H=>E(L,H),[()=>e(p).info?.name||y.replace("wss://","").replace("ws://","")]),l(x,c)}),o(b),l(u,v)};g($,u=>{le&&le.relays.length>0&&u(q)})}var ue=n($,4),Ge=n(r(ue),2);xe(Ge,16,()=>rt,u=>u,(u,v)=>{const b=w(()=>ie(v));var R=_t();R.__click=()=>Ve(v);var x=r(R);ne(x,{get relayUrl(){return v},size:"md"});var y=n(x,2),p=r(y),c=r(p),D=r(c,!0);o(c),ae(2),o(p);var A=n(p,2);{var S=m=>{var P=xt(),H=r(P,!0);o(P),k(()=>E(H,e(b).info.description)),l(m,P)};g(A,m=>{e(b).info?.description&&m(S)})}o(y);var z=n(y,2);{var L=m=>{var P=ht();l(m,P)};g(z,m=>{a.selectedRelay===v&&m(L)})}o(R),k(m=>{O(R,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${a.selectedRelay===v?"bg-muted/50":""}`),E(D,m)},[()=>e(b).info?.name||v.replace("wss://","").replace("ws://","")]),l(u,R)}),o(ue);var Ce=n(ue,2),Ne=r(Ce);Ne.__click=()=>_(M,!1),o(Ce),l(t,h)};var U=r(fe);U.__click=Ie;var Me=r(U);{var He=t=>{var h=pe(),C=G(h);{var I=d=>{var s=yt();k(V=>{se(s,"src",V),O(s,1,`${F()?"w-5 h-5":"w-6 h-6"} rounded flex-shrink-0`)},[()=>e(Y).tagValue("image")]),l(d,s)},B=d=>{var s=kt(),V=r(s);o(s),k(()=>{O(s,1,`${F()?"w-5 h-5":"w-6 h-6"} rounded bg-primary flex items-center justify-center flex-shrink-0`),O(V,0,`${F()?"w-3 h-3":"w-4 h-4"} text-foreground`)}),l(d,s)};g(C,d=>{e(Y)?.tagValue("image")?d(I):d(B,!1)})}l(t,h)},Ee=t=>{var h=pe(),C=G(h);{var I=d=>{{let s=w(()=>F()?"md":"lg");ne(d,{get relayUrl(){return a.selectedRelay},get size(){return e(s)}})}},B=d=>{var s=bt();k(()=>O(s,0,F()?"w-5 h-5 text-muted-foreground":"w-6 h-6")),l(d,s)};g(C,d=>{a.selectedRelay?d(I):d(B,!1)},!0)}l(t,h)};g(Me,t=>{N(a.selectedRelay)?t(He):t(Ee,!1)})}var Oe=n(Me,2);{var Ue=t=>{var h=Rt(),C=G(h),I=r(C,!0);o(C);var B=n(C,2);k(()=>{E(I,e(be)),O(B,0,`w-4 h-4 transition-transform ${e(M)?"rotate-180":""}`)}),l(t,h)};g(Oe,t=>{!ve()&&!F()&&t(Ue)})}o(U),et(U,t=>_(ee,t),()=>e(ee));var $e=n(U,2);{var De=t=>{var h=pe(),C=G(h);{var I=d=>{var s=Mt(),V=r(s);i(V),o(s),he(s,($,q)=>Fe?.($,q),()=>Re),l(d,s)},B=d=>{var s=Ct(),V=r(s);i(V),o(s),he(s,$=>Xe?.($)),he(s,($,q)=>Fe?.($,q),()=>Re),k(()=>Ze(s,`position: fixed; top: ${e(te).top??""}px; left: ${e(te).left??""}px; min-width: ${e(te).width??""}px;`)),l(d,s)};g(C,d=>{F()?d(I):d(B,!1)})}l(t,h)};g($e,t=>{e(M)&&(Z()||F())&&t(De)})}o(fe),k(()=>{O(U,1,F()?"flex items-center justify-center w-8 h-8 rounded-full hover:bg-muted/50 transition-colors":ve()?"flex items-center justify-center p-3 rounded-lg transition-colors w-full "+(Z()?"text-primary bg-primary/10 text-primary":"text-foreground hover:bg-muted/50"):"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors w-full "+(Z()?"text-primary bg-primary/10":"text-foreground hover:bg-muted/50")),se(U,"aria-label",a.selectedRelay?"Change filter":"Change following filter"),se(U,"title",ve()?e(be):void 0)})}l(Be,fe),Qe()}Je(["click"]);export{Dt as R};
