import{c as ce,a as n,f as k,s as u,t as Q,d as Oe}from"./CvdcXPsy.js";import{p as ye,h as z,e as he,c as s,d as a,r,g as t,f as ie,t as $,u as ke,n as le,s as pe,a as p}from"./-h67YDCL.js";import{i as de}from"./DG6c9x1x.js";import{e as Re,i as Fe}from"./DBJvd_ZN.js";import{c as N}from"./C52XBfTo.js";import{a as Pe,s as De}from"./CptlhHpT.js";import{n as ne,d as Ee}from"./CAJmB2zv.js";import{t as V}from"./DqdFoxb9.js";import{D as Ce,a as Ue,R as Ie}from"./y2uKFtaO.js";import{B as ge}from"./B3t7n0XN.js";import{p as Me}from"./6dG0wjw8.js";import{R as we}from"./DKHnPTm-.js";import{r as Se}from"./vjiKTA8K.js";import{a as Ne}from"./Bif2btQW.js";import{T as je}from"./jXeEBM3o.js";import{$ as ze}from"./CIoNh8li.js";import{D as Ke}from"./BFIKOW_n.js";import{a as Te,D as Be}from"./BeHDsRkZ.js";import{I as $e}from"./BClDDyYv.js";var Ae=k('<div class="invisible group-hover:visible absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-card border border-border rounded-lg shadow-xl z-50 w-64 text-xs"><div class="font-semibold text-foreground mb-1"> </div> <div class="text-muted-foreground"> </div> <div class="text-muted-foreground mt-1 break-all"> </div></div>'),Je=k('<div class="flex items-center gap-1.5 px-2 py-1 bg-muted/50 rounded text-xs text-muted-foreground group relative"><!> <span class="truncate max-w-[120px]"> </span> <!></div>'),Ve=k('<div class="text-xs text-muted-foreground truncate"> </div>'),qe=k('<div class="flex items-center gap-2 px-3 py-2 bg-muted/50 rounded-lg text-sm text-muted-foreground hover:bg-muted transition-colors"><!> <div class="flex-1 min-w-0"><div class="font-medium text-foreground truncate"> </div> <!></div></div>');function Ge(fe,o){ye(o,!0);const i=Me(o,"variant",3,"default"),ue=ie(()=>o.relay.connectivity.nip11),Z=ie(()=>t(ue)?.name||new URL(o.relay.url).hostname),g=ie(()=>t(ue)?.description);var K=ce(),R=z(K);{var T=C=>{var L=Je(),j=s(L);we(j,{get relayUrl(){return o.relay.url},size:"xs"});var O=a(j,2),q=s(O,!0);r(O);var W=a(O,2);{var h=P=>{var F=Ae(),U=s(F),ee=s(U,!0);r(U);var X=a(U,2),me=s(X,!0);r(X);var e=a(X,2),f=s(e,!0);r(e),r(F),$(()=>{u(ee,t(Z)),u(me,t(g)),u(f,o.relay.url)}),n(P,F)};de(W,P=>{t(g)&&P(h)})}r(L),$(()=>u(q,t(Z))),n(C,L)},y=C=>{var L=qe(),j=s(L);we(j,{get relayUrl(){return o.relay.url},size:"md"});var O=a(j,2),q=s(O),W=s(q,!0);r(q);var h=a(q,2);{var P=F=>{var U=Ve(),ee=s(U,!0);r(U),$(()=>u(ee,t(g))),n(F,U)};de(h,F=>{t(g)&&F(P)})}r(O),r(L),$(()=>u(W,t(Z))),n(C,L)};de(R,C=>{i()==="compact"?C(T):C(y,!1)})}n(fe,K),he()}var He=k("<!> <!>",1),Qe=k('<label class="flex items-center gap-3 p-3 border border-border rounded-lg hover:bg-muted cursor-pointer transition-colors"><input type="radio" name="reportType" class="w-4 h-4"/> <span class="text-sm"> </span></label>'),We=k('<!> <div class="space-y-4 py-4"><div><label class="text-sm font-medium mb-2 block"> </label> <div class="space-y-2"></div></div> <div><label for="report-additional-info" class="text-sm font-medium mb-2 block"> </label> <!></div> <div class="p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg"><p class="text-sm text-yellow-600 dark:text-yellow-400"> </p></div></div> <div class="flex gap-3 justify-end"><!> <!></div>',1);function Xe(fe,o){ye(o,!0);const i=()=>Pe(ze,"$t",ue),[ue,Z]=De(),g=[];let K=Me(o,"open",7),R=pe(""),T=pe(""),y=pe(!1);const C=[{value:"nudity",labelKey:"report.types.nudity"},{value:"malware",labelKey:"report.types.malware"},{value:"profanity",labelKey:"report.types.profanity"},{value:"illegal",labelKey:"report.types.illegal"},{value:"spam",labelKey:"report.types.spam"},{value:"impersonation",labelKey:"report.types.impersonation"},{value:"other",labelKey:"report.types.other"}];async function L(){if(!t(R)){V.error(i()("report.errors.selectType"));return}if(!ne.activeUser){V.error(i()("report.errors.notLoggedIn"));return}try{p(y,!0);const h=new Ee(ne);h.kind=1984,h.tag(o.target,t(R)),t(T).trim()&&(h.content=t(T).trim()),await h.publish(),V.success(i()("report.success")),o.onClose(),p(R,""),p(T,"")}catch(h){console.error("Failed to submit report:",h),V.error(i()("report.errors.failed"))}finally{p(y,!1)}}function j(){t(y)||(p(R,""),p(T,""),o.onClose())}ke(()=>{K()||j()});var O=ce(),q=z(O);N(q,()=>Ie,(W,h)=>{h(W,{get open(){return K()},set open(P){K(P)},children:(P,F)=>{var U=ce(),ee=z(U);N(ee,()=>Ce,(X,me)=>{me(X,{class:"max-w-md",children:(e,f)=>{var m=We(),Y=z(m);N(Y,()=>Ke,(b,l)=>{l(b,{children:(v,d)=>{var c=He(),w=z(c);N(w,()=>Ue,(x,E)=>{E(x,{children:(se,Le)=>{le();var be=Q();$(xe=>u(be,xe),[()=>i()("report.title")]),n(se,be)},$$slots:{default:!0}})});var D=a(w,2);N(D,()=>Te,(x,E)=>{E(x,{children:(se,Le)=>{le();var be=Q();$(xe=>u(be,xe),[()=>i()("report.description")]),n(se,be)},$$slots:{default:!0}})}),n(v,c)},$$slots:{default:!0}})});var B=a(Y,2),I=s(B),A=s(I),_e=s(A,!0);r(A);var te=a(A,2);Re(te,21,()=>C,Fe,(b,l)=>{var v=Qe(),d=s(v);Se(d);var c,w=a(d,2),D=s(w,!0);r(w),r(v),$(x=>{d.disabled=t(y),c!==(c=t(l).value)&&(d.value=(d.__value=t(l).value)??""),u(D,x)},[()=>i()(t(l).labelKey)]),Ne(g,[],d,()=>(t(l).value,t(R)),x=>p(R,x)),n(b,v)}),r(te),r(I);var re=a(I,2),G=s(re),ve=s(G);r(G);var oe=a(G,2);{let b=ie(()=>i()("report.additionalInfoPlaceholder"));je(oe,{id:"report-additional-info",get placeholder(){return t(b)},get disabled(){return t(y)},class:"resize-none",rows:3,get value(){return t(T)},set value(l){p(T,l,!0)}})}r(re);var ae=a(re,2),_=s(ae),M=s(_,!0);r(_),r(ae),r(B);var S=a(B,2),J=s(S);ge(J,{variant:"outline",onclick:j,get disabled(){return t(y)},children:(b,l)=>{le();var v=Q();$(d=>u(v,d),[()=>i()("common.cancel")]),n(b,v)},$$slots:{default:!0}});var H=a(J,2);{let b=ie(()=>!t(R)||t(y));ge(H,{onclick:L,get disabled(){return t(b)},variant:"destructive",children:(l,v)=>{var d=ce(),c=z(d);{var w=x=>{var E=Q();$(se=>u(E,se),[()=>i()("report.submitting")]),n(x,E)},D=x=>{var E=Q();$(se=>u(E,se),[()=>i()("report.submit")]),n(x,E)};de(c,x=>{t(y)?x(w):x(D,!1)})}n(l,d)},$$slots:{default:!0}})}r(S),$((b,l,v,d)=>{u(_e,b),u(ve,`${l??""} ${v??""}`),u(M,d)},[()=>i()("report.selectReason"),()=>i()("report.additionalInfo"),()=>i()("common.optional"),()=>i()("report.warning")]),n(e,m)},$$slots:{default:!0}})}),n(P,U)},$$slots:{default:!0}})}),n(fe,O),he(),Z()}var Ye=k('<div class="border-t border-border mt-1 pt-1"><div class="px-4 py-2 text-xs text-muted-foreground"> </div></div>'),Ze=k('<div class="border-t border-border mt-1 pt-1"><div class="px-4 py-2 text-xs text-muted-foreground font-medium"> </div> <div class="px-2 pb-2 space-y-1"></div></div>'),et=k('<div class="absolute right-0 mt-1 w-72 bg-popover border border-border rounded-lg shadow-lg z-10 max-h-96 overflow-y-auto"><button class="w-full px-4 py-3 text-left text-sm text-foreground hover:bg-muted transition-colors first:rounded-t-lg flex items-center gap-3" type="button"><!> </button> <button class="w-full px-4 py-3 text-left text-sm text-foreground hover:bg-muted transition-colors flex items-center gap-3" type="button"><!> </button> <div class="border-t border-border my-1"></div> <button class="w-full px-4 py-2 text-left text-sm text-foreground hover:bg-muted transition-colors" type="button">Copy author (nprofile)</button> <button class="w-full px-4 py-2 text-left text-sm text-foreground hover:bg-muted transition-colors" type="button">Copy ID (nevent)</button> <button class="w-full px-4 py-2 text-left text-sm text-foreground hover:bg-muted transition-colors" type="button">View raw event</button> <!></div>'),tt=k("<!> <!>",1),rt=k("<!> <!>",1),ot=k('<!> <div class="flex-1 overflow-auto bg-muted/50 rounded-lg p-4 font-mono text-sm"><pre class="whitespace-pre-wrap break-words"> </pre></div> <!>',1),at=k('<div class="relative flex-shrink-0"><button class="p-1 hover:bg-muted rounded-full transition-colors" type="button" aria-label="More options"><svg class="w-5 h-5 text-muted-foreground" fill="currentColor" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></button> <!></div> <!> <!>',1);function kt(fe,o){ye(o,!0);const i=()=>Pe(ze,"$t",ue),[ue,Z]=De();let g=pe(!1),K=pe(!1),R=pe(!1);const T=ne.$subscribe(()=>ne.$currentUser?.pubkey?{filters:[{kinds:[1e4],authors:[ne.$currentUser.pubkey],limit:1}],bufferMs:100}:void 0),y=ie(()=>{const e=T.events[0];return!e||!o.event.author?!1:e.tags.some(f=>f[0]==="p"&&f[1]===o.event.author.pubkey)});async function C(e,f){try{await navigator.clipboard.writeText(e),V.success(`Copied ${f}`)}catch(m){console.error("Failed to copy:",m),V.error(`Failed to copy ${f}`)}p(g,!1)}function L(){const e=o.event.author.nprofile;C(e,"author nprofile")}function j(){const e=o.event.encode();C(e,"event ID")}function O(){p(g,!1),p(K,!0)}async function q(){if(!(!ne.$currentUser?.pubkey||!o.event.author))try{let e=T.events[0];e||(e=new Ee(ne),e.kind=1e4,e.content="",e.tags=[]);const f=o.event.author.pubkey;if(t(y)?(e.tags=e.tags.filter(m=>!(m[0]==="p"&&m[1]===f)),V.success("User unmuted")):(e.tags.push(["p",f]),V.success("User muted")),await e.sign(),await e.publishReplaceable(),e.publishStatus==="error"){const Y=e.publishError?.relayErrors||{},B=Object.entries(Y).map(([I,A])=>`${I}: ${A}`).join(`
`);V.error(`Failed to publish:
${B||"Unknown error"}`);return}p(g,!1)}catch(e){console.error("Failed to toggle mute:",e),V.error(`Failed to ${t(y)?"unmute":"mute"} user: ${e instanceof Error?e.message:"Unknown error"}`)}}function W(){p(R,!0),p(g,!1)}ke(()=>{if(!t(g))return;const e=()=>{p(g,!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)});var h=at(),P=z(h),F=s(P);F.__click=e=>{e.stopPropagation(),p(g,!t(g))};var U=a(F,2);{var ee=e=>{var f=et();f.__click=_=>_.stopPropagation();var m=s(f);m.__click=q;var Y=s(m);{let _=ie(()=>t(y)?"speaker":"speaker-muted");$e(Y,{get name(){return t(_)},size:"md",class:"text-red-500"})}var B=a(Y);r(m);var I=a(m,2);I.__click=W;var A=s(I);$e(A,{name:"alert",size:"md",class:"text-yellow-500"});var _e=a(A);r(I);var te=a(I,4);te.__click=L;var re=a(te,2);re.__click=j;var G=a(re,2);G.__click=O;var ve=a(G,2);{var oe=_=>{var M=Ye(),S=s(M),J=s(S,!0);r(S),r(M),$(()=>u(J,o.event.relay.url)),n(_,M)},ae=_=>{var M=ce(),S=z(M);{var J=H=>{var b=Ze(),l=s(b),v=s(l);r(l);var d=a(l,2);Re(d,21,()=>o.event.onRelays,c=>c.url,(c,w)=>{Ge(c,{get relay(){return t(w)},variant:"compact"})}),r(d),r(b),$(()=>u(v,`Seen on ${o.event.onRelays.length??""} relay${o.event.onRelays.length===1?"":"s"}`)),n(H,b)};de(S,H=>{o.event.onRelays&&o.event.onRelays.length>0&&H(J)},!0)}n(_,M)};de(ve,_=>{o.event.relay?.url?_(oe):_(ae,!1)})}r(f),$((_,M)=>{u(B,` ${_??""}`),u(_e,` ${M??""}`)},[()=>t(y)?i()("userDropdown.unmute"):i()("userDropdown.mute"),()=>i()("noteDropdown.report")]),n(e,f)};de(U,e=>{t(g)&&e(ee)})}r(P);var X=a(P,2);N(X,()=>Ie,(e,f)=>{f(e,{get open(){return t(K)},set open(m){p(K,m,!0)},children:(m,Y)=>{var B=ce(),I=z(B);N(I,()=>Ce,(A,_e)=>{_e(A,{class:"max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:(te,re)=>{var G=ot(),ve=z(G);N(ve,()=>Ke,(S,J)=>{J(S,{children:(H,b)=>{var l=tt(),v=z(l);N(v,()=>Ue,(c,w)=>{w(c,{children:(D,x)=>{le();var E=Q("Raw Event");n(D,E)},$$slots:{default:!0}})});var d=a(v,2);N(d,()=>Te,(c,w)=>{w(c,{children:(D,x)=>{le();var E=Q("JSON representation of this Nostr event");n(D,E)},$$slots:{default:!0}})}),n(H,l)},$$slots:{default:!0}})});var oe=a(ve,2),ae=s(oe),_=s(ae,!0);r(ae),r(oe);var M=a(oe,2);N(M,()=>Be,(S,J)=>{J(S,{class:"flex justify-end gap-2",children:(H,b)=>{var l=rt(),v=z(l);ge(v,{variant:"outline",onclick:()=>C(o.event.inspect,"raw event"),children:(c,w)=>{le();var D=Q("Copy to Clipboard");n(c,D)},$$slots:{default:!0}});var d=a(v,2);ge(d,{onclick:()=>p(K,!1),children:(c,w)=>{le();var D=Q("Close");n(c,D)},$$slots:{default:!0}}),n(H,l)},$$slots:{default:!0}})}),$(()=>u(_,o.event.inspect)),n(te,G)},$$slots:{default:!0}})}),n(m,B)},$$slots:{default:!0}})});var me=a(X,2);Xe(me,{get target(){return o.event},get open(){return t(R)},onClose:()=>p(R,!1)}),n(fe,h),he(),Z()}Oe(["click"]);export{kt as E,Xe as R};
