import{c as ne,f as h,t as x,a as s,s as I,b as ft}from"./CvdcXPsy.js";import{p as Ut,s as f,b as dt,u as ct,a as i,g as e,f as g,h as L,d as a,c as d,t as S,e as Et,n as m,r as n}from"./-h67YDCL.js";import{i as N}from"./DG6c9x1x.js";import{e as Oe,i as Ue}from"./DBJvd_ZN.js";import{c as ie}from"./C52XBfTo.js";import{a as vt,p as Tt}from"./DoDeW8UU.js";import{d as ut,a as qt,b as Ht}from"./vjiKTA8K.js";import{p as Nt}from"./6dG0wjw8.js";import{s as Ee,d as Gt,n as pt,e as Kt}from"./CAJmB2zv.js";import{u as Vt}from"./Xqq2-EA3.js";import{L as j,R as Zt,c as Xt}from"./BClDDyYv.js";import{t as G}from"./DqdFoxb9.js";import{D as Jt,a as Qt,R as Wt}from"./y2uKFtaO.js";import{B as K,I as de}from"./B3t7n0XN.js";import{D as Yt}from"./BFIKOW_n.js";import{D as er}from"./BeHDsRkZ.js";var tr=h("<option> </option>"),rr=h('<span class="text-lg mr-2"> </span> <span class="text-sm"> </span>',1),or=h('<div class="mt-3"><!></div>'),ar=ft('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> Location (Required for F2F)',1),sr=ft('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>'),lr=h('<p class="text-xs text-muted-foreground"> </p>'),nr=h('<div><!> <div class="space-y-2 mt-2"><div class="flex gap-2"><!> <!></div> <!></div></div>'),ir=h('<img alt="" class="w-5 h-5 rounded border border-background"/>'),dr=h('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center border border-background"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),cr=h('<div class="flex items-center -space-x-1"></div>'),vr=h('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),ur=h('<div class="relative"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg> <!></div>'),pr=h('<div class="bg-popover border border-border rounded-lg shadow-xl z-50 w-80 max-h-[400px] overflow-y-auto"><!></div>'),fr=h('<div class="relative"><!> <!></div> <div class="flex gap-2"><!> <!></div>',1),mr=h('<!> <div class="space-y-6"><div><!> <div class="grid grid-cols-2 gap-3"><!> <!></div></div> <div><!> <div class="relative mt-2"><svg class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.31-8.86c-1.77-.45-2.34-.94-2.34-1.67 0-.84.79-1.43 2.1-1.43 1.38 0 1.9.66 1.94 1.64h1.71c-.05-1.34-.87-2.57-2.49-2.97V5H10.9v1.69c-1.51.32-2.72 1.3-2.72 2.81 0 1.79 1.49 2.69 3.66 3.21 1.95.46 2.34 1.15 2.34 1.87 0 .53-.39 1.39-2.1 1.39-1.6 0-2.23-.72-2.32-1.64H8.04c.1 1.7 1.36 2.66 2.86 2.97V19h2.34v-1.67c1.52-.29 2.72-1.16 2.73-2.77-.01-2.2-1.9-2.96-3.66-3.42z"></path></svg> <!></div> <p class="mt-1 text-xs text-muted-foreground"> </p></div> <div class="grid grid-cols-2 gap-4"><div><!> <!> <p class="mt-1 text-xs text-muted-foreground"> </p></div> <div><!> <select id="currency" class="mt-2 w-full px-3 py-2 border border-input rounded-md bg-background text-foreground"></select></div></div> <div><!> <div class="grid grid-cols-2 gap-3"></div> <!></div> <!> <div><!> <!> <p class="mt-1 text-xs text-muted-foreground">Positive for above market, negative for below</p></div> <div><!> <select id="expiration" class="mt-2 w-full px-3 py-2 border border-input rounded-md bg-background text-foreground"><option>1 hour</option><option>6 hours</option><option>12 hours</option><option>24 hours</option><option>48 hours</option><option>72 hours</option></select></div></div> <!>',1);function zr(mt,W){Ut(W,!0);let Y=Nt(W,"open",15,!1);const gt=[{code:"USD",symbol:"$",name:"US Dollar"},{code:"EUR",symbol:"‚Ç¨",name:"Euro"},{code:"GBP",symbol:"¬£",name:"British Pound"},{code:"BRL",symbol:"R$",name:"Brazilian Real"},{code:"ARS",symbol:"$",name:"Argentine Peso"},{code:"PLN",symbol:"z≈Ç",name:"Polish Z≈Çoty"}],Te=[{id:"Cash (F2F)",name:"Cash (F2F)",icon:"üíµ",requiresLocation:!0},{id:"Revolut",name:"Revolut",icon:"üí≥"},{id:"PIX",name:"PIX (Brazil)",icon:"üîÑ"},{id:"BLIK",name:"BLIK (Poland)",icon:"üì±"},{id:"Zelle",name:"Zelle",icon:"üè¶"},{id:"CashApp",name:"Cash App",icon:"üì≤"},{id:"custom",name:"Other...",icon:"‚úèÔ∏è"}];function ht(l,c,k=5){const y="0123456789bcdefghjkmnpqrstuvwxyz";let R=0,U=0,ae=!0,se="",Z=[-90,90],le=[-180,180];for(;se.length<k;){if(ae){const w=(le[0]+le[1])/2;c>=w?(R|=1<<4-U,le[0]=w):le[1]=w}else{const w=(Z[0]+Z[1])/2;l>=w?(R|=1<<4-U,Z[0]=w):Z[1]=w}ae=!ae,U++,U===5&&(se+=y[R],U=0,R=0)}return se}let A=f("buy"),pe=f("USD"),ee=f("100000"),te=f("50"),F=f("Cash (F2F)"),fe=f(""),re=f(""),O=f(""),me=f("0"),ge=f("24"),oe=f(!1),u=f(dt([])),he=f(!1),V=f(!1),ce=f(null),_e=f(dt({top:0,left:0}));const qe=g(()=>Ee.relays.filter(l=>l.enabled));ct(()=>{Y()&&(Ee.selectedRelay?i(u,[Ee.selectedRelay],!0):e(u).length===0&&i(u,e(qe).filter(l=>l.write).map(l=>l.url),!0))});const He=g(()=>Te.find(l=>l.id===e(F))?.requiresLocation||!1);ct(()=>{e(He)||(i(re,""),i(O,""))});function _t(){navigator.geolocation?navigator.geolocation.getCurrentPosition(l=>{const c=l.coords.latitude,k=l.coords.longitude,y=ht(c,k,5);i(O,y,!0),i(re,`Near ${y} (auto-detected)`),G.success("Location detected")},l=>{console.error("Error getting location:",l),G.error("Could not get your location. Please enter city/area manually.")}):G.error("Geolocation is not supported by your browser")}function $t(l){e(u).includes(l)?i(u,e(u).filter(c=>c!==l),!0):i(u,[...e(u),l],!0)}function xt(l){i(u,[l],!0),i(V,!1)}function yt(){i(V,!1)}function bt(){if(!e(V)&&e(ce)){const l=e(ce).getBoundingClientRect(),c=400,y=window.innerHeight-l.bottom<c&&l.top>c;i(_e,{top:y?l.top-c-8:l.bottom+8,left:l.left},!0)}i(V,!e(V))}async function kt(){const l=e(F)==="custom"?e(fe):e(F);if(!l){G.error("Please specify a payment method");return}if(e(F)==="Cash (F2F)"&&!e(re)&&!e(O)){G.error("Please provide a location for face-to-face trades");return}i(oe,!0);try{const c=new Gt(pt);c.kind=38383;const y=[["d",`${Date.now()}-${Math.random().toString(36).substr(2,9)}`],["k",e(A)],["f",e(pe)],["s","pending"],["amt",e(ee)],["fa",e(te)],["pm",l],["premium",e(me)],["y","Agora"],["z","order"],["network","mainnet"],["layer","lightning"],["expiration",(Math.floor(Date.now()/1e3)+Number.parseInt(e(ge))*3600).toString()]];e(O)&&y.push(["g",e(O)]),e(he)&&y.push(["-"]),c.tags=y,c.content="";const R=Kt.fromRelayUrls(e(u),pt);await c.publish(R),G.success("Order created successfully"),Y(!1),W.onClose()}catch(c){console.error("Failed to create order:",c),G.error("Failed to create order")}finally{i(oe,!1)}}const Ne=g(()=>parseInt(e(ee))/1e8),wt=g(()=>parseFloat(e(te))/e(Ne));var Ge=ne(),Pt=L(Ge);ie(Pt,()=>Wt,(l,c)=>{c(l,{get open(){return Y()},onOpenChange:k=>{Y(k),k||W.onClose()},children:(k,y)=>{var R=ne(),U=L(R);ie(U,()=>Jt,(ae,se)=>{se(ae,{class:"max-w-lg max-h-[90vh] overflow-y-auto",children:(Z,le)=>{var w=mr(),Ke=L(w);ie(Ke,()=>Yt,(t,r)=>{r(t,{children:(o,_)=>{var v=ne(),B=L(v);ie(B,()=>Qt,(M,D)=>{D(M,{children:(E,p)=>{m();var $=x("Create P2P Order");s(E,$)},$$slots:{default:!0}})}),s(o,v)},$$slots:{default:!0}})});var $e=a(Ke,2),xe=d($e),Ve=d(xe);j(Ve,{class:"block mb-2",children:(t,r)=>{m();var o=x("Order Type");s(t,o)},$$slots:{default:!0}});var Ze=a(Ve,2),Xe=d(Ze);{let t=g(()=>e(A)==="buy"?"default":"outline"),r=g(()=>e(A)==="buy"?"border-green-500 bg-green-50 text-green-700 dark:bg-green-900/30 dark:text-green-400 hover:bg-green-100 dark:hover:bg-green-900/40":"");K(Xe,{get variant(){return e(t)},onclick:()=>i(A,"buy"),get class(){return e(r)},children:(o,_)=>{m();var v=x("I want to buy Bitcoin");s(o,v)},$$slots:{default:!0}})}var Ct=a(Xe,2);{let t=g(()=>e(A)==="sell"?"default":"outline"),r=g(()=>e(A)==="sell"?"border-red-500 bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/40":"");K(Ct,{get variant(){return e(t)},onclick:()=>i(A,"sell"),get class(){return e(r)},children:(o,_)=>{m();var v=x("I want to sell Bitcoin");s(o,v)},$$slots:{default:!0}})}n(Ze),n(xe);var ye=a(xe,2),Je=d(ye);j(Je,{for:"sats-amount",children:(t,r)=>{m();var o=x("Bitcoin Amount (sats)");s(t,o)},$$slots:{default:!0}});var be=a(Je,2),Rt=a(d(be),2);de(Rt,{id:"sats-amount",type:"number",class:"pl-10",placeholder:"100000",get value(){return e(ee)},set value(t){i(ee,t,!0)}}),n(be);var Qe=a(be,2),Bt=d(Qe);n(Qe),n(ye);var ke=a(ye,2),we=d(ke),We=d(we);j(We,{for:"fiat-amount",children:(t,r)=>{m();var o=x("Fiat Amount");s(t,o)},$$slots:{default:!0}});var Ye=a(We,2);de(Ye,{id:"fiat-amount",type:"number",placeholder:"50",class:"mt-2",get value(){return e(te)},set value(t){i(te,t,!0)}});var et=a(Ye,2),Mt=d(et);n(et),n(we);var tt=a(we,2),rt=d(tt);j(rt,{for:"currency",children:(t,r)=>{m();var o=x("Currency");s(t,o)},$$slots:{default:!0}});var Pe=a(rt,2);Oe(Pe,21,()=>gt,Ue,(t,r)=>{var o=tr(),_=d(o);n(o);var v={};S(()=>{I(_,`${e(r).symbol??""} ${e(r).code??""}`),v!==(v=e(r).code)&&(o.value=(o.__value=e(r).code)??"")}),s(t,o)}),n(Pe),n(tt),n(ke);var Ce=a(ke,2),ot=d(Ce);j(ot,{class:"block mb-2",children:(t,r)=>{m();var o=x("Payment Method");s(t,o)},$$slots:{default:!0}});var Re=a(ot,2);Oe(Re,21,()=>Te,Ue,(t,r)=>{{let o=g(()=>e(F)===e(r).id?"default":"outline"),_=g(()=>e(F)===e(r).id?"border-primary":"");K(t,{get variant(){return e(o)},onclick:()=>i(F,e(r).id,!0),get class(){return`justify-start h-auto py-2 ${e(_)??""}`},children:(v,B)=>{var M=rr(),D=L(M),E=d(D,!0);n(D);var p=a(D,2),$=d(p,!0);n(p),S(()=>{I(E,e(r).icon),I($,e(r).name)}),s(v,M)},$$slots:{default:!0}})}}),n(Re);var Dt=a(Re,2);{var Ft=t=>{var r=or(),o=d(r);de(o,{placeholder:"Enter payment method (e.g., Bank Transfer, PayPal, etc.)",autofocus:!0,get value(){return e(fe)},set value(_){i(fe,_,!0)}}),n(r),s(t,r)};N(Dt,t=>{e(F)==="custom"&&t(Ft)})}n(Ce);var at=a(Ce,2);{var zt=t=>{var r=nr(),o=d(r);j(o,{for:"location",class:"flex items-center gap-1",children:(p,$)=>{var T=ar();m(),s(p,T)},$$slots:{default:!0}});var _=a(o,2),v=d(_),B=d(v);de(B,{id:"location",placeholder:"City, neighborhood, or area",class:"flex-1",get value(){return e(re)},set value(p){i(re,p,!0)}});var M=a(B,2);K(M,{variant:"outline",size:"icon",onclick:_t,title:"Use current location",children:(p,$)=>{var T=sr();s(p,T)},$$slots:{default:!0}}),n(v);var D=a(v,2);{var E=p=>{var $=lr(),T=d($);n($),S(()=>I(T,`Geohash: ${e(O)??""} (approximate location)`)),s(p,$)};N(D,p=>{e(O)&&p(E)})}n(_),n(r),s(t,r)};N(at,t=>{e(He)&&t(zt)})}var Be=a(at,2),st=d(Be);j(st,{for:"premium",children:(t,r)=>{m();var o=x("Premium (%)");s(t,o)},$$slots:{default:!0}});var It=a(st,2);de(It,{id:"premium",type:"number",placeholder:"0",class:"mt-2",get value(){return e(me)},set value(t){i(me,t,!0)}}),m(2),n(Be);var lt=a(Be,2),nt=d(lt);j(nt,{for:"expiration",children:(t,r)=>{m();var o=x("Expiration (hours)");s(t,o)},$$slots:{default:!0}});var Me=a(nt,2),De=d(Me);De.value=De.__value="1";var Fe=a(De);Fe.value=Fe.__value="6";var ze=a(Fe);ze.value=ze.__value="12";var Ie=a(ze);Ie.value=Ie.__value="24";var Le=a(Ie);Le.value=Le.__value="48";var it=a(Le);it.value=it.__value="72",n(Me),n(lt),n($e);var Lt=a($e,2);ie(Lt,()=>er,(t,r)=>{r(t,{class:"mt-6 flex items-center justify-between gap-4",children:(o,_)=>{var v=fr(),B=L(v),M=d(B);K(M,{type:"button",variant:"outline",size:"icon",onclick:bt,get disabled(){return e(oe)},class:"h-10 w-10",title:"Select relays",get ref(){return e(ce)},set ref(b){i(ce,b,!0)},children:(b,P)=>{var q=ne(),C=L(q);{var Se=X=>{var H=cr();Oe(H,21,()=>e(u),Ue,(je,Ae)=>{const J=g(()=>e(qe).find(z=>z.url===e(Ae))),Q=g(()=>e(J)?Vt(e(J).url):null);var ve=ne(),jt=L(ve);{var At=z=>{var ue=ir();S(()=>qt(ue,"src",e(Q).info.icon)),s(z,ue)},Ot=z=>{var ue=dr();s(z,ue)};N(jt,z=>{e(Q)?.info?.icon?z(At):z(Ot,!1)})}s(je,ve)}),n(H),s(X,H)},St=X=>{var H=ur(),je=a(d(H),2);{var Ae=J=>{var Q=vr(),ve=d(Q,!0);n(Q),S(()=>I(ve,e(u).length)),s(J,Q)};N(je,J=>{e(u).length>2&&J(Ae)})}n(H),s(X,H)};N(C,X=>{e(u).length<=2&&e(u).length>0?X(Se):X(St,!1)})}s(b,q)},$$slots:{default:!0}});var D=a(M,2);{var E=b=>{var P=pr(),q=d(P);Zt(q,{get selectedRelayUrls(){return e(u)},onToggleRelay:$t,onSelectOnly:xt,get isProtected(){return e(he)},set isProtected(C){i(he,C,!0)}}),n(P),vt(P,C=>Tt?.(C)),vt(P,(C,Se)=>Xt?.(C,Se),()=>yt),S(()=>Ht(P,`position: fixed; top: ${e(_e).top??""}px; left: ${e(_e).left??""}px;`)),s(b,P)};N(D,b=>{e(V)&&b(E)})}n(B);var p=a(B,2),$=d(p);K($,{variant:"outline",onclick:()=>{Y(!1),W.onClose()},children:(b,P)=>{m();var q=x("Cancel");s(b,q)},$$slots:{default:!0}});var T=a($,2);{let b=g(()=>e(oe)||!e(ee)||!e(te));K(T,{onclick:kt,get disabled(){return e(b)},children:(P,q)=>{m();var C=x();S(()=>I(C,e(oe)?"Creating...":"Create Order")),s(P,C)},$$slots:{default:!0}})}n(p),s(o,v)},$$slots:{default:!0}})}),S((t,r)=>{I(Bt,`= ${t??""} BTC`),I(Mt,`‚âà $${r??""}/BTC`)},[()=>e(Ne).toFixed(8),()=>e(wt).toFixed(2)]),ut(Pe,()=>e(pe),t=>i(pe,t)),ut(Me,()=>e(ge),t=>i(ge,t)),s(Z,w)},$$slots:{default:!0}})}),s(k,R)},$$slots:{default:!0}})}),s(mt,Ge),Et()}export{zr as C};
