import{d as lt,f as n,a,s as j,c as Ce,t as Pe,j as Oe}from"../chunks/CiPFrJr-.js";import{p as Je,d as o,e as r,r as t,c as He,f as F,g as e,u as M,t as K,b as se,s as p,x as _t,a as xt,y as D}from"../chunks/CSbKtK4P.js";import{i as C,p as bt,b as Te}from"../chunks/87vUJtvC.js";import{e as Ee,f as et,n as H,h as Ge,g as ot,d as dt,i as De,P as tt,r as st,m as yt,o as kt,U as wt,k as nt,t as At}from"../chunks/D0X4VYcq.js";import{c as Xe,N as $t}from"../chunks/SCFdHRfV.js";import{g as it}from"../chunks/DeBk5QYO.js";import{f as It}from"../chunks/KSN4Ur19.js";import{a as Pt}from"../chunks/DzBAiUtV.js";import{c as Ct}from"../chunks/DphWBL27.js";import{u as Ze}from"../chunks/B6l-2YVB.js";import{c as jt}from"../chunks/a7XEC-kH.js";import{g as Mt,a as Nt,b as Rt,e as Bt}from"../chunks/BSM2-0iS.js";import{D as Tt,a as Dt,L as Ke,B as ze,b as St}from"../chunks/DFMKmhYe.js";import{D as Lt,I as Ve,a as zt}from"../chunks/C8b5RDJU.js";import{D as Et}from"../chunks/Do6nhxsB.js";import{T as Ot}from"../chunks/ClqPSwVo.js";var Ut=n('<p class="text-muted-foreground text-center py-8">No invites yet in this Agora</p>'),Wt=n('<p class="text-xs text-muted-foreground truncate"> </p>'),Yt=n('<a class="relative bg-gradient-to-b from-primary/5 to-transparent border border-border rounded-xl p-6 hover:border-primary/50 transition-all hover:shadow-lg group"><div class="absolute -top-3 left-1/2 -translate-x-1/2"><div class="w-12 h-12 rounded-full bg-card border-2 border-border flex items-center justify-center text-2xl group-hover:border-primary transition-colors"> </div></div> <div class="flex justify-center mt-6 mb-4"><!></div> <div class="text-center mb-4"><h3 class="font-bold text-lg text-foreground truncate mb-1"> </h3> <!></div> <div class="bg-muted/50 rounded-lg p-3"><div class="text-center"><div class="text-3xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground"> </div></div></div> <div class="mt-3"><div class="h-1.5 bg-muted rounded-full overflow-hidden"><div class="h-full bg-gradient-to-r from-primary to-primary/60 transition-all duration-500"></div></div></div></a>'),Ft=(ne,l)=>p(l,!e(l)),Kt=n('<button class="w-full flex items-center justify-center gap-2 py-3 text-sm font-medium text-primary hover:text-primary/80 transition-colors"><span> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>'),Vt=n('<a class="flex items-center gap-4 p-3 rounded-lg hover:bg-muted/50 transition-colors"><div class="flex items-center gap-3 flex-1"><span class="text-lg font-semibold text-muted-foreground w-8"> </span> <!> <div class="flex-1 min-w-0"><div class="font-medium text-foreground truncate"> </div> <div class="text-sm text-muted-foreground"> </div></div></div> <div class="hidden md:block w-32"><div class="h-2 bg-muted rounded-full overflow-hidden"><div class="h-full bg-gradient-to-r from-primary to-primary/60 transition-all duration-500"></div></div></div></a>'),Gt=n('<div class="mt-4 space-y-2 border-t border-border pt-4"></div>'),Jt=n('<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6"></div> <!> <!>',1),Ht=n('<div><h2 class="text-xl font-bold text-foreground mb-6">üèÜ Top Inviters</h2> <!></div>');function qt(ne,l){Je(l,!0);let A=se(!1);function re($){return $===1?"ü•á":$===2?"ü•à":$===3?"ü•â":""}const S=M(()=>l.stats.slice(0,3)),y=M(()=>l.stats.slice(3,10)),B=M(()=>Math.max(...l.stats.map($=>$.successfulInvites),1));var U=Ht(),X=o(r(U),2);{var L=$=>{var s=Ut();a($,s)},ae=$=>{var s=Jt(),g=F(s);Ee(g,21,()=>e(S),f=>f.pubkey,(f,h)=>{const N=M(()=>H.$fetchProfile(()=>e(h).pubkey));var x=Yt(),W=r(x),_=r(W),Y=r(_,!0);t(_),t(W);var i=o(W,2),z=r(i);et(z,{get ndk(){return H},get pubkey(){return e(h).pubkey},class:"w-24 h-24 rounded-full ring-4 ring-primary/20"}),t(i);var d=o(i,2),b=r(d),E=r(b,!0);t(b);var k=o(b,2);{var me=V=>{var G=Wt(),Q=r(G,!0);t(G),K(()=>j(Q,e(N).nip05)),a(V,G)};C(k,V=>{e(N)?.nip05&&V(me)})}t(d);var pe=o(d,2),ge=r(pe),ie=r(ge),q=r(ie,!0);t(ie);var le=o(ie,2),je=r(le,!0);t(le),t(ge),t(pe);var Ue=o(pe,2),We=r(Ue),qe=r(We);t(We),t(Ue),t(x),K((V,G,Q)=>{Ge(x,"href",V),j(Y,G),j(E,e(N)?.displayName||e(N)?.name||"Anonymous"),j(q,e(h).successfulInvites),j(je,e(h).successfulInvites===1?"person joined":"people joined"),ot(qe,`width: ${Q??""}%`)},[()=>it(e(h).pubkey),()=>re(e(h).rank),()=>Math.min(100,e(h).successfulInvites/e(B)*100)]),a(f,x)}),t(g);var u=o(g,2);{var I=f=>{var h=Kt();h.__click=[Ft,A];var N=r(h),x=r(N,!0);t(N);var W=o(N,2);t(h),K(()=>{j(x,e(A)?"Show Less":`View Top ${l.stats.length} Inviters`),dt(W,0,`w-4 h-4 transition-transform duration-200 ${e(A)?"rotate-180":""}`)}),a(f,h)};C(u,f=>{l.stats.length>3&&f(I)})}var c=o(u,2);{var m=f=>{var h=Gt();Ee(h,21,()=>e(y),N=>N.pubkey,(N,x)=>{const W=M(()=>H.$fetchProfile(()=>e(x).pubkey));var _=Vt(),Y=r(_),i=r(Y),z=r(i);t(i);var d=o(i,2);et(d,{get ndk(){return H},get pubkey(){return e(x).pubkey},class:"w-10 h-10 rounded-full"});var b=o(d,2),E=r(b),k=r(E,!0);t(E);var me=o(E,2),pe=r(me);t(me),t(b),t(Y);var ge=o(Y,2),ie=r(ge),q=r(ie);t(ie),t(ge),t(_),K((le,je)=>{Ge(_,"href",le),j(z,`${e(x).rank??""}.`),j(k,e(W)?.displayName||e(W)?.name||"Anonymous"),j(pe,`${e(x).successfulInvites??""} ${e(x).successfulInvites===1?"person joined":"people joined"}`),ot(q,`width: ${je??""}%`)},[()=>it(e(x).pubkey),()=>Math.min(100,e(x).successfulInvites/e(B)*100)]),a(N,_)}),t(h),a(f,h)};C(c,f=>{e(A)&&e(y).length>0&&f(m)})}a($,s)};C(X,$=>{l.stats.length===0?$(L):$(ae,!1)})}t(U),a(ne,U),He()}lt(["click"]);var Qt=n('<div class="text-muted-foreground">Invited by <span class="font-medium text-primary"> </span></div>'),Xt=n("<div></div>"),Zt=n('<div class="border border-border rounded-lg p-4 hover:border-primary/50 transition-colors"><div class="flex items-center gap-3 mb-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span class="text-lg">üëã</span> <span class="font-semibold text-foreground"> </span></div> <div class="text-sm text-muted-foreground"> </div></div></div> <div class="mb-3 text-foreground whitespace-pre-wrap line-clamp-4"> </div> <div class="flex items-center justify-between text-sm"><!> <div class="flex items-center gap-4 text-muted-foreground"><span class="flex items-center gap-1"> </span></div></div></div>');function er(ne,l){Je(l,!0);const A=M(()=>H.$fetchProfile(()=>l.event.pubkey)),re=M(()=>l.invitedBy?H.$fetchProfile(()=>l.invitedBy):null),S=M(()=>l.event.tags.filter(_=>_[0]==="e").length||0);var y=Zt(),B=r(y),U=r(B);et(U,{get ndk(){return H},get pubkey(){return l.event.pubkey},class:"w-12 h-12 rounded-full"});var X=o(U,2),L=r(X),ae=o(r(L),2),$=r(ae,!0);t(ae),t(L);var s=o(L,2),g=r(s,!0);t(s),t(X),t(B);var u=o(B,2),I=r(u,!0);t(u);var c=o(u,2),m=r(c);{var f=_=>{var Y=Qt(),i=o(r(Y)),z=r(i);t(i),t(Y),K(()=>j(z,`@${(e(re).name||"anonymous")??""}`)),a(_,Y)},h=_=>{var Y=Xt();a(_,Y)};C(m,_=>{l.invitedBy&&e(re)?_(f):_(h,!1)})}var N=o(m,2),x=r(N),W=r(x);t(x),t(N),t(c),t(y),K(_=>{j($,e(A)?.displayName||e(A)?.name||"Anonymous"),j(g,_),j(I,l.event.content),j(W,`üí¨ ${e(S)??""}`)},[()=>It(l.event.created_at||0)]),a(ne,y),He()}var tr=n("<!> <!>",1),rr=(ne,l)=>p(l,!e(l)),ar=n('<img src="/logo-icon.svg" alt="Agora" class="w-6 h-6 flex-shrink-0"/> <span class="text-sm text-muted-foreground flex-1">Select Agora...</span>',1),or=n('<img alt="" class="w-6 h-6 rounded flex-shrink-0"/>'),sr=n('<div class="w-6 h-6 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),nr=n('<!> <span class="text-sm text-muted-foreground flex-1"> </span>',1),ir=n('<img src="/logo-icon.svg" alt="Agora" class="w-6 h-6 flex-shrink-0"/> <span class="text-sm text-muted-foreground flex-1"> </span>',1),lr=n('<p class="text-sm text-muted-foreground text-center py-4">No Agora relays configured</p>'),dr=(ne,l,A)=>{l(e(A).url)},vr=n('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),cr=n('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),ur=n('<div class="text-xs text-muted-foreground truncate"> </div>'),fr=n('<button type="button" class="w-full flex items-center gap-3 px-3 py-2.5 hover:bg-muted cursor-pointer transition-colors text-left"><input type="checkbox" class="w-4 h-4 text-primary border rounded focus:ring-orange-500 pointer-events-none"/> <!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div></button>'),mr=n('<div class="absolute z-[60] mt-1 w-full bg-popover border border-border rounded-xl shadow-lg max-h-64 overflow-y-auto"><!></div>'),pr=n('<p class="mt-1 text-xs text-muted-foreground"> </p>'),gr=Oe(`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> Recipient's Name`,1),hr=Oe('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> Include Cashu Token (sats)',1),_r=n('<div class="space-y-4 border-l-4 border-primary pl-4"><div><!> <!></div> <div><!> <!> <p class="mt-1 text-xs text-muted-foreground">Add sats to help them get started on Nostr</p></div></div>'),xr=n('<div class="animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent mr-2"></div> Generating Invite...',1),br=n('<div><!> <!></div> <div class="relative"><label class="block text-sm font-medium text-muted-foreground mb-2">Invite to Agora</label> <button type="button" class="w-full px-4 py-2.5 text-left rounded-lg bg-muted/50 text-muted-foreground hover:bg-muted transition-colors flex items-center gap-3 group"><!> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!> <!></div> <div><!> <!> <p class="mt-1 text-xs text-muted-foreground">How many people can use this invite (1-500)</p></div> <div class="flex items-center space-x-3"><input type="checkbox" id="personalize" class="w-5 h-5 text-primary border rounded focus:ring-orange-500"/> <label for="personalize" class="text-sm font-medium text-muted-foreground cursor-pointer">Personalize this invite</label></div> <!> <!>',1),yr=Oe('<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Copied!',1),kr=Oe('<svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> Copy',1),wr=Oe('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg> Share',1),Ar=n("<!> <!>",1),$r=n('<div class="space-y-6"><div class="text-center py-8"><div class="w-16 h-16 bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <h3 class="text-lg font-semibold text-foreground mb-2">Invite Created!</h3> <p class="text-sm text-muted-foreground"> </p></div> <div class="bg-muted rounded-xl p-4 space-y-3"><div class="flex items-center space-x-2"><!> <!></div> <!></div> <!></div>'),Ir=n('<!> <div class="space-y-6"><!></div>',1);function Pr(ne,l){Je(l,!0);let A=bt(l,"isOpen",15);const re=`Welcome to Agora! üéâ

I'm inviting you to join Agora, a new kind of social network where you own your identity and content. No algorithms, no ads, just authentic connections.

Looking forward to connecting with you on the open social web!`;let S=se(re),y=se(!1),B=se(""),U=se(""),X=se(10),L=se(""),ae=se(!1),$=se(!1),s=se(_t([])),g=se(!1);const u=M(()=>De.relays.filter(i=>i.enabled&&i.write&&tt(i.url)));xt(()=>{A()&&De.selectedRelay&&e(s).length===0&&tt(De.selectedRelay)&&e(u).some(z=>z.url===De.selectedRelay)&&p(s,[De.selectedRelay],!0)});function I(i){e(s).includes(i)?p(s,e(s).filter(z=>z!==i),!0):p(s,[...e(s),i],!0)}const c=M(()=>e(s).length===0?null:e(s).length===1?{url:e(s)[0],info:Ze(e(s)[0])}:null),m=M(()=>e(s).length===0?"Select Agora...":e(s).length===1?Ze(e(s)[0]).info?.name||e(s)[0].replace("wss://","").replace("ws://",""):`${e(s).length} Agoras selected`);async function f(){if(!H.$currentUser){console.error("No user logged in");return}if(e(s).length===0){alert("Please select at least one Agora to publish the invite to.");return}p(ae,!0);try{const i=Mt(),z=e(y)?Nt():"",d=[];for(let q=0;q<e(X);q++)d.push(Rt());const b={welcomeMessage:e(S),recipientName:e(y)?e(B):void 0,cashuToken:e(y)&&e(U)?`cashu:${e(U)}`:void 0,createdAt:Date.now(),inviter:H.$currentUser.pubkey},E=e(y)?await Bt(JSON.stringify(b),z):JSON.stringify(b),k=new yt(H);k.kind=513,k.content=E,k.tags=[["d",i],...d.map(q=>["code",q])],k.isProtected=!0,await k.sign(),k.isProtected=!0,console.log("Publishing invite event to selected Agoras...",k.id,e(s));const me=new Set;for(const q of e(s)){const le=H.pool.getRelay(q,!0);le&&me.add(le)}const pe=new kt(me,H);await k.publish(pe);const ge=e(y)?`${i}${z}`:i,ie=`${window.location.origin}/i/${ge}`;p(L,ie),console.log("Invite created:",ie)}catch(i){console.error("Failed to generate invite:",i),alert("Failed to generate invite. Check console for details.")}finally{p(ae,!1)}}async function h(){try{await navigator.clipboard.writeText(e(L)),p($,!0),setTimeout(()=>p($,!1),2e3)}catch(i){console.error("Failed to copy:",i)}}async function N(){if(!navigator.share){console.log("Web Share API not supported, falling back to copy"),await h();return}try{await navigator.share({title:"Join Agora",text:e(y)&&e(B)?`${e(B)}, you're invited to join Agora!`:"You're invited to join Agora, a new kind of social network!",url:e(L)})}catch(i){i.name!=="AbortError"&&console.error("Failed to share:",i)}}function x(){p(S,re),p(y,!1),p(B,""),p(U,""),p(X,10),p(L,""),p(s,[],!0),p(g,!1),l.onClose()}function W(){p(g,!1)}var _=Ce(),Y=F(_);Te(Y,()=>St,(i,z)=>{z(i,{get open(){return A()},onOpenChange:d=>{A(d),d||x()},children:(d,b)=>{var E=Ce(),k=F(E);Te(k,()=>Tt,(me,pe)=>{pe(me,{class:"max-w-lg max-h-[90vh] overflow-y-auto",children:(ge,ie)=>{var q=Ir(),le=F(q);Te(le,()=>Lt,(V,G)=>{G(V,{children:(Q,Me)=>{var Ne=tr(),de=F(Ne);Te(de,()=>Dt,(he,ke)=>{ke(he,{children:(we,Se)=>{D();var Z=Pe("Create an Invite");a(we,Z)},$$slots:{default:!0}})});var ve=o(de,2);Te(ve,()=>Et,(he,ke)=>{ke(he,{children:(we,Se)=>{D();var Z=Pe("Invite someone to join Agora with a personal message");a(we,Z)},$$slots:{default:!0}})}),a(Q,Ne)},$$slots:{default:!0}})});var je=o(le,2),Ue=r(je);{var We=V=>{var G=br(),Q=F(G),Me=r(Q);Ke(Me,{for:"welcome-message",children:(v,w)=>{D();var J=Pe("Welcome Message");a(v,J)},$$slots:{default:!0}});var Ne=o(Me,2);Ot(Ne,{id:"welcome-message",rows:6,placeholder:"Write a welcome message...",class:"mt-2 resize-none",get value(){return e(S)},set value(v){p(S,v,!0)}}),t(Q);var de=o(Q,2),ve=o(r(de),2);ve.__click=[rr,g];var he=r(ve);{var ke=v=>{var w=ar();D(2),a(v,w)},we=v=>{var w=Ce(),J=F(w);{var _e=P=>{var T=nr(),O=F(T);{var R=ue=>{var Ie=or();K(()=>Ge(Ie,"src",e(c).info.info.icon)),a(ue,Ie)},ye=ue=>{var Ie=sr();a(ue,Ie)};C(O,ue=>{e(c).info.info?.icon?ue(R):ue(ye,!1)})}var ee=o(O,2),Be=r(ee,!0);t(ee),K(()=>j(Be,e(m))),a(P,T)},$e=P=>{var T=ir(),O=o(F(T),2),R=r(O);t(O),K(()=>j(R,`${e(s).length??""} Agoras selected`)),a(P,T)};C(J,P=>{e(s).length===1&&e(c)?P(_e):P($e,!1)},!0)}a(v,w)};C(he,v=>{e(s).length===0?v(ke):v(we,!1)})}var Se=o(he,2);t(ve);var Z=o(ve,2);{var Le=v=>{var w=mr(),J=r(w);{var _e=P=>{var T=lr();a(P,T)},$e=P=>{var T=Ce(),O=F(T);Ee(O,17,()=>e(u),R=>R.url,(R,ye)=>{const ee=M(()=>Ze(e(ye).url));var Be=fr();Be.__click=[dr,I,ye];var ue=r(Be);st(ue);var Ie=o(ue,2);{var ut=te=>{var fe=vr();K(()=>Ge(fe,"src",e(ee).info.icon)),a(te,fe)},ft=te=>{var fe=cr();a(te,fe)};C(Ie,te=>{e(ee).info?.icon?te(ut):te(ft,!1)})}var rt=o(Ie,2),Qe=r(rt),at=r(Qe),mt=r(at,!0);t(at),D(2),t(Qe);var pt=o(Qe,2);{var gt=te=>{var fe=ur(),ht=r(fe,!0);t(fe),K(()=>j(ht,e(ee).info.description)),a(te,fe)};C(pt,te=>{e(ee).info?.description&&te(gt)})}t(rt),t(Be),K((te,fe)=>{wt(ue,te),j(mt,fe)},[()=>e(s).includes(e(ye).url),()=>e(ee).info?.name||e(ye).url.replace("wss://","").replace("ws://","")]),a(R,Be)}),a(P,T)};C(J,P=>{e(u).length===0?P(_e):P($e,!1)})}t(w),Pt(w,(P,T)=>jt?.(P,T),()=>W),a(v,w)};C(Z,v=>{e(g)&&v(Le)})}var xe=o(Z,2);{var Ye=v=>{var w=pr(),J=r(w);t(w),K(()=>j(J,`${e(s).length??""} Agoras selected`)),a(v,w)};C(xe,v=>{e(s).length>1&&v(Ye)})}t(de);var be=o(de,2),Ae=r(be);Ke(Ae,{for:"max-uses",children:(v,w)=>{D();var J=Pe("Maximum Uses");a(v,J)},$$slots:{default:!0}});var ce=o(Ae,2);Ve(ce,{id:"max-uses",type:"number",min:"1",max:"500",class:"mt-2",get value(){return e(X)},set value(v){p(X,v,!0)}}),D(2),t(be);var oe=o(be,2),Fe=r(oe);st(Fe),D(2),t(oe);var Re=o(oe,2);{var vt=v=>{var w=_r(),J=r(w),_e=r(J);Ke(_e,{for:"recipient-name",class:"flex items-center gap-2",children:(R,ye)=>{var ee=gr();D(),a(R,ee)},$$slots:{default:!0}});var $e=o(_e,2);Ve($e,{id:"recipient-name",type:"text",placeholder:"John Doe",class:"mt-2",get value(){return e(B)},set value(R){p(B,R,!0)}}),t(J);var P=o(J,2),T=r(P);Ke(T,{for:"cashu-amount",class:"flex items-center gap-2",children:(R,ye)=>{var ee=hr();D(),a(R,ee)},$$slots:{default:!0}});var O=o(T,2);Ve(O,{id:"cashu-amount",type:"number",placeholder:"Amount in sats (optional)",class:"mt-2",get value(){return e(U)},set value(R){p(U,R,!0)}}),D(2),t(P),t(w),a(v,w)};C(Re,v=>{e(y)&&v(vt)})}var ct=o(Re,2);{let v=M(()=>e(ae)||!e(S).trim()||e(s).length===0);ze(ct,{onclick:f,get disabled(){return e(v)},class:"w-full",children:(w,J)=>{var _e=Ce(),$e=F(_e);{var P=O=>{var R=xr();D(),a(O,R)},T=O=>{var R=Pe("Generate Invite Link");a(O,R)};C($e,O=>{e(ae)?O(P):O(T,!1)})}a(w,_e)},$$slots:{default:!0}})}K(()=>dt(Se,0,`w-4 h-4 text-muted-foreground transition-transform flex-shrink-0 ${e(g)?"rotate-180":""}`)),Ct(Fe,()=>e(y),v=>p(y,v)),a(V,G)},qe=V=>{var G=$r(),Q=r(G),Me=o(r(Q),4),Ne=r(Me,!0);t(Me),t(Q);var de=o(Q,2),ve=r(de),he=r(ve);Ve(he,{type:"text",get value(){return e(L)},readonly:!0,class:"flex-1 bg-transparent"});var ke=o(he,2);ze(ke,{onclick:h,size:"sm",children:(Z,Le)=>{var xe=Ce(),Ye=F(xe);{var be=ce=>{var oe=yr();D(),a(ce,oe)},Ae=ce=>{var oe=kr();D(),a(ce,oe)};C(Ye,ce=>{e($)?ce(be):ce(Ae,!1)})}a(Z,xe)},$$slots:{default:!0}}),t(ve);var we=o(ve,2);ze(we,{onclick:N,variant:"outline",class:"w-full",children:(Z,Le)=>{var xe=wr();D(),a(Z,xe)},$$slots:{default:!0}}),t(de);var Se=o(de,2);Te(Se,()=>zt,(Z,Le)=>{Le(Z,{class:"flex gap-3 sm:space-x-0",children:(xe,Ye)=>{var be=Ar(),Ae=F(be);ze(Ae,{variant:"outline",onclick:()=>p(L,""),class:"flex-1",children:(oe,Fe)=>{D();var Re=Pe("Create Another");a(oe,Re)},$$slots:{default:!0}});var ce=o(Ae,2);ze(ce,{onclick:x,class:"flex-1",children:(oe,Fe)=>{D();var Re=Pe("Done");a(oe,Re)},$$slots:{default:!0}}),a(xe,be)},$$slots:{default:!0}})}),t(G),K(()=>j(Ne,e(y)&&e(B)?`Your personalized invite for ${e(B)} is ready`:"Your invite link is ready to share")),a(V,G)};C(Ue,V=>{e(L)?V(qe,!1):V(We)})}t(je),a(ge,q)},$$slots:{default:!0}})}),a(d,E)},$$slots:{default:!0}})}),a(ne,_),He()}lt(["click"]);var Cr=n('<div class="min-h-screen flex items-center justify-center p-4"><div class="text-center"><svg class="w-16 h-16 mx-auto mb-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <h2 class="text-xl font-semibold text-foreground mb-2">Select an Agora</h2> <p class="text-muted-foreground">This page shows community invites for a specific Agora</p></div></div>'),jr=n('<p class="text-muted-foreground text-center py-8">No new members yet</p>'),Mr=n('<div class="grid grid-cols-1 md:grid-cols-2 gap-3"></div>'),Nr=n('<p class="text-muted-foreground text-center py-8">No introductions yet</p>'),Rr=n('<div class="space-y-4"></div>'),Br=n('<div class="min-h-screen bg-background"><div class="border-b border-border bg-card sticky top-0 z-10"><div class="px-4 py-4"><h1 class="text-2xl font-bold text-foreground">üèÜ Agora Invites</h1> <p class="text-sm text-muted-foreground mt-1">Community growth and new members</p></div></div> <div class="max-w-4xl mx-auto p-4 space-y-6"><!> <div class="bg-card rounded-xl border border-border p-6"><h2 class="text-xl font-bold text-foreground mb-4">üëã New Members</h2> <!></div> <div class="bg-card rounded-xl border border-border p-6"><h2 class="text-xl font-bold text-foreground mb-4">üí¨ Introductions</h2> <!></div></div></div> <!>',1);function qr(ne,l){Je(l,!0);const A=M(()=>De.selectedRelay),re=M(()=>e(A)?tt(e(A)):!1),S=M(()=>!e(A)||!e(re)?null:H.$subscribe(()=>({filters:[{kinds:[514]}],relayUrls:[e(A)],subId:"invite-redemptions",cacheUsage:nt.ONLY_RELAY,closeOnEose:!0}))),y=M(()=>!e(A)||!e(re)?null:H.$subscribe(()=>({filters:[{kinds:[1],"#t":["introduction"],limit:20}],relayUrls:[e(A)],cacheUsage:nt.ONLY_RELAY,exclusiveRelay:!0,closeOnEose:!0}))),B=M(()=>{if(!e(S))return[];const g=e(S).events,u=new Map;for(const c of g){const m=c.tags.find(f=>f[0]==="p");if(m?.[1]){const f=m[1];u.set(f,(u.get(f)||0)+1)}}const I=Array.from(u.entries()).map(([c,m])=>({pubkey:c,totalInvites:m,successfulInvites:m,rank:0}));return I.sort((c,m)=>m.successfulInvites-c.successfulInvites),I.forEach((c,m)=>{c.rank=m+1}),I.slice(0,10)}),U=M(()=>{if(!e(y)||!e(S))return[];const g=e(y).events,u=e(S).events,I=new Map;for(const c of u){const m=c.tags.find(f=>f[0]==="p");m&&m[1]&&I.set(c.pubkey,m[1])}return g.map(c=>({event:c,invitedBy:I.get(c.pubkey)||null})).sort((c,m)=>(m.event.created_at||0)-(c.event.created_at||0)).slice(0,10)}),X=M(()=>e(S)?e(S).events.map(u=>{const I=u.tags.find(c=>c[0]==="p");return{memberPubkey:u.pubkey,inviterPubkey:I?.[1]||null,joinedAt:u.created_at||0}}).sort((u,I)=>I.joinedAt-u.joinedAt).slice(0,20):[]);var L=Ce(),ae=F(L);{var $=g=>{var u=Cr();a(g,u)},s=g=>{var u=Br(),I=F(u),c=o(r(I),2),m=r(c);qt(m,{get stats(){return e(B)}});var f=o(m,2),h=o(r(f),2);{var N=d=>{var b=jr();a(d,b)},x=d=>{var b=Mr();Ee(b,21,()=>e(X).slice(0,6),At,(E,k)=>{$t(E,{get memberPubkey(){return e(k).memberPubkey},get inviterPubkey(){return e(k).inviterPubkey},get joinedAt(){return e(k).joinedAt}})}),t(b),a(d,b)};C(h,d=>{e(X).length===0?d(N):d(x,!1)})}t(f);var W=o(f,2),_=o(r(W),2);{var Y=d=>{var b=Nr();a(d,b)},i=d=>{var b=Rr();Ee(b,21,()=>e(U),E=>E.event.id,(E,k)=>{er(E,{get event(){return e(k).event},get invitedBy(){return e(k).invitedBy}})}),t(b),a(d,b)};C(_,d=>{e(U).length===0?d(Y):d(i,!1)})}t(W),t(c),t(I);var z=o(I,2);Pr(z,{onClose:()=>Xe.close(),get isOpen(){return Xe.show},set isOpen(d){Xe.show=d}}),a(g,u)};C(ae,g=>{e(re)?g(s,!1):g($)})}a(ne,L),He()}export{qr as component};
