import{d as Ke,f as B,s as P,a as w,j as Ye,c as et,t as Et,i as Zt}from"../chunks/CiPFrJr-.js";import{p as je,e as i,d as u,r as o,y as Ie,t as Z,c as Ve,f as qe,b as le,x as Xe,g as n,u as we,a1 as It,s as y,a as ot,b8 as cr}from"../chunks/CSbKtK4P.js";import{i as $,a as Qt,s as er,p as yt,b as ur}from"../chunks/87vUJtvC.js";import{r as Oe,i as Ae,U as ct,e as Ue,d as Ce,t as ze,g as vr,n as Fe,N as pr,aa as At,h as nt,ab as Bt,m as tr,_ as rr,a3 as Mt,a4 as Rt,s as hr,a1 as it}from"../chunks/D0X4VYcq.js";import{$ as ar}from"../chunks/Ce4T6J7V.js";import{b as tt,c as Nt}from"../chunks/DphWBL27.js";import{u as fr}from"../chunks/B6l-2YVB.js";import{t as Ze}from"../chunks/B0fEDaa-.js";import{c as mr}from"../chunks/DEb5q3sN.js";import{n as St}from"../chunks/DwHRoI11.js";var gr=Ye('<svg class="w-4 h-4 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>'),xr=Ye('<svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>'),_r=Ye('<svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg>'),br=Ye('<svg class="w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'),yr=B('<span class="text-xs bg-green-100 dark:bg-green-950 text-green-700 dark:text-green-400 px-2 py-0.5 rounded-full">Connected</span>'),wr=B('<span class="text-xs bg-red-100 dark:bg-red-950 text-red-700 dark:text-red-400 px-2 py-0.5 rounded-full">Offline</span>'),kr=B('<span class="text-xs bg-yellow-100 dark:bg-yellow-950 text-yellow-700 dark:text-yellow-400 px-2 py-0.5 rounded-full">Testing...</span>'),Er=B('<div class="flex items-start gap-2"><span class="text-xs font-medium text-muted-foreground min-w-[60px]">Name:</span> <span class="text-sm font-semibold text-foreground"> </span></div>'),Ar=B('<div class="flex items-start gap-2"><span class="text-xs font-medium text-muted-foreground min-w-[60px]">About:</span> <span class="text-sm text-muted-foreground"> </span></div>'),Sr=B('<div class="flex items-start gap-2"><span class="text-xs font-medium text-muted-foreground min-w-[60px]">Software:</span> <span class="text-sm text-muted-foreground"> </span></div>'),Ir=B('<div class="flex items-start gap-2"><svg class="w-3 h-3 text-muted-foreground mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> <span class="text-sm text-muted-foreground"> </span></div>'),Br=B('<div class="flex items-start gap-2"><svg class="w-3 h-3 text-muted-foreground mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div class="flex-1"><span class="text-xs text-muted-foreground"> <!></span></div></div>'),Tr=B('<span class="text-xs bg-yellow-100 dark:bg-yellow-950 text-yellow-700 dark:text-yellow-400 px-2 py-0.5 rounded-full">üí∞ Paid</span>'),Cr=B('<span class="text-xs bg-blue-100 dark:bg-blue-950 text-blue-700 dark:text-blue-400 px-2 py-0.5 rounded-full">üîê Auth Required</span>'),Mr=B('<span class="text-xs bg-neutral-100 dark:bg-muted text-muted-foreground px-2 py-0.5 rounded-full"> </span>'),Rr=B('<div class="mt-2 space-y-1"><!> <!> <!> <!> <!> <div class="flex flex-wrap gap-2 mt-2"><!> <!> <!></div></div>'),Nr=(c,a)=>Ae.updateRelay(a.relay.url,{read:c.currentTarget.checked}),Lr=(c,a)=>Ae.updateRelay(a.relay.url,{write:c.currentTarget.checked}),Fr=B('<div class="flex-1 min-w-0"><div class="flex flex-wrap items-center gap-2"><!> <span class="font-mono text-xs md:text-sm text-foreground break-all"> </span> <!> <!> <!></div> <!> <div class="flex items-center gap-4 mt-3"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 text-primary rounded focus:ring-orange-500"/> <span class="text-sm text-muted-foreground">Read</span></label> <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 text-primary rounded focus:ring-orange-500"/> <span class="text-sm text-muted-foreground">Write</span></label></div></div>');function Dr(c,a){je(a,!0);let{info:d}=fr(a.relay.url);var p=Fr(),h=i(p),f=i(h);{var g=N=>{var ee=gr();w(N,ee)},l=N=>{var ee=et(),J=qe(ee);{var te=ne=>{var ce=xr();w(ne,ce)},Q=ne=>{var ce=et(),xe=qe(ce);{var U=I=>{var M=_r();w(I,M)},V=I=>{var M=br();w(I,M)};$(xe,I=>{d?.software?I(U):I(V,!1)},!0)}w(ne,ce)};$(J,ne=>{d?.limitation?.auth_required?ne(te):ne(Q,!1)},!0)}w(N,ee)};$(f,N=>{d?.limitation?.payment_required?N(g):N(l,!1)})}var m=u(f,2),_=i(m,!0);o(m);var C=u(m,2);{var R=N=>{var ee=yr();w(N,ee)};$(C,N=>{a.status==="connected"&&N(R)})}var S=u(C,2);{var b=N=>{var ee=wr();w(N,ee)};$(S,N=>{a.status==="disconnected"&&a.connectionStatus[a.relay.url]!==void 0&&N(b)})}var E=u(S,2);{var A=N=>{var ee=kr();w(N,ee)};$(E,N=>{a.status==="testing"&&N(A)})}o(h);var L=u(h,2);{var z=N=>{var ee=Rr(),J=i(ee);{var te=O=>{var K=Er(),oe=u(i(K),2),ie=i(oe,!0);o(oe),o(K),Z(()=>P(ie,d.name)),w(O,K)};$(J,O=>{d.name&&O(te)})}var Q=u(J,2);{var ne=O=>{var K=Ar(),oe=u(i(K),2),ie=i(oe,!0);o(oe),o(K),Z(()=>P(ie,d.description)),w(O,K)};$(Q,O=>{d.description&&O(ne)})}var ce=u(Q,2);{var xe=O=>{var K=Sr(),oe=u(i(K),2),ie=i(oe);o(oe),o(K),Z(()=>P(ie,`${d.software??""}${d.version?` v${d.version}`:""}`)),w(O,K)};$(ce,O=>{(d.software||d.version)&&O(xe)})}var U=u(ce,2);{var V=O=>{var K=Ir(),oe=u(i(K),2),ie=i(oe,!0);o(oe),o(K),Z(be=>P(ie,be),[()=>d.relay_countries.join(", ")]),w(O,K)};$(U,O=>{d.relay_countries&&d.relay_countries.length>0&&O(V)})}var I=u(U,2);{var M=O=>{var K=Br(),oe=u(i(K),2),ie=i(oe),be=i(ie),ue=u(be);{var pe=fe=>{var me=Et("...");w(fe,me)};$(ue,fe=>{d.supported_nips.length>5&&fe(pe)})}o(ie),o(oe),o(K),Z(fe=>P(be,`Supports ${d.supported_nips.length??""} NIPs: ${fe??""} `),[()=>d.supported_nips.slice(0,5).join(", ")]),w(O,K)};$(I,O=>{d.supported_nips&&d.supported_nips.length>0&&O(M)})}var ae=u(I,2),Y=i(ae);{var G=O=>{var K=Tr();w(O,K)};$(Y,O=>{d.limitation?.payment_required&&O(G)})}var q=u(Y,2);{var se=O=>{var K=Cr();w(O,K)};$(q,O=>{d.limitation?.auth_required&&O(se)})}var re=u(q,2);{var he=O=>{var K=Mr(),oe=i(K);o(K),Z(()=>P(oe,`üìß ${d.contact??""}`)),w(O,K)};$(re,O=>{d.contact&&O(he)})}o(ae),o(ee),w(N,ee)};$(L,N=>{d&&N(z)})}var D=u(L,2),j=i(D),X=i(j);Oe(X),X.__change=[Nr,a],Ie(2),o(j);var T=u(j,2),H=i(T);Oe(H),H.__change=[Lr,a],Ie(2),o(T),o(D),o(p),Z(()=>{P(_,a.relay.url),ct(X,a.relay.read),ct(H,a.relay.write)}),w(c,p),Ve()}Ke(["change"]);function Ur(c,a,d){if(n(a).url&&!Ae.relays.some(p=>p.url===n(a).url)){const p=n(a).url.startsWith("wss://")||n(a).url.startsWith("ws://")?n(a).url:`wss://${n(a).url}`;Ae.addRelay({...n(a),enabled:!0,url:p}),y(a,{url:"",read:!0,write:!0},!0),y(d,!1)}}var Pr=()=>Ae.updateRelayAuth({mode:"always"}),Hr=()=>Ae.updateRelayAuth({mode:"ask"}),Or=(c,a)=>Ae.toggleRelay(n(a).url),jr=Ye('<svg class="w-3 h-3 text-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),Vr=(c,a,d)=>a(n(d).url),$r=(c,a)=>Ae.removeRelay(n(a).url),zr=B('<div><div class="flex flex-col md:flex-row md:items-start md:justify-between gap-3"><div class="flex-1"><div class="flex items-start md:items-center gap-3"><button><!></button> <!></div></div> <div class="flex items-center gap-2 ml-8 md:ml-0"><button class="p-1.5 md:p-2 hover:bg-neutral-100 dark:hover:bg-card rounded-lg transition-colors disabled:opacity-50" title="Test connection"><svg class="w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></button> <button class="p-1.5 md:p-2 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-lg transition-colors group" title="Remove relay"><svg class="w-4 h-4 text-muted-foreground group-hover:text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div></div>'),Kr=(c,a,d)=>{y(a,!1),y(d,{url:"",read:!0,write:!0},!0)},Yr=B('<div class="border-2 border-dashed border-primary-300 dark:border-primary-700 rounded-lg p-4"><div class="space-y-3"><input type="text" placeholder="wss://relay.example.com" class="w-full px-3 py-2 bg-card border border dark:border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"/> <div class="flex items-center gap-4"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 text-primary rounded focus:ring-orange-500"/> <span class="text-sm text-muted-foreground">Read</span></label> <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 text-primary rounded focus:ring-orange-500"/> <span class="text-sm text-muted-foreground">Write</span></label></div> <div class="flex gap-2"><button class="px-4 py-2 bg-primary text-foreground rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">Add Relay</button> <button class="px-4 py-2 bg-neutral-200 dark:bg-background text-muted-foreground rounded-lg hover:bg-neutral-300 dark:hover:bg-card transition-colors">Cancel</button></div></div></div>'),Gr=(c,a)=>y(a,!0),qr=B('<button class="w-full border-2 border-dashed border rounded-lg p-4 hover:border-primary dark:hover:border-primary transition-colors group"><div class="flex items-center justify-center gap-2 text-muted-foreground group-hover:text-primary dark:group-hover:text-primary"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> <span class="font-medium">Add Relay</span></div></button>'),Xr=B('<div class="space-y-6"><div><h2 class="text-xl font-semibold text-foreground mb-2">Relay Configuration</h2> <p class="text-sm text-muted-foreground">Configure which Nostr relays your app connects to for reading and publishing events.</p></div> <div class="bg-card border rounded-lg p-4"><div class="flex items-start gap-3"><svg class="w-5 h-5 text-primary flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg> <div class="flex-1"><h3 class="font-medium text-foreground mb-1">Relay Authentication</h3> <p class="text-sm text-muted-foreground mb-3">Control how to handle relays that require authentication</p> <div class="space-y-2"><label class="flex items-start gap-3 cursor-pointer group"><input type="radio" name="authMode" value="always" class="w-4 h-4 text-primary mt-0.5 focus:ring-2 focus:ring-primary"/> <div class="flex-1"><span class="text-sm font-medium text-foreground group-hover:text-primary transition-colors">Always authenticate</span> <p class="text-xs text-muted-foreground mt-0.5">Automatically authenticate to any relay that requests it</p></div></label> <label class="flex items-start gap-3 cursor-pointer group"><input type="radio" name="authMode" value="ask" class="w-4 h-4 text-primary mt-0.5 focus:ring-2 focus:ring-primary"/> <div class="flex-1"><span class="text-sm font-medium text-foreground group-hover:text-primary transition-colors">Ask each time</span> <p class="text-xs text-muted-foreground mt-0.5">Show a confirmation dialog before authenticating to relays</p></div></label></div></div></div></div> <div class="grid grid-cols-3 gap-2 md:gap-4"><div class="bg-neutral-50 dark:bg-background rounded-lg p-3 md:p-4"><div class="flex items-center gap-1 md:gap-2 text-green-600 dark:text-green-400 mb-1"><svg class="w-3 h-3 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"></path></svg> <span class="text-xs md:text-sm font-medium">Active</span></div> <div class="text-xl md:text-2xl font-bold text-foreground"> </div></div> <div class="bg-neutral-50 dark:bg-background rounded-lg p-3 md:p-4"><div class="flex items-center gap-1 md:gap-2 text-blue-600 dark:text-blue-400 mb-1"><svg class="w-3 h-3 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg> <span class="text-xs md:text-sm font-medium">Read</span></div> <div class="text-xl md:text-2xl font-bold text-foreground"> </div></div> <div class="bg-neutral-50 dark:bg-background rounded-lg p-3 md:p-4"><div class="flex items-center gap-1 md:gap-2 text-primary dark:text-primary mb-1"><svg class="w-3 h-3 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg> <span class="text-xs md:text-sm font-medium">Write</span></div> <div class="text-xl md:text-2xl font-bold text-foreground"> </div></div></div> <div class="space-y-2"><!> <!></div> <div class="bg-yellow-50 dark:bg-yellow-950/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4"><div class="flex gap-3"><svg class="w-5 h-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <div class="text-sm text-yellow-800 dark:text-yellow-300"><p class="font-medium mb-1">Important</p> <p>Changes to relay configuration will take effect after refreshing the app.</p></div></div></div></div>');function Wr(c,a){je(a,!0);let d=le(!1),p=le(Xe({url:"",read:!0,write:!0})),h=le(null),f=le(Xe({}));async function g(I){y(h,I,!0),y(f,{...n(f),[I]:"testing"},!0),setTimeout(()=>{const M=Math.random()>.3;y(f,{...n(f),[I]:M?"connected":"disconnected"},!0),y(h,null)},1500)}function l(I){return n(h)===I?"testing":n(f)[I]||"disconnected"}let m=we(()=>Ae.relays);var _=Xr(),C=u(i(_),2),R=i(C),S=u(i(R),2),b=u(i(S),4),E=i(b),A=i(E);Oe(A),A.__change=[Pr],Ie(2),o(E);var L=u(E,2),z=i(L);Oe(z),z.__change=[Hr],Ie(2),o(L),o(b),o(S),o(R),o(C);var D=u(C,2),j=i(D),X=u(i(j),2),T=i(X,!0);o(X),o(j);var H=u(j,2),N=u(i(H),2),ee=i(N,!0);o(N),o(H);var J=u(H,2),te=u(i(J),2),Q=i(te,!0);o(te),o(J),o(D);var ne=u(D,2),ce=i(ne);Ue(ce,17,()=>n(m),I=>I.url,(I,M)=>{const ae=we(()=>l(n(M).url));var Y=zr(),G=i(Y),q=i(G),se=i(q),re=i(se);re.__click=[Or,M];var he=i(re);{var O=ue=>{var pe=jr();w(ue,pe)};$(he,ue=>{n(M).enabled&&ue(O)})}o(re);var K=u(re,2);Dr(K,{get relay(){return n(M)},get status(){return n(ae)},get connectionStatus(){return n(f)}}),o(se),o(q);var oe=u(q,2),ie=i(oe);ie.__click=[Vr,g,M];var be=u(ie,2);be.__click=[$r,M],o(oe),o(G),o(Y),Z(()=>{Ce(Y,1,`border rounded-lg p-4 transition-all ${n(M).enabled?"bg-card border":"bg-neutral-50 dark:bg-background border opacity-60"}`),Ce(re,1,`w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all flex-shrink-0 mt-0.5 md:mt-0 ${n(M).enabled?"bg-primary border-primary":"bg-card border dark:border"}`),ie.disabled=n(h)===n(M).url}),w(I,Y)});var xe=u(ce,2);{var U=I=>{var M=Yr(),ae=i(M),Y=i(ae);Oe(Y),It(Y,!0);var G=u(Y,2),q=i(G),se=i(q);Oe(se),Ie(2),o(q);var re=u(q,2),he=i(re);Oe(he),Ie(2),o(re),o(G);var O=u(G,2),K=i(O);K.__click=[Ur,p,d];var oe=u(K,2);oe.__click=[Kr,d,p],o(O),o(ae),o(M),Z(()=>K.disabled=!n(p).url),tt(Y,()=>n(p).url,ie=>n(p).url=ie),Nt(se,()=>n(p).read,ie=>n(p).read=ie),Nt(he,()=>n(p).write,ie=>n(p).write=ie),w(I,M)},V=I=>{var M=qr();M.__click=[Gr,d],w(I,M)};$(xe,I=>{n(d)?I(U):I(V,!1)})}o(ne),Ie(2),o(_),Z((I,M,ae)=>{ct(A,Ae.relayAuth.mode==="always"),ct(z,Ae.relayAuth.mode==="ask"),P(T,I),P(ee,M),P(Q,ae)},[()=>n(m).filter(I=>I.enabled).length,()=>n(m).filter(I=>I.enabled&&I.read).length,()=>n(m).filter(I=>I.enabled&&I.write).length]),w(c,_),Ve()}Ke(["change","click"]);var Jr=(c,a)=>a("en"),Zr=(c,a)=>a("es"),Qr=(c,a)=>a("fa"),ea=(c,a)=>a("km"),ta=(c,a)=>a("sn"),ra=(c,a)=>a("light"),aa=(c,a)=>a("dark"),na=(c,a)=>a("system"),oa=(c,a,d)=>a(n(d).id),sa=B('<button><div class="flex items-center gap-3"><div class="w-8 h-8 rounded-full flex-shrink-0"></div> <div class="flex flex-col items-start"><span class="font-medium text-foreground"> </span> <span class="text-xs text-muted-foreground"> </span></div></div></button>'),ia=B('<div class="space-y-6"><div><h2 class="text-lg font-semibold text-foreground mb-4"> </h2> <p class="text-sm text-muted-foreground mb-6"> </p></div> <div class="border-b border pb-6"><div class="flex items-center gap-3 mb-4"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <h3 class="text-base font-medium text-foreground"> </h3></div> <p class="text-sm text-muted-foreground mb-4"> </p> <div class="grid grid-cols-2 gap-3"><button><div class="flex items-center justify-center gap-2"><span class="text-lg">üá∫üá∏</span> <span class="font-medium">English</span></div></button> <button><div class="flex items-center justify-center gap-2"><span class="text-lg">üá™üá∏</span> <span class="font-medium">Espa√±ol</span></div></button> <button><div class="flex items-center justify-center gap-2"><span class="text-lg">üáÆüá∑</span> <span class="font-medium">ŸÅÿßÿ±ÿ≥€å</span></div></button> <button><div class="flex items-center justify-center gap-2"><span class="text-lg">üá∞üá≠</span> <span class="font-medium">·ûÅ·üí·ûò·üÇ·ûö</span></div></button> <button><div class="flex items-center justify-center gap-2"><span class="text-lg">üáøüáº</span> <span class="font-medium">Shona</span></div></button></div></div> <div class="border-b border pb-6"><div class="flex items-center gap-3 mb-4"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path></svg> <h3 class="text-base font-medium text-foreground"> </h3></div> <p class="text-sm text-muted-foreground mb-4"> </p> <div class="grid grid-cols-3 gap-3"><button><div class="flex flex-col items-center gap-2"><span class="text-2xl">‚òÄÔ∏è</span> <span class="text-sm font-medium"> </span></div></button> <button><div class="flex flex-col items-center gap-2"><span class="text-2xl">üåô</span> <span class="text-sm font-medium"> </span></div></button> <button><div class="flex flex-col items-center gap-2"><span class="text-2xl">üíª</span> <span class="text-sm font-medium"> </span></div></button></div></div> <div><div class="flex items-center gap-3 mb-4"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path></svg> <h3 class="text-base font-medium text-foreground">Accent Color</h3></div> <p class="text-sm text-muted-foreground mb-4">Choose your preferred accent color</p> <div class="grid grid-cols-2 gap-3"></div></div></div>');function la(c,a){je(a,!0);const d=()=>Qt(ar,"$t",p),[p,h]=er();function f(pe){Ae.setTheme(pe)}function g(pe){Ae.setThemeColor(pe)}function l(pe){Ae.setLanguage(pe)}const m=[{id:"orange",name:"Orange",hex:"#FF6B35",description:"Warm orange"},{id:"red",name:"Red",hex:"#E4104D",description:"Magenta / Raspberry red"},{id:"cyan",name:"Cyan",hex:"#00B7D3",description:"Bright cyan / Turquoise"},{id:"yellow",name:"Yellow",hex:"#FFD900",description:"Vivid yellow"},{id:"lime",name:"Lime",hex:"#97BF0D",description:"Lime green"}];var _=ia(),C=i(_),R=i(C),S=i(R,!0);o(R);var b=u(R,2),E=i(b,!0);o(b),o(C);var A=u(C,2),L=i(A),z=u(i(L),2),D=i(z,!0);o(z),o(L);var j=u(L,2),X=i(j,!0);o(j);var T=u(j,2),H=i(T);H.__click=[Jr,l];var N=u(H,2);N.__click=[Zr,l];var ee=u(N,2);ee.__click=[Qr,l];var J=u(ee,2);J.__click=[ea,l];var te=u(J,2);te.__click=[ta,l],o(T),o(A);var Q=u(A,2),ne=i(Q),ce=u(i(ne),2),xe=i(ce,!0);o(ce),o(ne);var U=u(ne,2),V=i(U,!0);o(U);var I=u(U,2),M=i(I);M.__click=[ra,f];var ae=i(M),Y=u(i(ae),2),G=i(Y,!0);o(Y),o(ae),o(M);var q=u(M,2);q.__click=[aa,f];var se=i(q),re=u(i(se),2),he=i(re,!0);o(re),o(se),o(q);var O=u(q,2);O.__click=[na,f];var K=i(O),oe=u(i(K),2),ie=i(oe,!0);o(oe),o(K),o(O),o(I),o(Q);var be=u(Q,2),ue=u(i(be),4);Ue(ue,21,()=>m,ze,(pe,fe)=>{var me=sa();me.__click=[oa,g,fe];var W=i(me),de=i(W),Se=u(de,2),Le=i(Se),Pe=i(Le,!0);o(Le);var Te=u(Le,2),Me=i(Te,!0);o(Te),o(Se),o(W),o(me),Z(()=>{Ce(me,1,`px-4 py-3 rounded-lg transition-all ${Ae.themeColor===n(fe).id?"bg-primary-50 dark:bg-primary-950/30":"bg-card hover:bg-accent"}`),vr(de,`background-color: ${n(fe).hex??""}`),P(Pe,n(fe).name),P(Me,n(fe).description)}),w(pe,me)}),o(ue),o(be),o(_),Z((pe,fe,me,W,de,Se,Le,Pe,Te)=>{P(S,pe),P(E,fe),P(D,me),P(X,W),Ce(H,1,`px-4 py-3 rounded-lg transition-all ${Ae.language==="en"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),Ce(N,1,`px-4 py-3 rounded-lg transition-all ${Ae.language==="es"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),Ce(ee,1,`px-4 py-3 rounded-lg transition-all ${Ae.language==="fa"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),Ce(J,1,`px-4 py-3 rounded-lg transition-all ${Ae.language==="km"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),Ce(te,1,`px-4 py-3 rounded-lg transition-all ${Ae.language==="sn"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),P(xe,de),P(V,Se),Ce(M,1,`px-4 py-3 rounded-lg transition-all ${Ae.theme==="light"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),P(G,Le),Ce(q,1,`px-4 py-3 rounded-lg transition-all ${Ae.theme==="dark"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),P(he,Pe),Ce(O,1,`px-4 py-3 rounded-lg transition-all ${Ae.theme==="system"?"bg-primary-50 dark:bg-primary-950/30 text-primary dark:text-primary":"bg-card text-muted-foreground hover:bg-accent"}`),P(ie,Te)},[()=>d()("settings.sections.appearance.title"),()=>d()("settings.sections.appearance.description"),()=>d()("settings.sections.appearance.language"),()=>d()("settings.sections.appearance.languageDescription"),()=>d()("settings.sections.appearance.theme"),()=>d()("settings.sections.appearance.themeDescription"),()=>d()("settings.sections.appearance.themes.light"),()=>d()("settings.sections.appearance.themes.dark"),()=>d()("settings.sections.appearance.themes.system")]),w(c,_),Ve(),h()}Ke(["click"]);async function da(c,a,d,p,h,f){if(!(!n(a)||n(d))){y(d,!0);try{if(!Fe.activeUser){y(p,[...n(h)],!0),localStorage.setItem("blossomServers",JSON.stringify(n(p))),Ze.success("Servers saved locally");return}n(f)||y(f,new At(Fe),!0),n(f).servers=n(h),await n(f).sign(),await n(f).publishReplaceable(),y(p,[...n(h)],!0),localStorage.setItem("blossomServers",JSON.stringify(n(p))),Ze.success("Blossom servers saved to Nostr")}catch(g){console.error("Failed to save blossom list:",g),Ze.error("Failed to save Blossom servers to Nostr")}finally{y(d,!1)}}}function ca(c,a,d){y(a,[...n(d)],!0)}var ua=B('<svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <span>Saving...</span>',1),va=B("<span>Save Changes</span>"),pa=B('<div class="flex items-center justify-between p-3 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg"><div class="flex items-center space-x-2 text-sm text-orange-800 dark:text-orange-200"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <span>You have unsaved changes</span></div> <div class="flex space-x-2"><button class="px-3 py-1.5 text-sm border border-neutral-300 dark:border-neutral-700 hover:bg-neutral-100 dark:hover:bg-neutral-800 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed">Discard</button> <button class="px-3 py-1.5 text-sm bg-primary hover:bg-accent-dark text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"><!></button></div></div>'),ha=B('<div class="flex items-center justify-center p-8"><svg class="animate-spin h-6 w-6 text-primary" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div>'),fa=B('<span class="text-xs bg-primary-100 dark:bg-primary-900/50 text-primary dark:text-primary-300 px-2 py-0.5 rounded">Primary</span>'),ma=(c,a,d)=>a(d),ga=B('<button class="text-red-500 hover:text-red-600 p-2" aria-label="Remove server"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>'),xa=B('<div class="flex items-center justify-between p-3 bg-neutral-50 dark:bg-background rounded-lg"><div class="flex items-center space-x-3"><div class="flex flex-col space-y-1"><button class="text-muted-foreground hover:text-muted-foreground dark:hover:text-muted-foreground disabled:opacity-30 disabled:cursor-not-allowed p-0.5" aria-label="Move up"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path></svg></button> <button class="text-muted-foreground hover:text-muted-foreground dark:hover:text-muted-foreground disabled:opacity-30 disabled:cursor-not-allowed p-0.5" aria-label="Move down"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button></div> <div><div class="flex items-center space-x-2"><span class="font-medium"> </span> <!></div> <a target="_blank" rel="noopener noreferrer" class="text-sm text-muted-foreground hover:text-primary dark:hover:text-primary flex items-center space-x-1"><span>Visit server</span> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a></div></div> <!></div>'),_a=B('<div class="space-y-2"></div>'),ba=(c,a,d)=>{y(a,!1),y(d,"")},ya=B('<div class="border border rounded-lg p-4"><label for="new-server" class="block text-sm font-medium mb-2">Add Blossom Server</label> <div class="flex space-x-2"><input id="new-server" type="text" placeholder="https://blossom.example.com" class="flex-1 px-3 py-2 bg-card border border dark:border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"/> <button class="px-4 py-2 bg-primary hover:bg-accent-dark text-foreground rounded-lg transition-colors">Add</button> <button class="p-2 text-muted-foreground hover:text-neutral-700 dark:hover:text-muted-foreground"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div></div>'),wa=(c,a)=>y(a,!0),ka=B('<button class="flex items-center space-x-2 px-4 py-2 text-primary dark:text-primary hover:bg-primary-50 dark:hover:bg-primary-900/20 rounded-lg transition-colors"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> <span>Add Server</span></button>'),Ea=(c,a,d)=>y(a,[...n(a),n(d)],!0),Aa=B('<div class="flex items-center justify-between p-3 bg-neutral-50 dark:bg-background rounded-lg"><span class="text-sm"> </span> <button class="text-sm text-primary dark:text-primary hover:text-accent-dark dark:hover:text-primary-300">Add</button></div>'),Sa=B('<p class="text-sm text-muted-foreground">All suggested servers have been added</p>'),Ia=B('<div class="space-y-6"><div><h3 class="text-lg font-semibold mb-2">Blossom Media Servers</h3> <p class="text-sm text-muted-foreground mb-4">Configure your Blossom servers for uploading images and media. The first server is your primary upload destination, and additional servers are used as mirrors for redundancy.</p></div> <!> <div class="space-y-3"><label class="text-sm font-medium">Your Blossom Servers</label> <!></div> <!> <div class="border-t border pt-4"><label class="text-sm font-medium block mb-3">Suggested Servers</label> <p class="text-sm text-muted-foreground mb-3">Popular public Blossom servers you can add to your list</p> <div class="space-y-2"><!> <!></div></div></div>');function Ba(c,a){je(a,!0);const d=["https://blossom.primal.net","https://blossom.nostr.hu","https://blossom.oxtr.dev"];let p=le(null),h=le(Xe([])),f=le(Xe([])),g=le(""),l=le(!1),m=le(!0),_=le(!1),C=we(()=>{if(!n(p))return n(h).length>0&&n(f).length>0;const U=n(p).servers;return U.length!==n(f).length?!0:!U.every((V,I)=>V===n(f)[I])});ot(()=>{R()});async function R(){y(m,!0);try{const U=Fe.activeUser;if(!U){const M=localStorage.getItem("blossomServers");if(M)try{y(h,JSON.parse(M),!0),y(f,[...n(h)],!0)}catch{y(h,[d[0]],!0),y(f,[...n(h)],!0)}else y(h,[d[0]],!0),y(f,[...n(h)],!0);y(m,!1);return}const V={kinds:[pr.BlossomList],authors:[U.pubkey]},I=await Fe.fetchEvent(V);if(I)y(p,At.from(I),!0),y(h,n(p).servers,!0),y(f,[...n(h)],!0),localStorage.setItem("blossomServers",JSON.stringify(n(h)));else{y(p,new At(Fe),!0);const M=localStorage.getItem("blossomServers");if(M)try{y(h,JSON.parse(M),!0)}catch{y(h,[d[0]],!0)}else y(h,[d[0]],!0);y(f,[...n(h)],!0),n(p).servers=n(h)}}catch(U){console.error("Failed to load blossom list:",U),Ze.error("Failed to load your Blossom servers");const V=localStorage.getItem("blossomServers");if(V)try{y(h,JSON.parse(V),!0),y(f,[...n(h)],!0)}catch{y(h,[d[0]],!0),y(f,[...n(h)],!0)}else y(h,[d[0]],!0),y(f,[...n(h)],!0)}finally{y(m,!1)}}function S(){if(n(g).trim())try{const U=new URL(n(g).trim());if(!U.protocol.startsWith("http")){Ze.error("Please enter a valid HTTP or HTTPS URL");return}const V=U.origin+U.pathname.replace(/\/$/,"");if(n(f).includes(V)){Ze.error("This server is already in your list");return}y(f,[...n(f),V],!0),y(g,""),y(l,!1)}catch{Ze.error("Please enter a valid URL")}}function b(U){if(n(f).length===1){Ze.error("You must have at least one Blossom server");return}y(f,n(f).filter(V=>V!==U),!0)}function E(U){if(U===0)return;const V=[...n(f)];[V[U-1],V[U]]=[V[U],V[U-1]],y(f,V,!0)}function A(U){if(U===n(f).length-1)return;const V=[...n(f)];[V[U],V[U+1]]=[V[U+1],V[U]],y(f,V,!0)}var L=Ia(),z=u(i(L),2);{var D=U=>{var V=pa(),I=u(i(V),2),M=i(I);M.__click=[ca,f,h];var ae=u(M,2);ae.__click=[da,C,_,h,f,p];var Y=i(ae);{var G=se=>{var re=ua();Ie(2),w(se,re)},q=se=>{var re=va();w(se,re)};$(Y,se=>{n(_)?se(G):se(q,!1)})}o(ae),o(I),o(V),Z(()=>{M.disabled=n(_),ae.disabled=n(_)}),w(U,V)};$(z,U=>{n(C)&&U(D)})}var j=u(z,2),X=u(i(j),2);{var T=U=>{var V=ha();w(U,V)},H=U=>{var V=_a();Ue(V,22,()=>n(f),I=>I,(I,M,ae)=>{var Y=xa(),G=i(Y),q=i(G),se=i(q);se.__click=()=>E(n(ae));var re=u(se,2);re.__click=()=>A(n(ae)),o(q);var he=u(q,2),O=i(he),K=i(O),oe=i(K,!0);o(K);var ie=u(K,2);{var be=me=>{var W=fa();w(me,W)};$(ie,me=>{n(ae)===0&&me(be)})}o(O);var ue=u(O,2);o(he),o(G);var pe=u(G,2);{var fe=me=>{var W=ga();W.__click=[ma,b,M],w(me,W)};$(pe,me=>{n(f).length>1&&me(fe)})}o(Y),Z(()=>{se.disabled=n(ae)===0,re.disabled=n(ae)===n(f).length-1,P(oe,M),nt(ue,"href",M)}),w(I,Y)}),o(V),w(U,V)};$(X,U=>{n(m)?U(T):U(H,!1)})}o(j);var N=u(j,2);{var ee=U=>{var V=ya(),I=u(i(V),2),M=i(I);Oe(M);var ae=u(M,2);ae.__click=S;var Y=u(ae,2);Y.__click=[ba,l,g],o(I),o(V),Zt("keypress",M,G=>G.key==="Enter"&&S()),tt(M,()=>n(g),G=>y(g,G)),w(U,V)},J=U=>{var V=ka();V.__click=[wa,l],w(U,V)};$(N,U=>{n(l)?U(ee):U(J,!1)})}var te=u(N,2),Q=u(i(te),4),ne=i(Q);Ue(ne,17,()=>d.filter(U=>!n(f).includes(U)),ze,(U,V)=>{var I=Aa(),M=i(I),ae=i(M,!0);o(M);var Y=u(M,2);Y.__click=[Ea,f,V],o(I),Z(()=>P(ae,n(V))),w(U,I)});var ce=u(ne,2);{var xe=U=>{var V=Sa();w(U,V)};$(ce,U=>{d.every(V=>n(f).includes(V))&&U(xe)})}o(Q),o(te),o(L),w(c,L),Ve()}Ke(["click"]);var De=(c=>(c.NO_USER="NO_USER",c.NO_PRIVATE_KEY="NO_PRIVATE_KEY",c.INVALID_PASSPHRASE="INVALID_PASSPHRASE",c.INVALID_PUBKEY="INVALID_PUBKEY",c.DUPLICATE_TRUSTEE="DUPLICATE_TRUSTEE",c.MAX_TRUSTEES_EXCEEDED="MAX_TRUSTEES_EXCEEDED",c.ENCRYPTION_FAILED="ENCRYPTION_FAILED",c.DECRYPTION_FAILED="DECRYPTION_FAILED",c.KEY_DERIVATION_FAILED="KEY_DERIVATION_FAILED",c.SHAMIR_SPLIT_FAILED="SHAMIR_SPLIT_FAILED",c.SHAMIR_JOIN_FAILED="SHAMIR_JOIN_FAILED",c.EVENT_CREATION_FAILED="EVENT_CREATION_FAILED",c.EVENT_SIGNING_FAILED="EVENT_SIGNING_FAILED",c.EVENT_PUBLISHING_FAILED="EVENT_PUBLISHING_FAILED",c.METADATA_PUBLISHING_FAILED="METADATA_PUBLISHING_FAILED",c.METADATA_FETCH_FAILED="METADATA_FETCH_FAILED",c.SHARD_FETCH_FAILED="SHARD_FETCH_FAILED",c.INVALID_THRESHOLD="INVALID_THRESHOLD",c.INVALID_SHARD_COUNT="INVALID_SHARD_COUNT",c.INSUFFICIENT_SHARDS="INSUFFICIENT_SHARDS",c.UNKNOWN_ERROR="UNKNOWN_ERROR",c))(De||{});class He extends Error{constructor(a,d,p){super(d),this.code=a,this.cause=p,this.name="BackupError",Error.captureStackTrace&&Error.captureStackTrace(this,He)}static from(a,d,p){if(a instanceof He)return a;const h=a instanceof Error?a.message:p;return new He(d,h,a)}static is(a,d){return a instanceof He&&a.code===d}getUserMessage(){return{NO_USER:"Please log in to create a backup",NO_PRIVATE_KEY:"Private key not found. Please log in with a private key.",INVALID_PASSPHRASE:"Passphrase does not meet security requirements",INVALID_PUBKEY:"Invalid public key format",DUPLICATE_TRUSTEE:"This person is already in your trustee list",MAX_TRUSTEES_EXCEEDED:"Maximum number of trustees reached",ENCRYPTION_FAILED:"Failed to encrypt data",DECRYPTION_FAILED:"Failed to decrypt data",KEY_DERIVATION_FAILED:"Failed to derive encryption key",SHAMIR_SPLIT_FAILED:"Failed to split secret into shards",SHAMIR_JOIN_FAILED:"Failed to reconstruct secret from shards",EVENT_CREATION_FAILED:"Failed to create event",EVENT_SIGNING_FAILED:"Failed to sign event",EVENT_PUBLISHING_FAILED:"Failed to publish event to relays",METADATA_PUBLISHING_FAILED:"Failed to publish backup metadata",METADATA_FETCH_FAILED:"Failed to fetch backup metadata",SHARD_FETCH_FAILED:"Failed to fetch shard",INVALID_THRESHOLD:"Invalid threshold value",INVALID_SHARD_COUNT:"Invalid shard count",INSUFFICIENT_SHARDS:"Not enough shards to reconstruct secret",UNKNOWN_ERROR:"An unknown error occurred"}[this.code]||this.message}}async function Qe(c,a,d){try{return await c()}catch(p){throw He.from(p,a,d)}}var lt={},ut={},Ge={},Lt;function rt(){if(Lt)return Ge;Lt=1,Object.defineProperty(Ge,"__esModule",{value:!0});const c=29;Ge.PRIMITIVE_POLYNOMIAL=c;const a=128;Ge.BIT_PADDING=a;const d=8;Ge.BIT_COUNT=d;const p=2**d;Ge.BIT_SIZE=p;const h=2;Ge.BYTES_PER_CHARACTER=h;const f=6;Ge.MAX_BYTES_PER_CHARACTER=f;const g=p-1;Ge.MAX_SHARES=g;const l="utf8";Ge.UTF8_ENCODING=l;const m="binary";Ge.BIN_ENCODING=m;const _="hex";return Ge.HEX_ENCODING=_,Ge}var vt={},at={},Ft;function Tt(){if(Ft)return at;Ft=1,Object.defineProperty(at,"__esModule",{value:!0});const c=rt(),a=new Array(4*c.BIT_SIZE).join("0");at.zeroes=a;const d=new Array(c.BIT_SIZE).fill(0);at.logs=d;const p=new Array(c.BIT_SIZE).fill(0);at.exps=p;for(let h=0,f=1;h<c.BIT_SIZE;++h)p[h]=f,d[f]=h,f=f<<1,f>=c.BIT_SIZE&&(f=f^c.PRIMITIVE_POLYNOMIAL,f=f&c.MAX_SHARES);return at}var Dt;function Ta(){if(Dt)return vt;Dt=1,Object.defineProperty(vt,"__esModule",{value:!0});const c=Tt(),a=rt();function d(p,h){const f=a.MAX_SHARES;let g=0,l=0;for(let m=0;m<h[0].length;++m)if(h[1][m]){g=c.logs[h[1][m]];for(let _=0;_<h[0].length;++_)if(m!==_){if(p===h[0][_]){g=-1;break}const C=c.logs[p^h[0][_]]-c.logs[h[0][m]^h[0][_]];g=(g+C+f)%f}l=l===-1?l:l^c.exps[g]}return l}return vt.lagrange=d,vt}var pt={},Ut;function Ca(){if(Ut)return pt;Ut=1,Object.defineProperty(pt,"__esModule",{value:!0});const c=rt();function a(d){const p={id:null,bits:null,data:null};Buffer.isBuffer(d)&&(d=d.toString("hex")),d[0]==="0"&&(d=d.slice(1)),p.bits=parseInt(d.slice(0,1),36);const g=`^([a-kA-K3-9]{1})([a-fA-F0-9]{${(c.BIT_SIZE-1).toString(16).length}})([a-fA-F0-9]+)$`,l=new RegExp(g).exec(d);return l&&l.length&&(p.id=parseInt(l[2],16),p.data=l[3]),p}return pt.parse=a,pt}var We={},Pt;function nr(){if(Pt)return We;Pt=1,Object.defineProperty(We,"__esModule",{value:!0});const c=Tt(),a=rt();function d(m,_){let C=0,R=m;if(_||(_=a.BIT_COUNT),m&&(C=m.length%_),C){const S=-(_-C+m.length);R=(c.zeroes+m).slice(S)}return R}We.pad=d;function p(m,_){const C=2*a.BYTES_PER_CHARACTER;if(_||(_=a.UTF8_ENCODING),typeof m=="string")return R();if(Buffer.isBuffer(m))return S();throw new TypeError("Expecting a string or buffer as input.");function R(){const b=[];if(a.UTF8_ENCODING===_)for(let E=0;E<m.length;++E){const A=Number(String.fromCharCode(m[E])).toString(16);b.unshift(d(A,C))}if(a.BIN_ENCODING===_){m=d(m,4);for(let E=m.length;E>=4;E-=4){const A=m.slice(E-4,E),L=parseInt(A,2).toString(16);b.unshift(L)}}return b.join("")}function S(){const b=[];for(let E=0;E<m.length;++E){const A=m[E].toString(16);b.unshift(d(A,C))}return b.join("")}}We.hex=p;function h(m,_){const C=[];_||(_=16);for(let R=m.length-1;R>=0;--R){let S=null;if(Buffer.isBuffer(m)&&(S=m[R]),typeof m=="string"&&(S=parseInt(m[R],_)),Array.isArray(m)&&(S=m[R],typeof S=="string"&&(S=parseInt(S,_))),S===null)throw new TypeError("Unsupported type for chunk in buffer array.");C.unshift(d(S.toString(2),4))}return C.join("")}We.bin=h;function f(m,_){m=parseInt(m,16);const C=(a.BIT_SIZE-1).toString(16).length,R=Buffer.concat([Buffer.from(a.BIT_COUNT.toString(36).toUpperCase()),Buffer.from(d(m.toString(16),C))]);return Buffer.isBuffer(_)===!1&&(_=Buffer.from(_)),Buffer.concat([R,_])}We.encode=f;function g(m,_){const C=2*a.BYTES_PER_CHARACTER,R=C,S=[];Buffer.isBuffer(m)&&(m=m.toString(_)),m=d(m,C);for(let b=0;b<m.length;b+=R){const E=m.slice(b,b+R),A=parseInt(E,16);S.unshift(A)}return Buffer.from(S)}We.decode=g;function l(m,_,C){const R=[];let S=0;for(Buffer.isBuffer(m)&&(m=m.toString()),_&&(m=d(m,_)),S=m.length;S>a.BIT_COUNT;S-=a.BIT_COUNT){const b=m.slice(S-a.BIT_COUNT,S),E=parseInt(b,C);R.push(E)}return R.push(parseInt(m.slice(0,S),C)),R}return We.split=l,We}var Ht;function Ma(){if(Ht)return ut;Ht=1,Object.defineProperty(ut,"__esModule",{value:!0});const c=rt(),a=Ta(),d=Ca(),p=nr();function h(f){const g=[],l=[],m=[],_=f.length;for(let E=0;E<_;++E){const A=d.parse(f[E]);if(l.indexOf(A.id)===-1){l.push(A.id);const L=p.bin(A.data,16),z=p.split(L,0,2);for(let D=0;D<z.length;++D)m[D]||(m[D]=[]),m[D][l.length-1]=z[D]}}for(let E=0;E<m.length;++E){const A=a.lagrange(0,[l,m[E]]);g.unshift(p.pad(A.toString(2)))}const C=g.join(""),R=C.slice(1+C.indexOf("1")),S=p.hex(R,c.BIN_ENCODING),b=p.decode(S);return Buffer.from(b)}return ut.combine=h,ut}var ht={},ft={},mt={},Ot;function Ra(){if(Ot)return mt;Ot=1,Object.defineProperty(mt,"__esModule",{value:!0});const c=rt(),a=Tt();function d(p,h){const f=c.MAX_SHARES,g=h.length-1;let l=0;for(let m=g;m>=0;--m)l=l===0?h[m]:a.exps[(a.logs[p]+a.logs[l])%f]^h[m];return l}return mt.horner=d,mt}var jt;function Na(){if(jt)return ft;jt=1,Object.defineProperty(ft,"__esModule",{value:!0});const c=Ra();function a(d,p){const h=p.random,f=[d],g=[],l=p.threshold,m=p.shares;for(let _=1;_<l;++_)f[_]=parseInt(h(1).toString("hex"),16);for(let _=1;_<1+m;++_)g[_-1]={x:_,y:c.horner(_,f)};return g}return ft.points=a,ft}var gt={},xt={exports:{}},_t={exports:{}},kt={},dt={},Vt;function La(){if(Vt)return dt;Vt=1,dt.byteLength=l,dt.toByteArray=_,dt.fromByteArray=S;for(var c=[],a=[],d=typeof Uint8Array<"u"?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,f=p.length;h<f;++h)c[h]=p[h],a[p.charCodeAt(h)]=h;a[45]=62,a[95]=63;function g(b){var E=b.length;if(E%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var A=b.indexOf("=");A===-1&&(A=E);var L=A===E?0:4-A%4;return[A,L]}function l(b){var E=g(b),A=E[0],L=E[1];return(A+L)*3/4-L}function m(b,E,A){return(E+A)*3/4-A}function _(b){var E,A=g(b),L=A[0],z=A[1],D=new d(m(b,L,z)),j=0,X=z>0?L-4:L,T;for(T=0;T<X;T+=4)E=a[b.charCodeAt(T)]<<18|a[b.charCodeAt(T+1)]<<12|a[b.charCodeAt(T+2)]<<6|a[b.charCodeAt(T+3)],D[j++]=E>>16&255,D[j++]=E>>8&255,D[j++]=E&255;return z===2&&(E=a[b.charCodeAt(T)]<<2|a[b.charCodeAt(T+1)]>>4,D[j++]=E&255),z===1&&(E=a[b.charCodeAt(T)]<<10|a[b.charCodeAt(T+1)]<<4|a[b.charCodeAt(T+2)]>>2,D[j++]=E>>8&255,D[j++]=E&255),D}function C(b){return c[b>>18&63]+c[b>>12&63]+c[b>>6&63]+c[b&63]}function R(b,E,A){for(var L,z=[],D=E;D<A;D+=3)L=(b[D]<<16&16711680)+(b[D+1]<<8&65280)+(b[D+2]&255),z.push(C(L));return z.join("")}function S(b){for(var E,A=b.length,L=A%3,z=[],D=16383,j=0,X=A-L;j<X;j+=D)z.push(R(b,j,j+D>X?X:j+D));return L===1?(E=b[A-1],z.push(c[E>>2]+c[E<<4&63]+"==")):L===2&&(E=(b[A-2]<<8)+b[A-1],z.push(c[E>>10]+c[E>>4&63]+c[E<<2&63]+"=")),z.join("")}return dt}var bt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var $t;function Fa(){return $t||($t=1,bt.read=function(c,a,d,p,h){var f,g,l=h*8-p-1,m=(1<<l)-1,_=m>>1,C=-7,R=d?h-1:0,S=d?-1:1,b=c[a+R];for(R+=S,f=b&(1<<-C)-1,b>>=-C,C+=l;C>0;f=f*256+c[a+R],R+=S,C-=8);for(g=f&(1<<-C)-1,f>>=-C,C+=p;C>0;g=g*256+c[a+R],R+=S,C-=8);if(f===0)f=1-_;else{if(f===m)return g?NaN:(b?-1:1)*(1/0);g=g+Math.pow(2,p),f=f-_}return(b?-1:1)*g*Math.pow(2,f-p)},bt.write=function(c,a,d,p,h,f){var g,l,m,_=f*8-h-1,C=(1<<_)-1,R=C>>1,S=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=p?0:f-1,E=p?1:-1,A=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(l=isNaN(a)?1:0,g=C):(g=Math.floor(Math.log(a)/Math.LN2),a*(m=Math.pow(2,-g))<1&&(g--,m*=2),g+R>=1?a+=S/m:a+=S*Math.pow(2,1-R),a*m>=2&&(g++,m/=2),g+R>=C?(l=0,g=C):g+R>=1?(l=(a*m-1)*Math.pow(2,h),g=g+R):(l=a*Math.pow(2,R-1)*Math.pow(2,h),g=0));h>=8;c[d+b]=l&255,b+=E,l/=256,h-=8);for(g=g<<h|l,_+=h;_>0;c[d+b]=g&255,b+=E,g/=256,_-=8);c[d+b-E]|=A*128}),bt}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var zt;function Da(){return zt||(zt=1,(function(c){const a=La(),d=Fa(),p=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;c.Buffer=l,c.SlowBuffer=D,c.INSPECT_MAX_BYTES=50;const h=2147483647;c.kMaxLength=h,l.TYPED_ARRAY_SUPPORT=f(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function g(r){if(r>h)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,l.prototype),e}function l(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return R(r)}return m(r,e,t)}l.poolSize=8192;function m(r,e,t){if(typeof r=="string")return S(r,e);if(ArrayBuffer.isView(r))return E(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(Ne(r,ArrayBuffer)||r&&Ne(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ne(r,SharedArrayBuffer)||r&&Ne(r.buffer,SharedArrayBuffer)))return A(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const s=r.valueOf&&r.valueOf();if(s!=null&&s!==r)return l.from(s,e,t);const v=L(r);if(v)return v;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return l.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}l.from=function(r,e,t){return m(r,e,t)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function _(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function C(r,e,t){return _(r),r<=0?g(r):e!==void 0?typeof t=="string"?g(r).fill(e,t):g(r).fill(e):g(r)}l.alloc=function(r,e,t){return C(r,e,t)};function R(r){return _(r),g(r<0?0:z(r)|0)}l.allocUnsafe=function(r){return R(r)},l.allocUnsafeSlow=function(r){return R(r)};function S(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=j(r,e)|0;let s=g(t);const v=s.write(r,e);return v!==t&&(s=s.slice(0,v)),s}function b(r){const e=r.length<0?0:z(r.length)|0,t=g(e);for(let s=0;s<e;s+=1)t[s]=r[s]&255;return t}function E(r){if(Ne(r,Uint8Array)){const e=new Uint8Array(r);return A(e.buffer,e.byteOffset,e.byteLength)}return b(r)}function A(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let s;return e===void 0&&t===void 0?s=new Uint8Array(r):t===void 0?s=new Uint8Array(r,e):s=new Uint8Array(r,e,t),Object.setPrototypeOf(s,l.prototype),s}function L(r){if(l.isBuffer(r)){const e=z(r.length)|0,t=g(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||ge(r.length)?g(0):b(r);if(r.type==="Buffer"&&Array.isArray(r.data))return b(r.data)}function z(r){if(r>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return r|0}function D(r){return+r!=r&&(r=0),l.alloc(+r)}l.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==l.prototype},l.compare=function(e,t){if(Ne(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),Ne(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let s=e.length,v=t.length;for(let x=0,k=Math.min(s,v);x<k;++x)if(e[x]!==t[x]){s=e[x],v=t[x];break}return s<v?-1:v<s?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return l.alloc(0);let s;if(t===void 0)for(t=0,s=0;s<e.length;++s)t+=e[s].length;const v=l.allocUnsafe(t);let x=0;for(s=0;s<e.length;++s){let k=e[s];if(Ne(k,Uint8Array))x+k.length>v.length?(l.isBuffer(k)||(k=l.from(k)),k.copy(v,x)):Uint8Array.prototype.set.call(v,k,x);else if(l.isBuffer(k))k.copy(v,x);else throw new TypeError('"list" argument must be an Array of Buffers');x+=k.length}return v};function j(r,e){if(l.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||Ne(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,s=arguments.length>2&&arguments[2]===!0;if(!s&&t===0)return 0;let v=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Se(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Te(r).length;default:if(v)return s?-1:Se(r).length;e=(""+e).toLowerCase(),v=!0}}l.byteLength=j;function X(r,e,t){let s=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return ae(this,e,t);case"utf8":case"utf-8":return xe(this,e,t);case"ascii":return I(this,e,t);case"latin1":case"binary":return M(this,e,t);case"base64":return ce(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,e,t);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),s=!0}}l.prototype._isBuffer=!0;function T(r,e,t){const s=r[e];r[e]=r[t],r[t]=s}l.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)T(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)T(this,t,t+3),T(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)T(this,t,t+7),T(this,t+1,t+6),T(this,t+2,t+5),T(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?xe(this,0,e):X.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:l.compare(this,e)===0},l.prototype.inspect=function(){let e="";const t=c.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},p&&(l.prototype[p]=l.prototype.inspect),l.prototype.compare=function(e,t,s,v,x){if(Ne(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),s===void 0&&(s=e?e.length:0),v===void 0&&(v=0),x===void 0&&(x=this.length),t<0||s>e.length||v<0||x>this.length)throw new RangeError("out of range index");if(v>=x&&t>=s)return 0;if(v>=x)return-1;if(t>=s)return 1;if(t>>>=0,s>>>=0,v>>>=0,x>>>=0,this===e)return 0;let k=x-v,ve=s-t;const ke=Math.min(k,ve),Ee=this.slice(v,x),Be=e.slice(t,s);for(let _e=0;_e<ke;++_e)if(Ee[_e]!==Be[_e]){k=Ee[_e],ve=Be[_e];break}return k<ve?-1:ve<k?1:0};function H(r,e,t,s,v){if(r.length===0)return-1;if(typeof t=="string"?(s=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,ge(t)&&(t=v?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(v)return-1;t=r.length-1}else if(t<0)if(v)t=0;else return-1;if(typeof e=="string"&&(e=l.from(e,s)),l.isBuffer(e))return e.length===0?-1:N(r,e,t,s,v);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?v?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):N(r,[e],t,s,v);throw new TypeError("val must be string, number or Buffer")}function N(r,e,t,s,v){let x=1,k=r.length,ve=e.length;if(s!==void 0&&(s=String(s).toLowerCase(),s==="ucs2"||s==="ucs-2"||s==="utf16le"||s==="utf-16le")){if(r.length<2||e.length<2)return-1;x=2,k/=2,ve/=2,t/=2}function ke(Be,_e){return x===1?Be[_e]:Be.readUInt16BE(_e*x)}let Ee;if(v){let Be=-1;for(Ee=t;Ee<k;Ee++)if(ke(r,Ee)===ke(e,Be===-1?0:Ee-Be)){if(Be===-1&&(Be=Ee),Ee-Be+1===ve)return Be*x}else Be!==-1&&(Ee-=Ee-Be),Be=-1}else for(t+ve>k&&(t=k-ve),Ee=t;Ee>=0;Ee--){let Be=!0;for(let _e=0;_e<ve;_e++)if(ke(r,Ee+_e)!==ke(e,_e)){Be=!1;break}if(Be)return Ee}return-1}l.prototype.includes=function(e,t,s){return this.indexOf(e,t,s)!==-1},l.prototype.indexOf=function(e,t,s){return H(this,e,t,s,!0)},l.prototype.lastIndexOf=function(e,t,s){return H(this,e,t,s,!1)};function ee(r,e,t,s){t=Number(t)||0;const v=r.length-t;s?(s=Number(s),s>v&&(s=v)):s=v;const x=e.length;s>x/2&&(s=x/2);let k;for(k=0;k<s;++k){const ve=parseInt(e.substr(k*2,2),16);if(ge(ve))return k;r[t+k]=ve}return k}function J(r,e,t,s){return Me(Se(e,r.length-t),r,t,s)}function te(r,e,t,s){return Me(Le(e),r,t,s)}function Q(r,e,t,s){return Me(Te(e),r,t,s)}function ne(r,e,t,s){return Me(Pe(e,r.length-t),r,t,s)}l.prototype.write=function(e,t,s,v){if(t===void 0)v="utf8",s=this.length,t=0;else if(s===void 0&&typeof t=="string")v=t,s=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(s)?(s=s>>>0,v===void 0&&(v="utf8")):(v=s,s=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const x=this.length-t;if((s===void 0||s>x)&&(s=x),e.length>0&&(s<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");v||(v="utf8");let k=!1;for(;;)switch(v){case"hex":return ee(this,e,t,s);case"utf8":case"utf-8":return J(this,e,t,s);case"ascii":case"latin1":case"binary":return te(this,e,t,s);case"base64":return Q(this,e,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,e,t,s);default:if(k)throw new TypeError("Unknown encoding: "+v);v=(""+v).toLowerCase(),k=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ce(r,e,t){return e===0&&t===r.length?a.fromByteArray(r):a.fromByteArray(r.slice(e,t))}function xe(r,e,t){t=Math.min(r.length,t);const s=[];let v=e;for(;v<t;){const x=r[v];let k=null,ve=x>239?4:x>223?3:x>191?2:1;if(v+ve<=t){let ke,Ee,Be,_e;switch(ve){case 1:x<128&&(k=x);break;case 2:ke=r[v+1],(ke&192)===128&&(_e=(x&31)<<6|ke&63,_e>127&&(k=_e));break;case 3:ke=r[v+1],Ee=r[v+2],(ke&192)===128&&(Ee&192)===128&&(_e=(x&15)<<12|(ke&63)<<6|Ee&63,_e>2047&&(_e<55296||_e>57343)&&(k=_e));break;case 4:ke=r[v+1],Ee=r[v+2],Be=r[v+3],(ke&192)===128&&(Ee&192)===128&&(Be&192)===128&&(_e=(x&15)<<18|(ke&63)<<12|(Ee&63)<<6|Be&63,_e>65535&&_e<1114112&&(k=_e))}}k===null?(k=65533,ve=1):k>65535&&(k-=65536,s.push(k>>>10&1023|55296),k=56320|k&1023),s.push(k),v+=ve}return V(s)}const U=4096;function V(r){const e=r.length;if(e<=U)return String.fromCharCode.apply(String,r);let t="",s=0;for(;s<e;)t+=String.fromCharCode.apply(String,r.slice(s,s+=U));return t}function I(r,e,t){let s="";t=Math.min(r.length,t);for(let v=e;v<t;++v)s+=String.fromCharCode(r[v]&127);return s}function M(r,e,t){let s="";t=Math.min(r.length,t);for(let v=e;v<t;++v)s+=String.fromCharCode(r[v]);return s}function ae(r,e,t){const s=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>s)&&(t=s);let v="";for(let x=e;x<t;++x)v+=ye[r[x]];return v}function Y(r,e,t){const s=r.slice(e,t);let v="";for(let x=0;x<s.length-1;x+=2)v+=String.fromCharCode(s[x]+s[x+1]*256);return v}l.prototype.slice=function(e,t){const s=this.length;e=~~e,t=t===void 0?s:~~t,e<0?(e+=s,e<0&&(e=0)):e>s&&(e=s),t<0?(t+=s,t<0&&(t=0)):t>s&&(t=s),t<e&&(t=e);const v=this.subarray(e,t);return Object.setPrototypeOf(v,l.prototype),v};function G(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,s){e=e>>>0,t=t>>>0,s||G(e,t,this.length);let v=this[e],x=1,k=0;for(;++k<t&&(x*=256);)v+=this[e+k]*x;return v},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,s){e=e>>>0,t=t>>>0,s||G(e,t,this.length);let v=this[e+--t],x=1;for(;t>0&&(x*=256);)v+=this[e+--t]*x;return v},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e=e>>>0,t||G(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||G(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||G(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||G(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||G(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Re(function(e){e=e>>>0,fe(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&me(e,this.length-8);const v=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,x=this[++e]+this[++e]*2**8+this[++e]*2**16+s*2**24;return BigInt(v)+(BigInt(x)<<BigInt(32))}),l.prototype.readBigUInt64BE=Re(function(e){e=e>>>0,fe(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&me(e,this.length-8);const v=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],x=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+s;return(BigInt(v)<<BigInt(32))+BigInt(x)}),l.prototype.readIntLE=function(e,t,s){e=e>>>0,t=t>>>0,s||G(e,t,this.length);let v=this[e],x=1,k=0;for(;++k<t&&(x*=256);)v+=this[e+k]*x;return x*=128,v>=x&&(v-=Math.pow(2,8*t)),v},l.prototype.readIntBE=function(e,t,s){e=e>>>0,t=t>>>0,s||G(e,t,this.length);let v=t,x=1,k=this[e+--v];for(;v>0&&(x*=256);)k+=this[e+--v]*x;return x*=128,k>=x&&(k-=Math.pow(2,8*t)),k},l.prototype.readInt8=function(e,t){return e=e>>>0,t||G(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},l.prototype.readInt16LE=function(e,t){e=e>>>0,t||G(e,2,this.length);const s=this[e]|this[e+1]<<8;return s&32768?s|4294901760:s},l.prototype.readInt16BE=function(e,t){e=e>>>0,t||G(e,2,this.length);const s=this[e+1]|this[e]<<8;return s&32768?s|4294901760:s},l.prototype.readInt32LE=function(e,t){return e=e>>>0,t||G(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e=e>>>0,t||G(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Re(function(e){e=e>>>0,fe(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&me(e,this.length-8);const v=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(s<<24);return(BigInt(v)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),l.prototype.readBigInt64BE=Re(function(e){e=e>>>0,fe(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&me(e,this.length-8);const v=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(v)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+s)}),l.prototype.readFloatLE=function(e,t){return e=e>>>0,t||G(e,4,this.length),d.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e=e>>>0,t||G(e,4,this.length),d.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||G(e,8,this.length),d.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||G(e,8,this.length),d.read(this,e,!1,52,8)};function q(r,e,t,s,v,x){if(!l.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>v||e<x)throw new RangeError('"value" argument is out of bounds');if(t+s>r.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,s,v){if(e=+e,t=t>>>0,s=s>>>0,!v){const ve=Math.pow(2,8*s)-1;q(this,e,t,s,ve,0)}let x=1,k=0;for(this[t]=e&255;++k<s&&(x*=256);)this[t+k]=e/x&255;return t+s},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,s,v){if(e=+e,t=t>>>0,s=s>>>0,!v){const ve=Math.pow(2,8*s)-1;q(this,e,t,s,ve,0)}let x=s-1,k=1;for(this[t+x]=e&255;--x>=0&&(k*=256);)this[t+x]=e/k&255;return t+s},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,1,255,0),this[t]=e&255,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function se(r,e,t,s,v){pe(e,s,v,r,t,7);let x=Number(e&BigInt(4294967295));r[t++]=x,x=x>>8,r[t++]=x,x=x>>8,r[t++]=x,x=x>>8,r[t++]=x;let k=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=k,k=k>>8,r[t++]=k,k=k>>8,r[t++]=k,k=k>>8,r[t++]=k,t}function re(r,e,t,s,v){pe(e,s,v,r,t,7);let x=Number(e&BigInt(4294967295));r[t+7]=x,x=x>>8,r[t+6]=x,x=x>>8,r[t+5]=x,x=x>>8,r[t+4]=x;let k=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=k,k=k>>8,r[t+2]=k,k=k>>8,r[t+1]=k,k=k>>8,r[t]=k,t+8}l.prototype.writeBigUInt64LE=Re(function(e,t=0){return se(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=Re(function(e,t=0){return re(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(e,t,s,v){if(e=+e,t=t>>>0,!v){const ke=Math.pow(2,8*s-1);q(this,e,t,s,ke-1,-ke)}let x=0,k=1,ve=0;for(this[t]=e&255;++x<s&&(k*=256);)e<0&&ve===0&&this[t+x-1]!==0&&(ve=1),this[t+x]=(e/k>>0)-ve&255;return t+s},l.prototype.writeIntBE=function(e,t,s,v){if(e=+e,t=t>>>0,!v){const ke=Math.pow(2,8*s-1);q(this,e,t,s,ke-1,-ke)}let x=s-1,k=1,ve=0;for(this[t+x]=e&255;--x>=0&&(k*=256);)e<0&&ve===0&&this[t+x+1]!==0&&(ve=1),this[t+x]=(e/k>>0)-ve&255;return t+s},l.prototype.writeInt8=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},l.prototype.writeInt16LE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},l.prototype.writeInt32LE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,s){return e=+e,t=t>>>0,s||q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},l.prototype.writeBigInt64LE=Re(function(e,t=0){return se(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=Re(function(e,t=0){return re(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function he(r,e,t,s,v,x){if(t+s>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function O(r,e,t,s,v){return e=+e,t=t>>>0,v||he(r,e,t,4),d.write(r,e,t,s,23,4),t+4}l.prototype.writeFloatLE=function(e,t,s){return O(this,e,t,!0,s)},l.prototype.writeFloatBE=function(e,t,s){return O(this,e,t,!1,s)};function K(r,e,t,s,v){return e=+e,t=t>>>0,v||he(r,e,t,8),d.write(r,e,t,s,52,8),t+8}l.prototype.writeDoubleLE=function(e,t,s){return K(this,e,t,!0,s)},l.prototype.writeDoubleBE=function(e,t,s){return K(this,e,t,!1,s)},l.prototype.copy=function(e,t,s,v){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(s||(s=0),!v&&v!==0&&(v=this.length),t>=e.length&&(t=e.length),t||(t=0),v>0&&v<s&&(v=s),v===s||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("sourceEnd out of bounds");v>this.length&&(v=this.length),e.length-t<v-s&&(v=e.length-t+s);const x=v-s;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,s,v):Uint8Array.prototype.set.call(e,this.subarray(s,v),t),x},l.prototype.fill=function(e,t,s,v){if(typeof e=="string"){if(typeof t=="string"?(v=t,t=0,s=this.length):typeof s=="string"&&(v=s,s=this.length),v!==void 0&&typeof v!="string")throw new TypeError("encoding must be a string");if(typeof v=="string"&&!l.isEncoding(v))throw new TypeError("Unknown encoding: "+v);if(e.length===1){const k=e.charCodeAt(0);(v==="utf8"&&k<128||v==="latin1")&&(e=k)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<s)throw new RangeError("Out of range index");if(s<=t)return this;t=t>>>0,s=s===void 0?this.length:s>>>0,e||(e=0);let x;if(typeof e=="number")for(x=t;x<s;++x)this[x]=e;else{const k=l.isBuffer(e)?e:l.from(e,v),ve=k.length;if(ve===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(x=0;x<s-t;++x)this[x+t]=k[x%ve]}return this};const oe={};function ie(r,e,t){oe[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(v){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:v,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}ie("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ie("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),ie("ERR_OUT_OF_RANGE",function(r,e,t){let s=`The value of "${r}" is out of range.`,v=t;return Number.isInteger(t)&&Math.abs(t)>2**32?v=be(String(t)):typeof t=="bigint"&&(v=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(v=be(v)),v+="n"),s+=` It must be ${e}. Received ${v}`,s},RangeError);function be(r){let e="",t=r.length;const s=r[0]==="-"?1:0;for(;t>=s+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function ue(r,e,t){fe(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&me(e,r.length-(t+1))}function pe(r,e,t,s,v,x){if(r>t||r<e){const k=typeof e=="bigint"?"n":"";let ve;throw e===0||e===BigInt(0)?ve=`>= 0${k} and < 2${k} ** ${(x+1)*8}${k}`:ve=`>= -(2${k} ** ${(x+1)*8-1}${k}) and < 2 ** ${(x+1)*8-1}${k}`,new oe.ERR_OUT_OF_RANGE("value",ve,r)}ue(s,v,x)}function fe(r,e){if(typeof r!="number")throw new oe.ERR_INVALID_ARG_TYPE(e,"number",r)}function me(r,e,t){throw Math.floor(r)!==r?(fe(r,t),new oe.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new oe.ERR_BUFFER_OUT_OF_BOUNDS:new oe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const W=/[^+/0-9A-Za-z-_]/g;function de(r){if(r=r.split("=")[0],r=r.trim().replace(W,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Se(r,e){e=e||1/0;let t;const s=r.length;let v=null;const x=[];for(let k=0;k<s;++k){if(t=r.charCodeAt(k),t>55295&&t<57344){if(!v){if(t>56319){(e-=3)>-1&&x.push(239,191,189);continue}else if(k+1===s){(e-=3)>-1&&x.push(239,191,189);continue}v=t;continue}if(t<56320){(e-=3)>-1&&x.push(239,191,189),v=t;continue}t=(v-55296<<10|t-56320)+65536}else v&&(e-=3)>-1&&x.push(239,191,189);if(v=null,t<128){if((e-=1)<0)break;x.push(t)}else if(t<2048){if((e-=2)<0)break;x.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;x.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;x.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return x}function Le(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Pe(r,e){let t,s,v;const x=[];for(let k=0;k<r.length&&!((e-=2)<0);++k)t=r.charCodeAt(k),s=t>>8,v=t%256,x.push(v),x.push(s);return x}function Te(r){return a.toByteArray(de(r))}function Me(r,e,t,s){let v;for(v=0;v<s&&!(v+t>=e.length||v>=r.length);++v)e[v+t]=r[v];return v}function Ne(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function ge(r){return r!==r}const ye=(function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const s=t*16;for(let v=0;v<16;++v)e[s+v]=r[t]+r[v]}return e})();function Re(r){return typeof BigInt>"u"?F:r}function F(){throw new Error("BigInt not supported")}})(kt)),kt}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var Kt;function Ua(){return Kt||(Kt=1,(function(c,a){var d=Da(),p=d.Buffer;function h(g,l){for(var m in g)l[m]=g[m]}p.from&&p.alloc&&p.allocUnsafe&&p.allocUnsafeSlow?c.exports=d:(h(d,a),a.Buffer=f);function f(g,l,m){return p(g,l,m)}f.prototype=Object.create(p.prototype),h(p,f),f.from=function(g,l,m){if(typeof g=="number")throw new TypeError("Argument must not be a number");return p(g,l,m)},f.alloc=function(g,l,m){if(typeof g!="number")throw new TypeError("Argument must be a number");var _=p(g);return l!==void 0?typeof m=="string"?_.fill(l,m):_.fill(l):_.fill(0),_},f.allocUnsafe=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return p(g)},f.allocUnsafeSlow=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return d.SlowBuffer(g)}})(_t,_t.exports)),_t.exports}var Yt;function Pa(){if(Yt)return xt.exports;Yt=1;var c=65536,a=4294967295;function d(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var p=Ua().Buffer,h=globalThis.crypto||globalThis.msCrypto;h&&h.getRandomValues?xt.exports=f:xt.exports=d;function f(g,l){if(g>a)throw new RangeError("requested too many random bytes");var m=p.allocUnsafe(g);if(g>0)if(g>c)for(var _=0;_<g;_+=c)h.getRandomValues(m.slice(_,_+c));else h.getRandomValues(m);return typeof l=="function"?process.nextTick(function(){l(null,m)}):m}return xt.exports}var Gt;function Ha(){if(Gt)return gt;Gt=1,Object.defineProperty(gt,"__esModule",{value:!0});const c=Pa();function a(d){return c(32+d).slice(32)}return gt.random=a,gt}var qt;function Oa(){if(qt)return ht;qt=1,Object.defineProperty(ht,"__esModule",{value:!0});const c=Na(),a=Ha(),d=nr(),p=rt(),h=new Array(2*p.MAX_SHARES);function f(g,l){if(!g||g&&g.length===0)throw new TypeError("Secret cannot be empty.");if(typeof g=="string"&&(g=Buffer.from(g)),Buffer.isBuffer(g)===!1)throw new TypeError("Expecting secret to be a buffer.");if(!l||typeof l!="object")throw new TypeError("Expecting options to be an object.");if(typeof l.shares!="number")throw new TypeError("Expecting shares to be a number.");if(!l.shares||l.shares<0||l.shares>p.MAX_SHARES)throw new RangeError(`Shares must be 0 < shares <= ${p.MAX_SHARES}.`);if(typeof l.threshold!="number")throw new TypeError("Expecting threshold to be a number.");if(!l.threshold||l.threshold<0||l.threshold>l.shares)throw new RangeError(`Threshold must be 0 < threshold <= ${l.shares}.`);(!l.random||typeof l.random!="function")&&(l.random=a.random);const m=d.hex(g),_=d.bin(m,16),C=d.split("1"+_,p.BIT_PADDING,2);for(let S=0;S<C.length;++S){const b=c.points(C[S],l);for(let E=0;E<l.shares;++E){h[E]||(h[E]=b[E].x.toString(16));const A=b[E].y.toString(2),L=h[E+p.MAX_SHARES]||"";h[E+p.MAX_SHARES]=d.pad(A)+L}}for(let S=0;S<l.shares;++S){const b=h[S],E=d.hex(h[S+p.MAX_SHARES],p.BIN_ENCODING);h[S]=d.encode(b,E),h[S]=Buffer.from("0"+h[S],"hex")}const R=h.slice(0,l.shares);return h.fill(0),R}return ht.split=f,ht}var Xt;function ja(){if(Xt)return lt;Xt=1,Object.defineProperty(lt,"__esModule",{value:!0});const c=Ma();lt.combine=c.combine;const a=Oa();return lt.split=a.split,lt}var Va=ja();const Je={MIN_LENGTH:12,PBKDF2_ITERATIONS:6e5,SALT_LENGTH:16,IV_LENGTH:12,AES_KEY_LENGTH:256,HASH_ALGORITHM:"SHA-256"};function $a(c){const a=[];return c.length<Je.MIN_LENGTH&&a.push(`Passphrase must be at least ${Je.MIN_LENGTH} characters long`),/[A-Z]/.test(c)||a.push("Passphrase must contain at least one uppercase letter"),/[a-z]/.test(c)||a.push("Passphrase must contain at least one lowercase letter"),/[0-9]/.test(c)||a.push("Passphrase must contain at least one number"),/[^A-Za-z0-9]/.test(c)||a.push("Passphrase must contain at least one symbol"),{valid:a.length===0,errors:a}}async function za(c,a){return Qe(async()=>{const d=new TextEncoder,p=await crypto.subtle.importKey("raw",d.encode(c),"PBKDF2",!1,["deriveBits","deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:Je.PBKDF2_ITERATIONS,hash:Je.HASH_ALGORITHM},p,{name:"AES-GCM",length:Je.AES_KEY_LENGTH},!1,["encrypt","decrypt"])},De.KEY_DERIVATION_FAILED,"Failed to derive key from passphrase")}async function Ka(c,a){return Qe(async()=>{const d=crypto.getRandomValues(new Uint8Array(Je.SALT_LENGTH)),p=crypto.getRandomValues(new Uint8Array(Je.IV_LENGTH)),h=await za(a,d),f=new TextEncoder,g=await crypto.subtle.encrypt({name:"AES-GCM",iv:p},h,f.encode(c)),l=Je.SALT_LENGTH,m=Je.IV_LENGTH,_=new Uint8Array(l+m+g.byteLength);return _.set(d,0),_.set(p,l),_.set(new Uint8Array(g),l+m),btoa(String.fromCharCode(..._))},De.ENCRYPTION_FAILED,"Failed to encrypt data")}const $e={MIN_THRESHOLD:2,MAX_THRESHOLD:5,MIN_TOTAL_SHARDS:3,MAX_TOTAL_SHARDS:10};function Ya(c){const{threshold:a,totalShards:d}=c;if(a<$e.MIN_THRESHOLD||a>$e.MAX_THRESHOLD)throw new He(De.INVALID_THRESHOLD,`Threshold must be between ${$e.MIN_THRESHOLD} and ${$e.MAX_THRESHOLD}`);if(d<$e.MIN_TOTAL_SHARDS||d>$e.MAX_TOTAL_SHARDS)throw new He(De.INVALID_SHARD_COUNT,`Total shards must be between ${$e.MIN_TOTAL_SHARDS} and ${$e.MAX_TOTAL_SHARDS}`);if(a>d)throw new He(De.INVALID_THRESHOLD,"Threshold cannot be greater than total shards")}function Ga(c,a,d){try{const p=Buffer.from(c,"hex");return Va.split(p,{shares:d,threshold:a}).map(f=>f.toString("hex"))}catch(p){throw He.from(p,De.SHAMIR_SPLIT_FAILED,"Failed to split secret into shards")}}async function qa(c,a,d,p){const h=await Ka(c,a);return{index:d,encryptedData:h,totalShards:p.totalShards,threshold:p.threshold}}async function Xa(c,a,d){Ya(d);const p=Ga(c,d.threshold,d.totalShards),h=[];for(let f=0;f<p.length;f++){const g=await qa(p[f],a,f+1,d);h.push(g)}return h}const or={EVENT_KIND:3,SECONDS_PER_DAY:1440*60};async function Wa(){return Qe(async()=>{const c=Bt.generate(),a=await c.user();return[c,a.pubkey]},De.EVENT_CREATION_FAILED,"Failed to generate disposable key")}function Ja(c){const a=Math.floor(Date.now()/1e3),d=c*or.SECONDS_PER_DAY;return a+d}function Za(c){return JSON.stringify({encryptedShard:c.encryptedData,index:c.index,threshold:c.threshold,totalShards:c.totalShards})}function Qa(c,a,d){const p=new tr(c);return p.kind=or.EVENT_KIND,p.created_at=d,p.tags=[["p",a]],p}async function en(c,a,d){return Qe(async()=>{const p=new rr({pubkey:a});return await c.encrypt(p,d)},De.ENCRYPTION_FAILED,"Failed to encrypt shard payload")}async function tn(c,a){return Qe(async()=>{await c.sign(a)},De.EVENT_SIGNING_FAILED,"Failed to sign shard event")}async function rn(c){return Qe(async()=>{await c.publish()},De.EVENT_PUBLISHING_FAILED,"Failed to publish shard event")}async function an(c,a){const[d,p]=await Wa(),h=Ja(a.createdAtOffset),f=Qa(c,a.recipientPubkey,h),g=Za(a.shard);return f.content=await en(d,a.recipientPubkey,g),await tn(f,d),await rn(f),{eventId:f.id,recipientPubkey:a.recipientPubkey,relays:a.relays,shardIndex:a.shard.index,publishedAt:h,disposableKey:p}}function nn(c,a,d){const p="pending_shards",h=localStorage.getItem(p)||"[]",f=JSON.parse(h);f.push({shard:c,recipientPubkey:a,relays:d,storedAt:Date.now()}),localStorage.setItem(p,JSON.stringify(f))}class on{version=1;createdAt;threshold=0;publishedShards=[];constructor(){this.createdAt=Math.floor(Date.now()/1e3)}withVersion(a){return this.version=a,this}withCreatedAt(a){return this.createdAt=a,this}withThreshold(a){return this.threshold=a,this}withPublishedShards(a){return this.publishedShards=a,this}validate(){if(this.threshold<=0)throw new Error("Threshold must be greater than 0");if(this.publishedShards.length===0)throw new Error("At least one shard must be published");if(this.threshold>this.publishedShards.length)throw new Error("Threshold cannot exceed number of published shards")}build(){return this.validate(),{version:this.version,createdAt:this.createdAt,threshold:this.threshold,totalShards:this.publishedShards.length,trustees:this.publishedShards.map(a=>({pubkey:a.recipientPubkey,shardIndex:a.shardIndex})),shardEvents:this.publishedShards.map(a=>({eventId:a.eventId,recipientPubkey:a.recipientPubkey,relays:a.relays,shardIndex:a.shardIndex,publishedAt:a.publishedAt}))}}toJSON(){return JSON.stringify(this.build())}}const Wt={EVENT_KIND:1115,D_TAG:"key-backup"};function sn(c){const a=new tr(c);return a.kind=Wt.EVENT_KIND,a.created_at=Math.floor(Date.now()/1e3),a.tags=[["d",Wt.D_TAG]],a}async function ln(c,a,d){return Qe(async()=>{const p=new rr({pubkey:a});return await c.encrypt(p,d)},De.ENCRYPTION_FAILED,"Failed to encrypt metadata")}async function dn(c,a){return Qe(async()=>{await c.sign(a),await c.publish()},De.METADATA_PUBLISHING_FAILED,"Failed to publish metadata event")}async function cn(c,a,d,p){const h=c.activeUser?.pubkey;if(!h)throw new He(De.NO_USER,"No active user found");const f=new on().withThreshold(d).withPublishedShards(a).build(),g=sn(c),l=new Bt(p);return g.content=await ln(l,h,JSON.stringify(f)),await dn(g,l),g.id}var un=(c,a,d)=>a(n(d).pubkey),vn=B('<div class="flex items-center gap-3 p-3 bg-neutral-100 dark:bg-card border border rounded-lg"><div class="flex-1 min-w-0"><p class="text-sm font-medium text-foreground truncate"> </p></div> <button class="p-2 hover:bg-neutral-200 dark:hover:bg-muted rounded-lg transition-colors"><svg class="w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),pn=B('<div class="space-y-2"></div>'),hn=B('<div class="text-center py-8 text-muted-foreground text-sm border border rounded-lg"><!></div>'),fn=(c,a,d)=>a(n(d)),mn=B('<button class="w-full flex items-center gap-3 p-3 hover:bg-neutral-100 dark:hover:bg-card transition-colors border-b border last:border-b-0"><div class="flex-1 min-w-0 text-left"><p class="text-sm font-medium text-foreground truncate"> </p></div></button>'),gn=B('<div class="border border rounded-lg max-h-64 overflow-y-auto"></div>'),xn=B('<div><input type="text" placeholder="Search your follows..." class="w-full px-3 py-2 bg-card border border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"/></div> <!>',1),_n=B('<div class="space-y-4"><div><label class="block text-sm font-medium text-foreground mb-2">Select Trustees</label> <p class="text-xs text-muted-foreground mb-3">Choose trusted contacts who will receive encrypted pieces of your key</p></div> <!> <div class="flex items-center justify-between text-sm mb-2"><span class="text-muted-foreground"> </span></div> <!></div>');function bn(c,a){je(a,!0);let d=le(""),p=we(()=>Array.from(Fe.$sessions.follows)),h=we(()=>n(p).filter(A=>!a.trustees.some(L=>L.pubkey===A)));function f(A){a.trustees.length>=a.maxTrustees||a.trustees.some(L=>L.pubkey===A)||a.onTrusteesChange([...a.trustees,{pubkey:A,selected:!0}])}function g(A){a.onTrusteesChange(a.trustees.filter(L=>L.pubkey!==A))}var l=_n(),m=u(i(l),2);{var _=A=>{var L=pn();Ue(L,21,()=>a.trustees,ze,(z,D)=>{var j=vn(),X=i(j),T=i(X),H=i(T);o(T),o(X);var N=u(X,2);N.__click=[un,g,D],o(j),Z((ee,J)=>P(H,`${ee??""}...${J??""}`),[()=>n(D).pubkey.slice(0,8),()=>n(D).pubkey.slice(-4)]),w(z,j)}),o(L),w(A,L)};$(m,A=>{a.trustees.length>0&&A(_)})}var C=u(m,2),R=i(C),S=i(R);o(R),o(C);var b=u(C,2);{var E=A=>{var L=xn(),z=qe(L),D=i(z);Oe(D),o(z);var j=u(z,2);{var X=H=>{var N=hn(),ee=i(N);{var J=Q=>{var ne=Et("No follows found. Follow some people first.");w(Q,ne)},te=Q=>{var ne=Et("All follows have been selected");w(Q,ne)};$(ee,Q=>{n(p).length===0?Q(J):Q(te,!1)})}o(N),w(H,N)},T=H=>{var N=gn();Ue(N,21,()=>n(h).slice(0,10),ze,(ee,J)=>{var te=mn();te.__click=[fn,f,J];var Q=i(te),ne=i(Q),ce=i(ne);o(ne),o(Q),o(te),Z((xe,U)=>P(ce,`${xe??""}...${U??""}`),[()=>n(J).slice(0,8),()=>n(J).slice(-4)]),w(ee,te)}),o(N),w(H,N)};$(j,H=>{n(h).length===0?H(X):H(T,!1)})}tt(D,()=>n(d),H=>y(d,H)),w(A,L)};$(b,A=>{a.trustees.length<a.maxTrustees&&A(E)})}o(l),Z(()=>P(S,`Selected ${a.trustees.length??""} of ${a.maxTrustees??""}`)),w(c,l),Ve()}Ke(["click"]);var yn=(c,a)=>a(parseInt(c.currentTarget.value)),wn=B("<option> </option>"),kn=(c,a)=>a.onThresholdChange(parseInt(c.currentTarget.value)),En=B("<option> </option>"),An=B('<div class="space-y-6"><div><label class="block text-sm font-medium text-foreground mb-2">Total Key Pieces</label> <p class="text-xs text-muted-foreground mb-3">How many pieces should your key be split into?</p> <select class="w-full px-3 py-2 bg-card border border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></select></div> <div><label class="block text-sm font-medium text-foreground mb-2">Required for Recovery</label> <p class="text-xs text-muted-foreground mb-3">How many pieces are needed to recover your key?</p> <select class="w-full px-3 py-2 bg-card border border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></select></div> <div class="p-4 bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg"><div class="flex gap-3"><svg class="w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div class="flex-1 text-sm text-blue-900 dark:text-blue-200"><p class="font-medium mb-1">What This Means</p> <p class="text-xs text-blue-700 dark:text-blue-300"> </p></div></div></div></div>');function Sn(c,a){je(a,!0);let d=we(()=>Math.min(a.maxShards,$e.MAX_TOTAL_SHARDS)),p=we(()=>Math.min($e.MAX_THRESHOLD,a.totalShards)),h=we(()=>Array.from({length:n(p)-$e.MIN_THRESHOLD+1},(j,X)=>X+$e.MIN_THRESHOLD)),f=we(()=>Array.from({length:n(d)-$e.MIN_TOTAL_SHARDS+1},(j,X)=>X+$e.MIN_TOTAL_SHARDS));function g(j){a.onTotalShardsChange(j),a.threshold>j&&a.onThresholdChange(Math.min(a.threshold,j))}var l=An(),m=i(l),_=u(i(m),4);_.__change=[yn,g],Ue(_,21,()=>n(f),ze,(j,X)=>{var T=wn(),H=i(T);o(T);var N={};Z(()=>{P(H,`${n(X)??""} pieces`),N!==(N=n(X))&&(T.value=(T.__value=n(X))??"")}),w(j,T)}),o(_);var C;Mt(_),o(m);var R=u(m,2),S=u(i(R),4);S.__change=[kn,a],Ue(S,21,()=>n(h),ze,(j,X)=>{var T=En(),H=i(T);o(T);var N={};Z(()=>{P(H,`${n(X)??""} pieces`),N!==(N=n(X))&&(T.value=(T.__value=n(X))??"")}),w(j,T)}),o(S);var b;Mt(S),o(R);var E=u(R,2),A=i(E),L=u(i(A),2),z=u(i(L),2),D=i(z);o(z),o(L),o(A),o(E),o(l),Z(()=>{C!==(C=a.totalShards)&&(_.value=(_.__value=a.totalShards)??"",Rt(_,a.totalShards)),b!==(b=a.threshold)&&(S.value=(S.__value=a.threshold)??"",Rt(S,a.threshold)),P(D,`Your key will be split into ${a.totalShards??""} pieces. You'll need any ${a.threshold??""} of them to recover your key.
          Individual pieces are useless without the required number.`)}),w(c,l),Ve()}Ke(["change"]);var In=(c,a)=>a.onChange(c.currentTarget.value),Bn=(c,a)=>y(a,!n(a)),Tn=Ye('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"></path></svg>'),Cn=Ye('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>'),Mn=B('<p class="text-xs text-red-500 flex items-center gap-1"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> </p>'),Rn=B('<div class="mt-2 space-y-1"></div>'),Nn=B('<p class="mt-2 text-xs text-green-600 dark:text-green-400 flex items-center gap-1"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </p>'),Ln=B('<div><label class="block text-sm font-medium text-foreground mb-2"> </label> <div class="relative"><input/> <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-neutral-700 dark:hover:text-muted-foreground"><!></button></div> <!> <!></div>');function Jt(c,a){je(a,!0);let d=yt(a,"isValid",3,!0),p=yt(a,"touched",3,!1),h=yt(a,"errors",19,()=>[]),f=le(!1),g=we(()=>p()&&h().length>0),l=we(()=>p()&&d()&&a.value.length>0&&a.successMessage);var m=Ln(),_=i(m),C=i(_,!0);o(_);var R=u(_,2),S=i(R);Oe(S),S.__input=[In,a];var b=u(S,2);b.__click=[Bn,f];var E=i(b);{var A=T=>{var H=Tn();w(T,H)},L=T=>{var H=Cn();w(T,H)};$(E,T=>{n(f)?T(A):T(L,!1)})}o(b),o(R);var z=u(R,2);{var D=T=>{var H=Rn();Ue(H,21,h,ze,(N,ee)=>{var J=Mn(),te=u(i(J));o(J),Z(()=>P(te,` ${n(ee)??""}`)),w(N,J)}),o(H),w(T,H)};$(z,T=>{n(g)&&T(D)})}var j=u(z,2);{var X=T=>{var H=Nn(),N=u(i(H));o(H),Z(()=>P(N,` ${a.successMessage??""}`)),w(T,H)};$(j,T=>{n(l)&&T(X)})}o(m),Z(()=>{P(C,a.label),nt(S,"type",n(f)?"text":"password"),hr(S,a.value),nt(S,"placeholder",a.placeholder),Ce(S,1,`w-full px-3 py-2 pr-10 bg-card border rounded-lg text-sm focus:outline-none focus:ring-2 ${n(g)?"border-red-500 focus:ring-red-500":"border focus:ring-orange-500"}`)}),Zt("blur",S,function(...T){a.onBlur?.apply(this,T)}),w(c,m),Ve()}Ke(["input","click"]);var Fn=B('<div><div class="flex gap-3"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <div><p class="font-semibold mb-1"> </p> <p> </p></div></div></div>');function sr(c,a){let d=yt(a,"variant",3,"warning"),p=we(()=>d()==="danger"?"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-900":"bg-amber-50 dark:bg-amber-950/20 border-amber-200 dark:border-amber-900"),h=we(()=>d()==="danger"?"text-red-600 dark:text-red-400":"text-amber-600 dark:text-amber-400"),f=we(()=>d()==="danger"?"text-red-900 dark:text-red-200":"text-amber-900 dark:text-amber-200"),g=we(()=>d()==="danger"?"text-red-700 dark:text-red-300":"text-amber-700 dark:text-amber-300");var l=Fn(),m=i(l),_=i(m),C=u(_,2),R=i(C),S=i(R,!0);o(R);var b=u(R,2),E=i(b,!0);o(b),o(C),o(m),o(l),Z(()=>{Ce(l,1,`p-4 border rounded-lg ${n(p)??""}`),Ce(_,0,`w-5 h-5 flex-shrink-0 mt-0.5 ${n(h)??""}`),Ce(C,1,`flex-1 text-sm ${n(f)??""}`),P(S,a.title),Ce(b,1,`text-xs ${n(g)??""}`),P(E,a.description)}),w(c,l)}var Dn=B('<div class="space-y-4"><!> <!> <!></div>');function Un(c,a){je(a,!0);let d=le(Xe({passphrase:!1,confirm:!1})),p=we(()=>$a(a.value)),h=we(()=>a.value===a.confirmValue&&a.value.length>0);ot(()=>{a.onValidChange(n(p).valid&&n(h))});var f=Dn(),g=i(f);sr(g,{title:"Passphrase Warning",description:"Your passphrase encrypts your key shards. If you forget it, your backup cannot be recovered. Write it down and store it securely.",variant:"warning"});var l=u(g,2);Jt(l,{label:"Passphrase",get value(){return a.value},placeholder:"Enter a strong passphrase",onChange:_=>a.onChange(_),onBlur:()=>y(d,{...n(d),passphrase:!0},!0),get isValid(){return n(p).valid},get touched(){return n(d).passphrase},get errors(){return n(p).errors},successMessage:"Strong passphrase"});var m=u(l,2);{let _=we(()=>n(h)?[]:["Passphrases do not match"]);Jt(m,{label:"Confirm Passphrase",get value(){return a.confirmValue},placeholder:"Confirm your passphrase",onChange:C=>a.onConfirmChange(C),onBlur:()=>y(d,{...n(d),confirm:!0},!0),get isValid(){return n(h)},get touched(){return n(d).confirm},get errors(){return n(_)},successMessage:"Passphrases match"})}o(f),w(c,f),Ve()}async function Pn(c,a,d){if(n(a))try{await navigator.clipboard.writeText(n(a)),y(d,!0),setTimeout(()=>{y(d,!1)},2e3)}catch(p){console.error("Failed to copy:",p)}}function Hn(c,a){y(a,!n(a))}async function On(c,a,d,p,h,f,g,l,m,_,C){if(!Fe.$currentUser)throw new He(De.NO_USER,"No authenticated user found");try{y(a,"progress");const S=d(),b=n(p)+2;y(h,{status:"creating-shards",currentStep:0,totalSteps:b,message:"Starting backup creation..."},!0);const E=await Xa(S,n(f),{threshold:n(g),totalShards:n(p)});y(h,{...n(h),currentStep:2,status:"publishing",message:"Publishing shards..."},!0);const A=[],L=l(),z=n(m).slice(0,n(p));for(let D=0;D<E.length;D++){const j=E[D],X=z[D];y(h,{...n(h),currentStep:2+D,message:`Publishing shard ${D+1} of ${n(p)}...`},!0);const T=D===0?0:D*_;if(T>C)nn(j,X.pubkey,L);else{const H=await an(Fe,{shard:j,recipientPubkey:X.pubkey,createdAtOffset:T,relays:L});A.push(H)}}y(h,{...n(h),currentStep:n(p)+1,message:"Publishing metadata..."},!0),await cn(Fe,A,n(g),S),y(h,{...n(h),status:"complete",currentStep:b,message:"Backup created successfully!"},!0)}catch(S){console.error("Backup creation failed:",S);const b=S instanceof He?S:new He(De.UNKNOWN_ERROR,S instanceof Error?S.message:"Unknown error",S);y(h,{...n(h),status:"error",message:b.getUserMessage(),error:b.message},!0)}}function jn(c,a,d){y(a,"setup"),y(d,{status:"idle",currentStep:0,totalSteps:0,message:""},!0)}var Vn=(c,a)=>y(a,"view"),$n=(c,a)=>y(a,"backup"),zn=B('<code class="text-xs text-foreground break-all font-mono"> </code>'),Kn=B('<div class="text-xs text-muted-foreground font-mono"></div>'),Yn=Ye('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"></path></svg> Hide Key',1),Gn=Ye('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg> Show Key',1),qn=Ye('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Copied!',1),Xn=Ye('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> Copy Key',1),Wn=B('<div class="space-y-6"><div class="bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-900 rounded-lg p-4"><div class="flex items-start gap-3"><svg class="w-5 h-5 text-red-600 dark:text-red-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <div class="flex-1"><h3 class="text-sm font-semibold text-red-900 dark:text-red-100 mb-1">Critical Security Warning</h3> <p class="text-xs text-red-800 dark:text-red-200">Your private key (nsec) is the only way to access your account. Anyone with access to this key has full control of your identity. Never share it with anyone and store it securely offline.</p></div></div></div> <div class="space-y-4"><div><h3 class="text-sm font-medium text-foreground mb-1">Your Private Key (nsec)</h3> <p class="text-xs text-muted-foreground">You are logged in with a private key signer. Save this key somewhere safe.</p></div> <div class="space-y-3"><div class="relative"><div class="bg-neutral-100 dark:bg-card border border rounded-lg p-4"><!></div></div> <div class="flex gap-2"><button class="flex-1 px-4 py-2 bg-neutral-200 dark:bg-muted text-muted-foreground rounded-lg hover:bg-neutral-300 dark:hover:bg-muted transition-colors text-sm font-medium flex items-center justify-center gap-2"><!></button> <button class="flex-1 px-4 py-2 bg-primary text-foreground rounded-lg hover:bg-primary-700 transition-colors text-sm font-medium flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div> <p class="text-xs text-muted-foreground text-center">Make sure nobody is watching your screen before revealing your key</p></div></div> <div class="bg-neutral-50 dark:bg-card border border rounded-lg p-4"><h4 class="text-sm font-medium text-foreground mb-2">Security Best Practices</h4> <ul class="space-y-2 text-xs text-muted-foreground"><li class="flex items-start gap-2"><svg class="w-4 h-4 text-primary mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Write down your nsec on paper and store it in a safe place</span></li> <li class="flex items-start gap-2"><svg class="w-4 h-4 text-primary mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Never share your nsec via email, messaging apps, or websites</span></li> <li class="flex items-start gap-2"><svg class="w-4 h-4 text-primary mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Consider using a browser extension signer for better security</span></li> <li class="flex items-start gap-2"><svg class="w-4 h-4 text-primary mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Use the "Create Backup" tab to create encrypted shards with trusted contacts</span></li></ul></div></div>'),Jn=B('<div class="w-16 h-16 bg-green-100 dark:bg-green-950/30 rounded-full flex items-center justify-center mb-4"><svg class="w-8 h-8 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>'),Zn=B('<div class="w-16 h-16 bg-red-100 dark:bg-red-950/30 rounded-full flex items-center justify-center mb-4"><svg class="w-8 h-8 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div>'),Qn=B('<div class="w-16 h-16 bg-blue-100 dark:bg-blue-950/30 rounded-full flex items-center justify-center mb-4 animate-spin"><svg class="w-8 h-8 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></div>'),eo=B('<p class="text-sm text-muted-foreground"> </p>'),to=B('<p class="text-sm text-red-600 dark:text-red-400 mt-2 text-center max-w-md"> </p>'),ro=B('<button class="mt-6 px-4 py-2 bg-neutral-200 dark:bg-muted text-muted-foreground rounded-lg hover:bg-neutral-300 dark:hover:bg-muted transition-colors">Close</button>'),ao=B('<div class="flex flex-col items-center justify-center py-12"><!> <h3 class="text-lg font-semibold text-foreground mb-2"> </h3> <!> <!> <!></div>'),no=B('<button class="w-full px-4 py-3 bg-primary text-foreground rounded-lg hover:bg-primary-700 transition-colors font-medium flex items-center justify-center gap-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg> Create Backup</button>'),oo=B("<!> <!> <!> <!> <!>",1),so=B('<div class="space-y-6"><!></div>'),io=B('<div class="space-y-6"><div class="flex gap-2 p-1 bg-neutral-100 dark:bg-card rounded-lg"><button>View Key</button> <button>Create Backup</button></div> <!></div>'),lo=B('<div class="text-center py-8"><div class="w-16 h-16 bg-neutral-100 dark:bg-card rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div> <h3 class="text-sm font-medium text-foreground mb-2">Not Using Private Key Signer</h3> <p class="text-xs text-muted-foreground max-w-sm mx-auto">You are not logged in with a private key signer. This section is only available for users who logged in with an nsec.</p></div>');function co(c,a){je(a,!0);const d=2,p=3,h=5;let f=le("view"),g=le(!1),l=le(!1),m=le("setup"),_=le(2),C=le(3),R=le(Xe([])),S=le(""),b=le(""),E=le(!1),A=le(Xe({status:"idle",currentStep:0,totalSteps:0,message:""}));const L=we(()=>Fe.signer instanceof Bt),z=we(()=>!n(L)||!Fe.signer?null:Fe.signer.nsec);let D=we(()=>n(R).length>=n(C)&&n(E));function j(){return Array.from(Fe.pool?.relays.values()||[]).map(J=>J.url).slice(0,h)}function X(){if(!n(L)||!Fe.signer)throw new He(De.NO_PRIVATE_KEY,"No private key signer available");const te=Fe.signer.privateKey;if(!te)throw new He(De.NO_PRIVATE_KEY,"Private key not found in signer");return te}var T=et(),H=qe(T);{var N=J=>{var te=io(),Q=i(te),ne=i(Q);ne.__click=[Vn,f];var ce=u(ne,2);ce.__click=[$n,f],o(Q);var xe=u(Q,2);{var U=I=>{var M=Wn(),ae=u(i(M),2),Y=u(i(ae),2),G=i(Y),q=i(G),se=i(q);{var re=W=>{var de=zn(),Se=i(de,!0);o(de),Z(()=>P(Se,n(z))),w(W,de)},he=W=>{var de=Kn();de.textContent="‚Ä¢".repeat(63),w(W,de)};$(se,W=>{n(g)?W(re):W(he,!1)})}o(q),o(G);var O=u(G,2),K=i(O);K.__click=[Hn,g];var oe=i(K);{var ie=W=>{var de=Yn();Ie(),w(W,de)},be=W=>{var de=Gn();Ie(),w(W,de)};$(oe,W=>{n(g)?W(ie):W(be,!1)})}o(K);var ue=u(K,2);ue.__click=[Pn,z,l];var pe=i(ue);{var fe=W=>{var de=qn();Ie(),w(W,de)},me=W=>{var de=Xn();Ie(),w(W,de)};$(pe,W=>{n(l)?W(fe):W(me,!1)})}o(ue),o(O),Ie(2),o(Y),o(ae),Ie(2),o(M),Z(()=>ue.disabled=!n(g)),w(I,M)},V=I=>{var M=so(),ae=i(M);{var Y=q=>{var se=ao(),re=i(se);{var he=W=>{var de=Jn();w(W,de)},O=W=>{var de=et(),Se=qe(de);{var Le=Te=>{var Me=Zn();w(Te,Me)},Pe=Te=>{var Me=Qn();w(Te,Me)};$(Se,Te=>{n(A).status==="error"?Te(Le):Te(Pe,!1)},!0)}w(W,de)};$(re,W=>{n(A).status==="complete"?W(he):W(O,!1)})}var K=u(re,2),oe=i(K,!0);o(K);var ie=u(K,2);{var be=W=>{var de=eo(),Se=i(de);o(de),Z(()=>P(Se,`Step ${n(A).currentStep??""} of ${n(A).totalSteps??""}`)),w(W,de)};$(ie,W=>{n(A).status!=="complete"&&n(A).status!=="error"&&W(be)})}var ue=u(ie,2);{var pe=W=>{var de=to(),Se=i(de,!0);o(de),Z(()=>P(Se,n(A).error)),w(W,de)};$(ue,W=>{n(A).status==="error"&&n(A).error&&W(pe)})}var fe=u(ue,2);{var me=W=>{var de=ro();de.__click=[jn,m,A],w(W,de)};$(fe,W=>{(n(A).status==="complete"||n(A).status==="error")&&W(me)})}o(se),Z(()=>P(oe,n(A).message)),w(q,se)},G=q=>{var se=oo(),re=qe(se);sr(re,{title:"Security Warning",description:"Key backup splits your private key into encrypted pieces. Choose trustworthy contacts and a strong passphrase you won't forget.",variant:"danger"});var he=u(re,2);Sn(he,{get threshold(){return n(_)},get totalShards(){return n(C)},onThresholdChange:ue=>y(_,ue,!0),onTotalShardsChange:ue=>y(C,ue,!0),maxShards:10});var O=u(he,2);bn(O,{get trustees(){return n(R)},get maxTrustees(){return n(C)},onTrusteesChange:ue=>y(R,ue,!0)});var K=u(O,2);{var oe=ue=>{Un(ue,{get value(){return n(S)},get confirmValue(){return n(b)},onChange:pe=>y(S,pe,!0),onConfirmChange:pe=>y(b,pe,!0),onValidChange:pe=>y(E,pe,!0)})};$(K,ue=>{n(R).length>=n(C)&&ue(oe)})}var ie=u(K,2);{var be=ue=>{var pe=no();pe.__click=[On,m,X,C,A,S,_,j,R,p,d],w(ue,pe)};$(ie,ue=>{n(D)&&ue(be)})}w(q,se)};$(ae,q=>{n(m)==="progress"?q(Y):q(G,!1)})}o(M),w(I,M)};$(xe,I=>{n(f)==="view"?I(U):I(V,!1)})}o(te),Z(()=>{Ce(ne,1,`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors ${n(f)==="view"?"bg-white dark:bg-muted text-foreground shadow-sm":"text-muted-foreground hover:text-neutral-900 dark:hover:text-foreground"}`),Ce(ce,1,`flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors ${n(f)==="backup"?"bg-white dark:bg-muted text-foreground shadow-sm":"text-muted-foreground hover:text-neutral-900 dark:hover:text-foreground"}`)}),w(J,te)},ee=J=>{var te=lo();w(J,te)};$(H,J=>{n(L)&&n(z)?J(N):J(ee,!1)})}w(c,T),Ve()}Ke(["click"]);var uo=B('<div class="flex flex-col items-center justify-center py-12 gap-3"><div class="w-10 h-10 border-4 border border-t-orange-500 rounded-full animate-spin"></div> <p class="text-sm text-muted-foreground">Loading cache statistics...</p></div>'),vo=B('<div class="flex flex-col items-center justify-center py-12 gap-3"><p class="text-sm text-red-500"> </p> <button class="px-4 py-2 bg-primary/10 border border-primary/30 rounded-lg text-sm text-primary hover:bg-primary/20 transition-all">Retry</button></div>'),po=B('<div class="bg-neutral-100 dark:bg-card border border rounded-lg p-3 flex items-center justify-between"><div class="flex items-center gap-3"><span class="font-mono text-sm text-primary font-semibold min-w-[3rem]"> </span> <span class="text-sm text-muted-foreground"> </span></div> <div class="text-sm font-semibold text-foreground"> </div></div>'),ho=B('<div class="space-y-6"><div><h3 class="text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3">Cache Overview</h3> <div class="grid grid-cols-2 gap-3"><div class="bg-neutral-100 dark:bg-card border border rounded-xl p-4 text-center"><div class="text-2xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground font-medium">Total Events</div></div> <div class="bg-neutral-100 dark:bg-card border border rounded-xl p-4 text-center"><div class="text-2xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground font-medium">Profiles</div></div> <div class="bg-neutral-100 dark:bg-card border border rounded-xl p-4 text-center"><div class="text-2xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground font-medium">Event Tags</div></div> <div class="bg-neutral-100 dark:bg-card border border rounded-xl p-4 text-center"><div class="text-2xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground font-medium">Event-Relay Links</div></div></div></div> <div><h3 class="text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3">Events by Kind</h3> <div class="space-y-2"></div></div> <div><h3 class="text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3">Other Cache Tables</h3> <div class="grid grid-cols-3 gap-3"><div class="bg-neutral-100 dark:bg-card border border rounded-xl p-4 text-center"><div class="text-2xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground font-medium">Decrypted Events</div></div> <div class="bg-neutral-100 dark:bg-card border border rounded-xl p-4 text-center"><div class="text-2xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground font-medium">Unpublished Events</div></div> <div class="bg-neutral-100 dark:bg-card border border rounded-xl p-4 text-center"><div class="text-2xl font-bold text-primary mb-1"> </div> <div class="text-xs text-muted-foreground font-medium">Cache Data</div></div></div></div></div>'),fo=B('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-lg font-semibold text-foreground">Cache Statistics</h2> <p class="text-sm text-muted-foreground mt-1">Local database cache information</p></div> <button class="p-2 hover:bg-neutral-200/50 dark:hover:bg-muted/30 rounded-lg transition-all" title="Refresh"><svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div> <!></div>');function mo(c,a){je(a,!0);let d=le(null),p=le(!0),h=le(null);async function f(){y(p,!0),y(h,null);try{const b=Fe.cacheAdapter;if(!b)throw new Error("Cache adapter not found");if(!b.getCacheStats)throw new Error("getCacheStats method not available");y(d,await b.getCacheStats(),!0)}catch(b){y(h,b instanceof Error?b.message:"Unknown error occurred",!0),console.error("Failed to load cache stats:",b)}finally{y(p,!1)}}ot(()=>{f()});function g(b){return{0:"Profile Metadata",1:"Short Text Note",3:"Contacts",4:"Encrypted DM",5:"Event Deletion",6:"Repost",7:"Reaction",9735:"Zap",9321:"NIP-61 Nutzap",1e4:"Mute List",10002:"Relay List",3e4:"People List",30008:"Profile Badges",30009:"Badge Definition",37375:"NIP-60 Wallet",7375:"Cashu Token"}[b]||`Kind ${b}`}var l=fo(),m=i(l),_=u(i(m),2);_.__click=f,o(m);var C=u(m,2);{var R=b=>{var E=uo();w(b,E)},S=b=>{var E=et(),A=qe(E);{var L=D=>{var j=vo(),X=i(j),T=i(X);o(X);var H=u(X,2);H.__click=f,o(j),Z(()=>P(T,`‚ùå ${n(h)??""}`)),w(D,j)},z=D=>{var j=et(),X=qe(j);{var T=H=>{var N=ho(),ee=i(N),J=u(i(ee),2),te=i(J),Q=i(te),ne=i(Q,!0);o(Q),Ie(2),o(te);var ce=u(te,2),xe=i(ce),U=i(xe,!0);o(xe),Ie(2),o(ce);var V=u(ce,2),I=i(V),M=i(I,!0);o(I),Ie(2),o(V);var ae=u(V,2),Y=i(ae),G=i(Y,!0);o(Y),Ie(2),o(ae),o(J),o(ee);var q=u(ee,2),se=u(i(q),2);Ue(se,21,()=>Object.entries(n(d).eventsByKind).sort((W,de)=>de[1]-W[1]),ze,(W,de)=>{var Se=we(()=>cr(n(de),2));let Le=()=>n(Se)[0],Pe=()=>n(Se)[1];var Te=po(),Me=i(Te),Ne=i(Me),ge=i(Ne,!0);o(Ne);var ye=u(Ne,2),Re=i(ye,!0);o(ye),o(Me);var F=u(Me,2),r=i(F,!0);o(F),o(Te),Z((e,t)=>{P(ge,Le()),P(Re,e),P(r,t)},[()=>g(Number(Le())),()=>Pe().toLocaleString()]),w(W,Te)}),o(se),o(q);var re=u(q,2),he=u(i(re),2),O=i(he),K=i(O),oe=i(K,!0);o(K),Ie(2),o(O);var ie=u(O,2),be=i(ie),ue=i(be,!0);o(be),Ie(2),o(ie);var pe=u(ie,2),fe=i(pe),me=i(fe,!0);o(fe),Ie(2),o(pe),o(he),o(re),o(N),Z((W,de,Se,Le,Pe,Te,Me)=>{P(ne,W),P(U,de),P(M,Se),P(G,Le),P(oe,Pe),P(ue,Te),P(me,Me)},[()=>n(d).totalEvents.toLocaleString(),()=>n(d).totalProfiles.toLocaleString(),()=>n(d).totalEventTags.toLocaleString(),()=>n(d).eventRelays.toLocaleString(),()=>n(d).totalDecryptedEvents.toLocaleString(),()=>n(d).totalUnpublishedEvents.toLocaleString(),()=>n(d).cacheData.toLocaleString()]),w(H,N)};$(X,H=>{n(d)&&H(T)},!0)}w(D,j)};$(A,D=>{n(h)?D(L):D(z,!1)},!0)}w(b,E)};$(C,b=>{n(p)?b(R):b(S,!1)})}o(l),w(c,l),Ve()}Ke(["click"]);function go(c,a,d,p){c.key==="Enter"?a():c.key==="Escape"&&(y(d,""),y(p,!1))}var xo=(c,a)=>Ae.updateZap({defaultAmount:n(a)}),_o=B('<button type="button"><div class="flex flex-col items-center gap-2"><span class="text-xl">‚ö°</span> <span class="text-sm font-bold"> </span></div></button>'),bo=(c,a,d)=>{y(a,""),y(d,!1)},yo=B('<div class="flex gap-2"><input type="number" placeholder="Enter custom amount..." class="flex-1 px-4 py-3 bg-neutral-100 dark:bg-muted border-2 border-primary dark:border-primary rounded-xl text-foreground placeholder-neutral-500 dark:placeholder-neutral-400 focus:outline-none font-semibold"/> <button class="px-6 py-3 bg-gradient-to-br from-primary-600 to-primary-700 hover:opacity-90 text-foreground font-semibold rounded-xl transition-all" type="button">Set</button> <button class="px-6 py-3 bg-neutral-100 dark:bg-muted hover:bg-neutral-200 dark:hover:bg-muted text-foreground font-semibold rounded-xl transition-all" type="button">Cancel</button></div>'),wo=(c,a)=>y(a,!0),ko=B('<button class="w-full px-4 py-3 bg-neutral-100 dark:bg-muted hover:bg-neutral-200 dark:hover:bg-muted border-2 border-dashed border dark:border rounded-xl text-muted-foreground font-semibold transition-all flex items-center justify-center gap-2" type="button"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> Custom Amount</button>'),Eo=B('<div class="space-y-6"><div><h3 class="text-lg font-semibold text-foreground mb-4">Default Zap Amount</h3> <p class="text-sm text-muted-foreground mb-4">Choose the default amount for quick zaps. Long-press the zap button to choose a custom amount.</p> <div class="grid grid-cols-4 gap-3"></div> <div class="mt-4"><!></div></div> <div class="p-4 bg-neutral-100 dark:bg-card border border rounded-xl"><div class="flex items-start gap-3"><div class="mt-0.5"><svg class="w-5 h-5 text-primary dark:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div> <div class="flex-1"><h4 class="text-sm font-semibold text-foreground mb-1">How to Zap</h4> <ul class="text-sm text-muted-foreground space-y-1"><li><strong>Tap:</strong> </li> <li><strong>Long-press:</strong> Choose custom amount from modal</li></ul></div></div></div> <div class="p-4 bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-800/30 rounded-xl"><div class="flex items-center gap-2 mb-2"><span class="text-2xl">‚ö°</span> <h4 class="text-sm font-semibold text-primary-900 dark:text-primary-100">Current Default</h4></div> <p class="text-3xl font-bold bg-gradient-to-r from-primary-600 to-primary-700 bg-clip-text text-transparent"> </p></div></div>');function Ao(c,a){je(a,!0);const d=[10,21,50,100,500,1e3,2100,5e3];let p=le(""),h=le(!1);function f(N){return N>=1e3?`${(N/1e3).toFixed(N%1e3===0?0:1)}K`:N.toString()}function g(){const N=Number.parseInt(n(p));!Number.isNaN(N)&&N>0&&(Ae.updateZap({defaultAmount:N}),y(p,""),y(h,!1))}var l=Eo(),m=i(l),_=u(i(m),4);Ue(_,21,()=>d,ze,(N,ee)=>{var J=_o();J.__click=[xo,ee];var te=i(J),Q=u(i(te),2),ne=i(Q,!0);o(Q),o(te),o(J),Z(ce=>{Ce(J,1,`relative overflow-hidden rounded-xl p-4 transition-all duration-200 ${Ae.zap.defaultAmount===n(ee)?"bg-gradient-to-br from-primary-600 to-primary-700 dark:bg-primary text-foreground shadow-lg shadow-primary/30 dark:shadow-primary/50 scale-105":"bg-neutral-100 dark:bg-muted hover:bg-neutral-200 dark:hover:bg-muted text-foreground hover:scale-105"}`),P(ne,ce)},[()=>f(n(ee))]),w(N,J)}),o(_);var C=u(_,2),R=i(C);{var S=N=>{var ee=yo(),J=i(ee);Oe(J),J.__keydown=[go,g,p,h],It(J,!0);var te=u(J,2);te.__click=g;var Q=u(te,2);Q.__click=[bo,p,h],o(ee),tt(J,()=>n(p),ne=>y(p,ne)),w(N,ee)},b=N=>{var ee=ko();ee.__click=[wo,h],w(N,ee)};$(R,N=>{n(h)?N(S):N(b,!1)})}o(C),o(m);var E=u(m,2),A=i(E),L=u(i(A),2),z=u(i(L),2),D=i(z),j=u(i(D));o(D),Ie(2),o(z),o(L),o(A),o(E);var X=u(E,2),T=u(i(X),2),H=i(T);o(T),o(X),o(l),Z(N=>{P(j,` Send default zap amount (${Ae.zap.defaultAmount??""} sats)`),P(H,`${N??""} sats`)},[()=>Ae.zap.defaultAmount.toLocaleString()]),w(c,l),Ve()}Ke(["click","keydown"]);function So(c,a,d,p,h,f){const g=n(a).trim();try{const m=new URL(g);if(m.protocol!=="https:"&&m.protocol!=="http:"){y(d,"Please use https:// or http:// URL");return}}catch{y(d,"Please enter a valid mint URL");return}if(n(p).has(g)){y(d,"This mint has already been selected");return}if(n(h).some(m=>m.url===g)){y(d,"This mint is already in the list below");return}const l=new Set(n(p));l.add(g),y(p,l,!0),y(a,""),y(f,!1),y(d,"")}function Io(c,a,d,p){y(a,!n(a)),y(d,""),y(p,"")}function Bo(c,a,d){n(a).size!==0&&d.onSelectMints(Array.from(n(a)))}var To=c=>c.stopPropagation(),Co=B('<div class="error-message svelte-114pr8e"> </div>'),Mo=B('<div class="manual-input-form svelte-114pr8e"><input type="url" placeholder="https://mint.example.com" class="mint-url-input svelte-114pr8e"/> <button class="add-button svelte-114pr8e">Add</button></div> <!>',1),Ro=(c,a,d)=>a(n(d).url),No=B('<div class="checkmark svelte-114pr8e">‚úì</div>'),Lo=B('<img class="svelte-114pr8e"/>'),Fo=B('<div class="icon-placeholder svelte-114pr8e">üè¶</div>'),Do=B('<div class="mint-description svelte-114pr8e"> </div>'),Uo=B('<div class="mint-recommendations svelte-114pr8e"> </div>'),Po=B("<div> </div>"),Ho=B('<button><div class="checkbox-container svelte-114pr8e"><div><!></div></div> <div class="mint-icon svelte-114pr8e"><!></div> <div class="mint-info svelte-114pr8e"><div class="mint-name svelte-114pr8e"> </div> <!> <div class="mint-url svelte-114pr8e"> </div> <!> <!></div></button>'),Oo=B('<div class="mint-list svelte-114pr8e"></div>'),jo=B('<div class="empty-state svelte-114pr8e"><div class="empty-icon svelte-114pr8e">üîç</div> <p class="svelte-114pr8e">Discovering mints from the network...</p> <p class="empty-hint svelte-114pr8e">Add custom mints above or wait for discovery</p></div>'),Vo=(c,a,d)=>a(n(d)),$o=B('<div class="mint-item custom selected svelte-114pr8e"><div class="mint-icon svelte-114pr8e"><div class="icon-placeholder svelte-114pr8e">üè¶</div></div> <div class="mint-info svelte-114pr8e"><div class="mint-name svelte-114pr8e"> </div> <div class="mint-url svelte-114pr8e"> </div></div> <button class="remove-button svelte-114pr8e">‚úï</button></div>'),zo=B('<div class="custom-mints-section svelte-114pr8e"><h4 class="svelte-114pr8e">Custom Mints</h4> <div class="mint-list svelte-114pr8e"></div></div>'),Ko=B('<div class="selection-count svelte-114pr8e"><span class="count-icon svelte-114pr8e">‚úì</span> </div>'),Yo=B('<div class="modal-backdrop svelte-114pr8e"><div class="modal-content svelte-114pr8e"><div class="modal-header svelte-114pr8e"><h2 class="svelte-114pr8e">Browse Mints</h2> <button class="close-button svelte-114pr8e">‚úï</button></div> <div class="modal-body svelte-114pr8e"><div class="info-card svelte-114pr8e"><div class="info-icon svelte-114pr8e">‚ÑπÔ∏è</div> <div class="info-text svelte-114pr8e">Mints are custodial services that issue ecash tokens. Select multiple mints to spread risk.</div></div> <div class="manual-mint-section svelte-114pr8e"><button class="toggle-button svelte-114pr8e"><span class="svelte-114pr8e"> </span> Add Custom Mint</button> <!></div> <!> <!></div> <div class="modal-footer svelte-114pr8e"><!> <div class="action-buttons svelte-114pr8e"><button class="button secondary svelte-114pr8e">Cancel</button> <button class="button primary svelte-114pr8e">Add Selected Mints</button></div></div></div></div>');function Go(c,a){je(a,!0);const d=mr(Fe,{network:"mainnet",timeout:0});let p=le(Xe([])),h=le(Xe(new Set)),f=le(!1),g=le(""),l=le("");ot(()=>{const I=d.subscribe(M=>{y(p,M.mints,!0)});return()=>{I(),d.getState().stop()}});function m(I){try{return new URL(I).hostname}catch{return I}}function _(I){const M=new Set(n(h));M.has(I)?M.delete(I):M.add(I),y(h,M,!0)}const C=we(()=>Array.from(n(h)).filter(I=>!n(p).some(M=>M.url===I)));var R=Yo();R.__click=function(...I){a.onClose?.apply(this,I)};var S=i(R);S.__click=[To];var b=i(S),E=u(i(b),2);E.__click=function(...I){a.onClose?.apply(this,I)},o(b);var A=u(b,2),L=u(i(A),2),z=i(L);z.__click=[Io,f,g,l];var D=i(z),j=i(D,!0);o(D),Ie(),o(z);var X=u(z,2);{var T=I=>{var M=Mo(),ae=qe(M),Y=i(ae);Oe(Y);var G=u(Y,2);G.__click=[So,g,l,h,p,f],o(ae);var q=u(ae,2);{var se=re=>{var he=Co(),O=i(he,!0);o(he),Z(()=>P(O,n(l))),w(re,he)};$(q,re=>{n(l)&&re(se)})}Z(re=>G.disabled=re,[()=>!n(g).trim()]),tt(Y,()=>n(g),re=>y(g,re)),w(I,M)};$(X,I=>{n(f)&&I(T)})}o(L);var H=u(L,2);{var N=I=>{var M=Oo();Ue(M,21,()=>n(p),ze,(ae,Y)=>{var G=Ho();let q;G.__click=[Ro,_,Y];var se=i(G),re=i(se);let he;var O=i(re);{var K=ge=>{var ye=No();w(ge,ye)};$(O,ge=>{n(h).has(n(Y).url)&&ge(K)})}o(re),o(se);var oe=u(se,2),ie=i(oe);{var be=ge=>{var ye=Lo();Z(()=>{nt(ye,"src",n(Y).icon),nt(ye,"alt",n(Y).name||n(Y).url)}),w(ge,ye)},ue=ge=>{var ye=Fo();w(ge,ye)};$(ie,ge=>{n(Y).icon?ge(be):ge(ue,!1)})}o(oe);var pe=u(oe,2),fe=i(pe),me=i(fe,!0);o(fe);var W=u(fe,2);{var de=ge=>{var ye=Do(),Re=i(ye,!0);o(ye),Z(()=>P(Re,n(Y).description)),w(ge,ye)};$(W,ge=>{n(Y).description&&ge(de)})}var Se=u(W,2),Le=i(Se,!0);o(Se);var Pe=u(Se,2);{var Te=ge=>{var ye=Uo(),Re=i(ye);o(ye),Z(()=>P(Re,`‚≠ê Recommended by ${n(Y).recommendations.length??""} user${n(Y).recommendations.length===1?"":"s"}`)),w(ge,ye)};$(Pe,ge=>{n(Y).recommendations.length>0&&ge(Te)})}var Me=u(Pe,2);{var Ne=ge=>{var ye=Po();let Re;var F=i(ye,!0);o(ye),Z(r=>{Re=Ce(ye,1,"mint-status svelte-114pr8e",null,Re,r),P(F,n(Y).isOnline?"üü¢ Online":"üî¥ Offline")},[()=>({online:n(Y).isOnline})]),w(ge,ye)};$(Me,ge=>{n(Y).isOnline!==void 0&&ge(Ne)})}o(pe),o(G),Z((ge,ye,Re)=>{q=Ce(G,1,"mint-item svelte-114pr8e",null,q,ge),he=Ce(re,1,"checkbox svelte-114pr8e",null,he,ye),P(me,Re),P(Le,n(Y).url)},[()=>({selected:n(h).has(n(Y).url)}),()=>({checked:n(h).has(n(Y).url)}),()=>n(Y).name||m(n(Y).url)]),w(ae,G)}),o(M),w(I,M)},ee=I=>{var M=jo();w(I,M)};$(H,I=>{n(p).length>0?I(N):I(ee,!1)})}var J=u(H,2);{var te=I=>{var M=zo(),ae=u(i(M),2);Ue(ae,21,()=>n(C),ze,(Y,G)=>{var q=$o(),se=u(i(q),2),re=i(se),he=i(re,!0);o(re);var O=u(re,2),K=i(O,!0);o(O),o(se);var oe=u(se,2);oe.__click=[Vo,_,G],o(q),Z(ie=>{P(he,ie),P(K,n(G))},[()=>m(n(G))]),w(Y,q)}),o(ae),o(M),w(I,M)};$(J,I=>{n(C).length>0&&I(te)})}o(A);var Q=u(A,2),ne=i(Q);{var ce=I=>{var M=Ko(),ae=u(i(M));o(M),Z(()=>P(ae,` ${n(h).size??""} mint${n(h).size===1?"":"s"} selected`)),w(I,M)};$(ne,I=>{n(h).size>0&&I(ce)})}var xe=u(ne,2),U=i(xe);U.__click=function(...I){a.onClose?.apply(this,I)};var V=u(U,2);V.__click=[Bo,h,a],o(xe),o(Q),o(S),o(R),Z(()=>{P(j,n(f)?"‚àí":"+"),V.disabled=n(h).size===0}),w(c,R),Ve()}Ke(["click"]);async function qo(c,a,d,p,h,f,g,l,m){a(),y(d,!0);try{await n(p).save({mints:n(h),relays:n(f).length>0?n(f):void 0}),y(g,!1),l("Changes saved successfully!")}catch(_){m(_)}finally{y(d,!1)}}function Xo(){St.setEnabled(!St.enabled)}var Wo=Ye('<svg class="w-4 h-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> Saving...',1),Jo=Ye('<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Save',1),Zo=B('<button class="px-6 py-2 bg-primary text-foreground rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center gap-2 flex-shrink-0"><!></button>'),Qo=B('<div class="bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg p-4"><div class="flex gap-3"><svg class="w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-sm text-green-800 dark:text-green-300"> </p></div></div>'),es=B('<div class="bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 rounded-lg p-4"><div class="flex gap-3"><svg class="w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-sm text-red-800 dark:text-red-300"> </p></div></div>'),ts=B('<div class="mt-2 text-sm"><span class="text-primary dark:text-primary font-semibold"> </span></div>'),rs=(c,a,d)=>a(d),as=B('<div class="border rounded-lg p-4 bg-card border"><div class="flex items-center justify-between"><div class="flex-1 min-w-0"><div class="flex items-center gap-2"><svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div></div> <!></div> <button class="ml-3 p-2 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-lg transition-colors group" title="Remove mint"><svg class="w-5 h-5 text-muted-foreground group-hover:text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div>'),ns=B('<div class="text-center py-8 text-muted-foreground"><svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg> <p class="text-sm">No mints configured</p></div>'),os=(c,a)=>y(a,!0),ss=(c,a,d)=>a(d),is=B('<div class="border rounded-lg p-4 bg-card border"><div class="flex items-center justify-between"><div class="flex-1 min-w-0"><div class="flex items-center gap-2"><svg class="w-5 h-5 text-blue-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div></div></div> <button class="ml-3 p-2 hover:bg-red-50 dark:hover:bg-red-950/30 rounded-lg transition-colors group" title="Remove relay"><svg class="w-5 h-5 text-muted-foreground group-hover:text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div>'),ls=B('<div class="text-center py-8 text-muted-foreground"><svg class="w-12 h-12 mx-auto mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg> <p class="text-sm">No relays configured</p></div>'),ds=(c,a,d,p)=>{y(a,!1),y(d,""),y(p,null)},cs=B('<div class="border-2 border-dashed border-blue-300 dark:border-blue-700 rounded-lg p-4"><div class="space-y-3"><input type="text" placeholder="wss://relay.example.com" class="w-full px-3 py-2 bg-card border border dark:border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-foreground"/> <div class="text-xs text-muted-foreground">URL will automatically be prefixed with wss:// if not provided</div> <div class="flex gap-2"><button class="px-4 py-2 bg-blue-600 text-foreground rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">Add Relay</button> <button class="px-4 py-2 bg-neutral-200 dark:bg-muted text-muted-foreground rounded-lg hover:bg-neutral-300 dark:hover:bg-muted transition-colors">Cancel</button></div></div></div>'),us=(c,a)=>y(a,!0),vs=B('<button class="w-full border-2 border-dashed border rounded-lg p-4 hover:border-blue-500 dark:hover:border-blue-600 transition-colors group"><div class="flex items-center justify-center gap-2 text-muted-foreground group-hover:text-blue-600 dark:group-hover:text-blue-500"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> <span class="font-medium">Add Relay</span></div></button>'),ps=B(`<div class="space-y-6"><div class="flex items-start justify-between gap-4"><div><h2 class="text-xl font-semibold text-foreground mb-2">Wallet Configuration</h2> <p class="text-sm text-muted-foreground">Manage your Cashu mints, wallet relays, and Lightning integration.</p></div> <!></div> <!> <!> <div class="space-y-3"><div class="flex items-center justify-between"><h3 class="text-lg font-semibold text-foreground">Cashu Mints</h3> <span class="text-sm text-muted-foreground"> </span></div> <div class="space-y-2"><!> <!> <button class="w-full border-2 border-dashed border rounded-lg p-4 hover:border-primary dark:hover:border-primary transition-colors group"><div class="flex items-center justify-center gap-2 text-muted-foreground group-hover:text-primary dark:group-hover:text-primary"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg> <span class="font-medium">Add Mint</span></div></button></div></div> <div class="space-y-3"><div class="flex items-center justify-between"><h3 class="text-lg font-semibold text-foreground">Wallet Relays</h3> <span class="text-sm text-muted-foreground"> </span></div> <div class="space-y-2"><!> <!> <!></div></div> <div class="border rounded-lg p-4 bg-card"><div class="flex items-center justify-between gap-4"><div class="flex items-center gap-2"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> <div><h3 class="text-lg font-semibold text-foreground">npub.cash Lightning Zaps</h3> <p class="text-sm text-muted-foreground">Automatically redeem Lightning zaps received via npub.cash into your wallet.</p></div></div> <label class="relative inline-flex items-center cursor-pointer flex-shrink-0"><input type="checkbox" class="sr-only peer"/> <div class="w-11 h-6 bg-neutral-300 dark:bg-neutral-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"></div></label></div></div></div> <!>`,1);function hs(c,a){je(a,!0);let d=le(!1),p=le(!1),h=le(""),f=le(null),g=le(null),l=le(!1);const m=we(()=>Fe.$wallet);let _=le(Xe([])),C=le(Xe([])),R=le(!1);ot(()=>{!n(R)&&n(m)&&(y(_,n(m).mints.map(F=>typeof F=="string"?F:F.url),!0),y(C,n(m).relays,!0))});const S=we(()=>n(R)?n(_):n(m)?.mints.map(F=>typeof F=="string"?F:F.url)||[]),b=we(()=>n(R)?n(C):n(m)?.relays||[]),E=we(()=>{const F=new Map;return n(S).forEach(r=>{const e=n(m).wallet;e?.mintBalance&&F.set(r,e.mintBalance(r))}),F});function A(){y(f,null),y(g,null)}function L(F){y(g,F,!0),setTimeout(()=>{y(g,null)},3e3)}function z(F){y(f,F instanceof Error?F.message:"Operation failed",!0)}function D(){y(R,!0)}function j(F){const r=F.trim();if(!r)return!1;try{const e=new URL(r);return(e.protocol==="wss:"||e.protocol==="ws:")&&!!e.hostname}catch{return!1}}function X(F){y(_,n(_).filter(r=>r!==F),!0),D(),A()}function T(){let F=n(h).trim();if(!F.startsWith("wss://")&&!F.startsWith("ws://")&&(F=`wss://${F}`),!j(F)){y(f,"Invalid relay URL. Must be a valid WebSocket URL (wss:// or ws://).");return}if(n(b).includes(F)){y(f,"This relay is already added.");return}y(C,[...n(C),F],!0),D(),y(h,""),y(d,!1),A()}function H(F){y(C,n(C).filter(r=>r!==F),!0),D(),A()}function N(F){try{return new URL(F).hostname}catch{return F}}function ee(F){try{return new URL(F).hostname}catch{return F}}function J(F){return new Intl.NumberFormat("en-US").format(F)}function te(F){const r=F.filter(e=>!n(S).includes(e));r.length>0&&(y(_,[...n(_),...r],!0),D(),A()),y(p,!1)}var Q=ps(),ne=qe(Q),ce=i(ne),xe=u(i(ce),2);{var U=F=>{var r=Zo();r.__click=[qo,A,l,m,_,C,R,L,z];var e=i(r);{var t=v=>{var x=Wo();Ie(),w(v,x)},s=v=>{var x=Jo();Ie(),w(v,x)};$(e,v=>{n(l)?v(t):v(s,!1)})}o(r),Z(()=>r.disabled=n(l)),w(F,r)};$(xe,F=>{n(R)&&F(U)})}o(ce);var V=u(ce,2);{var I=F=>{var r=Qo(),e=i(r),t=u(i(e),2),s=i(t,!0);o(t),o(e),o(r),Z(()=>P(s,n(g))),w(F,r)};$(V,F=>{n(g)&&F(I)})}var M=u(V,2);{var ae=F=>{var r=es(),e=i(r),t=u(i(e),2),s=i(t,!0);o(t),o(e),o(r),Z(()=>P(s,n(f))),w(F,r)};$(M,F=>{n(f)&&F(ae)})}var Y=u(M,2),G=i(Y),q=u(i(G),2),se=i(q);o(q),o(G);var re=u(G,2),he=i(re);Ue(he,16,()=>n(S),F=>F,(F,r)=>{var e=as(),t=i(e),s=i(t),v=i(s),x=u(i(v),2),k=i(x),ve=i(k,!0);o(k);var ke=u(k,2),Ee=i(ke,!0);o(ke),o(x),o(v);var Be=u(v,2);{var _e=st=>{var wt=ts(),Ct=i(wt),lr=i(Ct);o(Ct),o(wt),Z(dr=>P(lr,`${dr??""} sats`),[()=>J(n(E).get(r)||0)]),w(st,wt)};$(Be,st=>{n(E).has(r)&&st(_e)})}o(s);var ir=u(s,2);ir.__click=[rs,X,r],o(t),o(e),Z(st=>{P(ve,st),P(Ee,r)},[()=>N(r)]),w(F,e)});var O=u(he,2);{var K=F=>{var r=ns();w(F,r)};$(O,F=>{n(S).length===0&&F(K)})}var oe=u(O,2);oe.__click=[os,p],o(re),o(Y);var ie=u(Y,2),be=i(ie),ue=u(i(be),2),pe=i(ue);o(ue),o(be);var fe=u(be,2),me=i(fe);Ue(me,16,()=>n(b),F=>F,(F,r)=>{var e=is(),t=i(e),s=i(t),v=i(s),x=u(i(v),2),k=i(x),ve=i(k,!0);o(k);var ke=u(k,2),Ee=i(ke,!0);o(ke),o(x),o(v),o(s);var Be=u(s,2);Be.__click=[ss,H,r],o(t),o(e),Z(_e=>{P(ve,_e),P(Ee,r)},[()=>ee(r)]),w(F,e)});var W=u(me,2);{var de=F=>{var r=ls();w(F,r)};$(W,F=>{n(b).length===0&&F(de)})}var Se=u(W,2);{var Le=F=>{var r=cs(),e=i(r),t=i(e);Oe(t),It(t,!0);var s=u(t,4),v=i(s);v.__click=T;var x=u(v,2);x.__click=[ds,d,h,f],o(s),o(e),o(r),Z(k=>v.disabled=k,[()=>!n(h).trim()]),tt(t,()=>n(h),k=>y(h,k)),w(F,r)},Pe=F=>{var r=vs();r.__click=[us,d],w(F,r)};$(Se,F=>{n(d)?F(Le):F(Pe,!1)})}o(fe),o(ie);var Te=u(ie,2),Me=i(Te),Ne=u(i(Me),2),ge=i(Ne);Oe(ge),ge.__change=[Xo],Ie(2),o(Ne),o(Me),o(Te),o(ne);var ye=u(ne,2);{var Re=F=>{Go(F,{onSelectMints:te,onClose:()=>y(p,!1)})};$(ye,F=>{n(p)&&F(Re)})}Z(()=>{P(se,`${n(S).length??""} ${n(S).length===1?"mint":"mints"}`),P(pe,`${n(b).length??""} ${n(b).length===1?"relay":"relays"}`),ct(ge,St.enabled)}),w(c,Q),Ve()}Ke(["click","change"]);function fs(c,a){c.key==="Enter"&&(c.preventDefault(),a())}var ms=B('<div class="p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-600 dark:text-red-400 text-sm"> </div>'),gs=B('<div class="flex items-center justify-center py-8 text-muted-foreground"><svg class="w-5 h-5 animate-spin mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Loading...</div>'),xs=B('<div class="text-center py-8 text-muted-foreground"><svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path></svg> <p class="text-sm">No hashtags followed yet</p> <p class="text-xs mt-1">Add hashtags above to start following topics</p></div>'),_s=(c,a,d)=>a(n(d)),bs=B('<div class="flex items-center justify-between p-3 bg-neutral-100 dark:bg-card border border rounded-lg"><div class="flex items-center gap-2"><span class="text-primary font-medium">#</span> <span class="text-foreground font-medium"> </span></div> <button class="p-1.5 hover:bg-red-500/10 rounded-lg transition-colors group" title="Remove hashtag"><svg class="w-4 h-4 text-muted-foreground group-hover:text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),ys=B('<div class="space-y-2"></div>'),ws=B('<div class="space-y-6"><div class="text-sm text-muted-foreground"><p>Follow hashtags to see related content in your home feed. Your followed hashtags will appear as filters at the top of your home page.</p></div> <div class="space-y-3"><label class="block"><span class="text-sm font-medium text-muted-foreground mb-2 block">Add Hashtag</span> <div class="flex gap-2"><div class="relative flex-1"><span class="absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-lg">#</span> <input type="text" placeholder="bitcoin" class="w-full pl-8 pr-3 py-2 bg-neutral-100 dark:bg-card border border rounded-lg text-foreground placeholder-neutral-500 dark:placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-orange-500"/></div> <button class="px-4 py-2 bg-primary text-foreground rounded-lg hover:bg-primary disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"> </button></div></label> <!></div> <div class="space-y-3"><h3 class="text-sm font-medium text-muted-foreground">Followed Hashtags</h3> <!></div> <div class="p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg"><div class="flex gap-3"><svg class="w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div class="text-sm text-blue-700 dark:text-blue-300"><p class="font-medium mb-1">How it works</p> <ul class="space-y-1 text-xs"><li>‚Ä¢ Click hashtag pills on your home feed to filter by specific hashtags</li> <li>‚Ä¢ When viewing a specific relay, hashtag filters will search within that relay</li> <li>‚Ä¢ When in "Following" mode, hashtag filters will search within your follows</li> <li>‚Ä¢ Your hashtag interests are stored on Nostr (kind 10015)</li></ul></div></div></div></div>');function ks(c,a){je(a,!0);let d=le(""),p=le(!1),h=le(null);async function f(){if(n(d).trim()){y(p,!0),y(h,null);try{const T=n(d).trim().replace(/^#/,"");await it.addHashtag(T),y(d,"")}catch(T){y(h,T instanceof Error?T.message:"Failed to add hashtag",!0)}finally{y(p,!1)}}}async function g(T){try{await it.removeHashtag(T)}catch(H){y(h,H instanceof Error?H.message:"Failed to remove hashtag",!0)}}var l=ws(),m=u(i(l),2),_=i(m),C=u(i(_),2),R=i(C),S=u(i(R),2);Oe(S),S.__keydown=[fs,f],o(R);var b=u(R,2);b.__click=f;var E=i(b,!0);o(b),o(C),o(_);var A=u(_,2);{var L=T=>{var H=ms(),N=i(H,!0);o(H),Z(()=>P(N,n(h))),w(T,H)};$(A,T=>{n(h)&&T(L)})}o(m);var z=u(m,2),D=u(i(z),2);{var j=T=>{var H=gs();w(T,H)},X=T=>{var H=et(),N=qe(H);{var ee=te=>{var Q=xs();w(te,Q)},J=te=>{var Q=ys();Ue(Q,21,()=>it.interests,ze,(ne,ce)=>{var xe=bs(),U=i(xe),V=u(i(U),2),I=i(V,!0);o(V),o(U);var M=u(U,2);M.__click=[_s,g,ce],o(xe),Z(()=>P(I,n(ce))),w(ne,xe)}),o(Q),w(te,Q)};$(N,te=>{it.interests.length===0?te(ee):te(J,!1)},!0)}w(T,H)};$(D,T=>{it.isLoading?T(j):T(X,!1)})}o(z),Ie(2),o(l),Z(T=>{S.disabled=n(p),b.disabled=T,P(E,n(p)?"Adding...":"Add")},[()=>n(p)||!n(d).trim()]),tt(S,()=>n(d),T=>y(d,T)),w(c,l),Ve()}Ke(["keydown","click"]);var Es=(c,a)=>y(a,null),As=B('<div class="pt-6 pb-4 border-b"><div class="flex items-center gap-3"><button class="p-2 hover:bg-neutral-200/50 dark:hover:bg-muted/30 rounded-lg transition-all"><svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <h1 class="text-xl font-semibold text-foreground"> </h1></div></div> <div class="py-6"><!></div>',1),Ss=(c,a,d)=>n(a).available&&y(d,n(a).id,!0),Is=B('<span class="text-xs bg-neutral-200 dark:bg-muted px-1.5 py-0.5 rounded"> </span>'),Bs=Ye('<svg class="w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>'),Ts=B('<button><div class="flex items-center gap-3"><div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg></div> <div class="text-left"><div class="text-sm font-medium text-foreground flex items-center gap-2"> <!></div> <div class="text-xs text-muted-foreground"> </div></div></div> <!></button>'),Cs=B('<div><h2 class="text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-3"> </h2> <div class="space-y-2"></div></div>'),Ms=B('<div class="pt-6 pb-4"><h1 class="text-xl font-semibold text-foreground"> </h1></div> <div class="py-6 space-y-8"></div>',1),Rs=B('<div class="w-full min-h-screen bg-background pb-20 md:pb-0"><div class="max-w-lg mx-auto"><!></div></div>');function zs(c,a){je(a,!0);const d=()=>Qt(ar,"$t",p),[p,h]=er();let f=le(null);const g=[{title:"Content & Personalization",items:[{id:"hashtags",label:"Hashtag Interests",description:"Follow hashtags and filter your feed",iconPath:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14",iconColor:"text-primary",iconBg:"bg-primary/10",component:ks,available:!0},{id:"theme",label:"Appearance",description:"Customize theme and language",iconPath:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01",iconColor:"text-primary",iconBg:"bg-primary-400/10",component:la,available:!0}]},{title:"Servers",items:[{id:"relays",label:"Relays",description:"Manage your Nostr relay connections",iconPath:"M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01",iconColor:"text-blue-400",iconBg:"bg-blue-400/10",component:Wr,available:!0},{id:"blossom",label:"Media Servers",description:"Configure Blossom media upload servers",iconPath:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",iconColor:"text-primary",iconBg:"bg-primary/10",component:Ba,available:!0}]},{title:"Payments",items:[{id:"wallet",label:"Wallet",description:"Manage Cashu mints and wallet relays",iconPath:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z",iconColor:"text-primary",iconBg:"bg-primary/10",component:hs,available:!0},{id:"zap",label:"Zaps",description:"Configure default zap amount and preferences",iconPath:"M13 10V3L4 14h7v7l9-11h-7z",iconColor:"text-yellow-400",iconBg:"bg-yellow-400/10",component:Ao,available:!0}]},{title:"Security & Advanced",items:[{id:"keys",label:"Private Key",description:"View and backup your private key",iconPath:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z",iconColor:"text-red-500",iconBg:"bg-red-500/10",component:co,available:!0},{id:"debug",label:"Debug",description:"View cache statistics and debug information",iconPath:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z",iconColor:"text-green-400",iconBg:"bg-green-400/10",component:mo,available:!0}]}],l=we(()=>g.flatMap(E=>E.items));ot(()=>{const A=new URLSearchParams(window.location.search).get("tab");A&&n(l).some(L=>L.id===A&&L.available)&&y(f,A,!0)});let m=we(()=>n(l).find(E=>E.id===n(f)));var _=Rs(),C=i(_),R=i(C);{var S=E=>{var A=As(),L=qe(A),z=i(L),D=i(z);D.__click=[Es,f];var j=u(D,2),X=i(j,!0);o(j),o(z),o(L);var T=u(L,2),H=i(T);ur(H,()=>n(m).component,(N,ee)=>{ee(N,{})}),o(T),Z(()=>P(X,n(m).label)),w(E,A)},b=E=>{var A=Ms(),L=qe(A),z=i(L),D=i(z,!0);o(z),o(L);var j=u(L,2);Ue(j,21,()=>g,ze,(X,T)=>{var H=Cs(),N=i(H),ee=i(N,!0);o(N);var J=u(N,2);Ue(J,21,()=>n(T).items,ze,(te,Q)=>{var ne=Ts();ne.__click=[Ss,Q,f];var ce=i(ne),xe=i(ce),U=i(xe),V=i(U);o(U),o(xe);var I=u(xe,2),M=i(I),ae=i(M),Y=u(ae);{var G=O=>{var K=Is(),oe=i(K,!0);o(K),Z(ie=>P(oe,ie),[()=>d()("common.soon")]),w(O,K)};$(Y,O=>{n(Q).available||O(G)})}o(M);var q=u(M,2),se=i(q,!0);o(q),o(I),o(ce);var re=u(ce,2);{var he=O=>{var K=Bs();w(O,K)};$(re,O=>{n(Q).available&&O(he)})}o(ne),Z(()=>{ne.disabled=!n(Q).available,Ce(ne,1,`w-full bg-neutral-100 dark:bg-card border rounded-xl p-4 flex items-center justify-between transition-all ${n(Q).available?"hover:bg-neutral-200 dark:hover:bg-muted cursor-pointer":"opacity-50 cursor-not-allowed"}`),Ce(xe,1,`w-10 h-10 rounded-lg flex items-center justify-center ${n(Q).iconBg??""}`),Ce(U,0,`w-5 h-5 ${n(Q).iconColor??""}`),nt(V,"d",n(Q).iconPath),P(ae,`${n(Q).label??""} `),P(se,n(Q).description)}),w(te,ne)}),o(J),o(H),Z(()=>P(ee,n(T).title)),w(X,H)}),o(j),Z(X=>P(D,X),[()=>d()("settings.title")]),w(E,A)};$(R,E=>{n(f)&&n(m)?E(S):E(b,!1)})}o(C),o(_),w(c,_),Ve(),h()}Ke(["click"]);export{zs as component};
