import{d as st,f as d,a as n,s as m,c as ue}from"../chunks/CiPFrJr-.js";import{p as it,a as nt,g as e,u as x,s as M,b as O,e as r,t as P,c as lt,d as s,r as t,f as Q}from"../chunks/CSbKtK4P.js";import{i as f,s as dt,a as vt}from"../chunks/87vUJtvC.js";import{n as w,f as je,d as R,h as Be,e as qe,N as ct}from"../chunks/D0X4VYcq.js";import{p as ut}from"../chunks/fk9xBW3Y.js";import{g as X}from"../chunks/CTwadDAE.js";import{t as fe}from"../chunks/B0fEDaa-.js";import{f as Ee}from"../chunks/BU5VmKcG.js";import{c as W}from"../chunks/Aqrs6FWH.js";import{m as ft}from"../chunks/B8GI64zs.js";import{N as pt}from"../chunks/Cybom7lU.js";import{C as mt}from"../chunks/CWwZauO4.js";import{g as pe}from"../chunks/DeBk5QYO.js";function _t(y,v){e(v)&&Ee.toggleFavorite(e(v).id)}async function gt(y,v,z,N){if(!e(v)||!w.activeUser||e(z).length===0){fe.error("Please login to follow users");return}M(N,!0);try{console.log("Following all users:",e(z)),fe.success(`Following ${e(z).length} users`)}catch(Y){console.error("Error following all users:",Y),fe.error("Failed to follow users")}finally{M(N,!1)}}function ze(){X("/packs")}var bt=d('<div class="h-48 w-full"><img class="w-full h-full object-cover"/></div>'),ht=d('<button class="flex items-center gap-2 px-4 py-2 bg-muted hover:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button>'),kt=d('<button class="flex items-center gap-2 px-4 py-2 bg-primary hover:bg-primary/90 disabled:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path></svg> </button>'),xt=d('<div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <span> </span></div>'),wt=(y,v)=>X(pe(e(v).pubkey)),yt=(y,v)=>X(pe(e(v).pubkey)),Ft=(y,v)=>M(v,"feed"),Pt=d('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),Mt=(y,v)=>M(v,"members"),Ct=d('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),$t=d('<div class="p-8 text-center text-muted-foreground">Loading notes from pack members...</div>'),jt=d('<div class="p-8 text-center text-muted-foreground">No notes found from pack members</div>'),Bt=d('<div class="divide-y divide-neutral-800/50 border-y border-border"><!></div>'),qt=(y,v)=>X(pe(v)),zt=d('<p class="text-sm text-muted-foreground truncate"> </p>'),Et=d('<p class="text-sm text-muted-foreground line-clamp-1 mt-1"> </p>'),Lt=d('<button class="flex items-center gap-3 p-4 bg-card border border-border rounded-lg hover:border-border transition-colors text-left"><!> <div class="flex-1 min-w-0"><p class="font-medium text-foreground truncate"> </p> <!> <!></div></button>'),At=d('<div class="grid gap-4 md:grid-cols-2"></div>'),Ut=d('<div class="bg-card border border-border rounded-xl overflow-hidden mb-6"><!> <div class="p-6"><div class="flex items-start justify-between mb-4"><div><h1 class="text-2xl font-bold text-foreground mb-2 svelte-1xwqwht"> </h1> <p class="text-muted-foreground"> </p></div> <div class="flex items-center gap-2"><!> <button><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg></button></div></div> <div class="flex items-center gap-6 mb-6 text-sm"><div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> <span> </span></div> <!></div> <div class="flex items-center gap-3"><button type="button" class="flex-shrink-0"><!></button> <div><p class="text-sm text-muted-foreground">Created by</p> <button class="font-medium text-foreground hover:text-primary transition-colors"> </button></div></div></div></div> <div class="border-b border-border mb-6"><div class="flex gap-6"><button>Feed <!></button> <button> <!></button></div></div> <!>',1),Vt=d('<div class="text-center py-12"><div class="inline-block w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mb-4"></div> <p class="text-muted-foreground">Loading follow pack...</p></div>'),Dt=d('<div class="text-center py-12"><p class="text-muted-foreground">Follow pack not found</p> <button class="text-primary hover:text-primary/90 mt-4 inline-block transition-colors">Browse all packs</button></div>'),Ht=d('<div class="pack-detail-container svelte-1xwqwht"><div class="pack-header svelte-1xwqwht"><button class="back-btn svelte-1xwqwht"><svg class="w-6 h-6 svelte-1xwqwht" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <h1 class="svelte-1xwqwht"> </h1></div> <div class="pack-content svelte-1xwqwht"><!> <!></div></div>');function Zt(y,v){it(v,!0);const z=()=>vt(ut,"$page",N),[N,Y]=dt(),S=x(()=>z().params.packId);let F=O("feed"),Z=O(!1),c=O(null),E=O(!0);nt(()=>{e(S)&&(M(E,!0),w.fetchEvent(e(S)).then(l=>{l&&M(c,l,!0),M(E,!1)}).catch(l=>{console.error("Failed to fetch pack:",l),M(E,!1)}))});let i=x(()=>e(c)?{id:e(c).id||"",title:e(c).tagValue("title")||"Untitled Pack",description:e(c).tagValue("description"),image:e(c).tagValue("image"),pubkeys:e(c).tags.filter(l=>l[0]==="p").map(l=>l[1]),encode:()=>e(c).encode(),kind:e(c).kind||39089,pubkey:e(c).pubkey,created_at:e(c).created_at||0}:e(S)&&!e(E)?ft.find(l=>l.encode()===e(S)):null),C=x(()=>e(i)?.pubkeys||[]);const Le=w.$fetchProfile(()=>e(i)?.pubkey);let me=x(()=>e(i)?Ee.isFavorite(e(i).id):!1),Ae=x(()=>e(i)&&w.$currentUser?e(i).pubkey===w.$currentUser.pubkey:!1);const _e=x(()=>e(F)==="feed"&&e(C).length>0?(console.log(`[FollowPackDetail] Creating subscription for ${e(C).length} members`),w.$subscribe(()=>({filters:[{kinds:[ct.Text],authors:e(C),limit:50}],bufferMs:100}))):null),ee=x(()=>e(_e)?.events||[]),Ue=x(()=>e(_e)?.eosed||!1);function Ve(){e(c)&&W.open(e(c))}var te=Ht(),re=r(te),ge=r(re);ge.__click=[ze];var be=s(ge,2),De=r(be,!0);t(be),t(re);var he=s(re,2),ke=r(he);{var He=l=>{var L=Ut(),A=Q(L),I=r(A);{var oe=o=>{var a=bt(),u=r(a);t(a),P(()=>{Be(u,"src",e(i).image),Be(u,"alt",e(i).title)}),n(o,a)};f(I,o=>{e(i).image&&o(oe)})}var _=s(I,2),g=r(_),U=r(g),ae=r(U),Ie=r(ae,!0);t(ae);var xe=s(ae,2),Ke=r(xe,!0);t(xe),t(U);var we=s(U,2),ye=r(we);{var Te=o=>{var a=ht();a.__click=Ve,n(o,a)},Ge=o=>{var a=kt();a.__click=[gt,i,C,Z];var u=s(r(a));t(a),P(()=>{a.disabled=e(Z),m(u,` ${e(Z)?"Following...":"Follow All"}`)}),n(o,a)};f(ye,o=>{e(Ae)?o(Te):o(Ge,!1)})}var K=s(ye,2);K.__click=[_t,i];var Je=r(K);t(K),t(we),t(g);var se=s(g,2),ie=r(se),Fe=s(r(ie),2),Oe=r(Fe);t(Fe),t(ie);var Qe=s(ie,2);{var Re=o=>{var a=xt(),u=s(r(a),2),$=r(u);t(u),t(a),P(b=>m($,`Updated ${b??""}`),[()=>new Date(e(i).created_at*1e3).toLocaleDateString()]),n(o,a)};f(Qe,o=>{e(i).created_at&&o(Re)})}t(se);var Pe=s(se,2),T=r(Pe);T.__click=[wt,i];var We=r(T);je(We,{get ndk(){return w},get pubkey(){return e(i).pubkey},class:"w-10 h-10 rounded-full cursor-pointer hover:opacity-80 transition-opacity"}),t(T);var Me=s(T,2),ne=s(r(Me),2);ne.__click=[yt,i];var Xe=r(ne,!0);t(ne),t(Me),t(Pe),t(_),t(A);var le=s(A,2),Ce=r(le),V=r(Ce);V.__click=[Ft,F];var Ye=s(r(V));{var Ze=o=>{var a=Pt();n(o,a)};f(Ye,o=>{e(F)==="feed"&&o(Ze)})}t(V);var G=s(V,2);G.__click=[Mt,F];var $e=r(G),et=s($e);{var tt=o=>{var a=Ct();n(o,a)};f(et,o=>{e(F)==="members"&&o(tt)})}t(G),t(Ce),t(le);var rt=s(le,2);{var ot=o=>{var a=Bt(),u=r(a);{var $=p=>{var j=$t();n(p,j)},b=p=>{var j=ue(),J=Q(j);{var D=h=>{var q=jt();n(h,q)},de=h=>{var q=ue(),ve=Q(q);qe(ve,17,()=>e(ee),H=>H.id,(H,k)=>{pt(H,{get event(){return e(k)}})}),n(h,q)};f(J,h=>{e(ee).length===0?h(D):h(de,!1)},!0)}n(p,j)};f(u,p=>{e(ee).length===0&&!e(Ue)?p($):p(b,!1)})}t(a),n(o,a)},at=o=>{var a=At();qe(a,20,()=>e(C),u=>u,(u,$)=>{const b=x(()=>w.$fetchProfile(()=>$));var p=Lt();p.__click=[qt,$];var j=r(p);je(j,{get ndk(){return w},get pubkey(){return $},class:"w-12 h-12 rounded-full"});var J=s(j,2),D=r(J),de=r(D,!0);t(D);var h=s(D,2);{var q=k=>{var B=zt(),ce=r(B,!0);t(B),P(()=>m(ce,e(b)?.nip05)),n(k,B)};f(h,k=>{e(b)?.nip05&&k(q)})}var ve=s(h,2);{var H=k=>{var B=Et(),ce=r(B,!0);t(B),P(()=>m(ce,e(b)?.about)),n(k,B)};f(ve,k=>{e(b)?.about&&k(H)})}t(J),t(p),P(()=>m(de,e(b)?.name||"Anonymous")),n(u,p)}),t(a),n(o,a)};f(rt,o=>{e(F)==="feed"?o(ot):o(at,!1)})}P(()=>{m(Ie,e(i).title),m(Ke,e(i).description||"A curated list of accounts to follow"),R(K,1,`p-2.5 rounded-lg transition-colors ${e(me)?"bg-red-500/10 text-red-500":"bg-muted text-muted-foreground hover:text-foreground"}`),R(Je,0,`w-5 h-5 ${e(me)?"fill-current":""}`),m(Oe,`${e(C).length??""} members`),m(Xe,Le?.name||"Anonymous"),R(V,1,`pb-3 px-1 font-medium transition-colors relative ${e(F)==="feed"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),R(G,1,`pb-3 px-1 font-medium transition-colors relative ${e(F)==="members"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),m($e,`Members (${e(C).length??""}) `)}),n(l,L)},Ne=l=>{var L=ue(),A=Q(L);{var I=_=>{var g=Vt();n(_,g)},oe=_=>{var g=Dt(),U=s(r(g),2);U.__click=[ze],t(g),n(_,g)};f(A,_=>{e(E)?_(I):_(oe,!1)},!0)}n(l,L)};f(ke,l=>{e(i)?l(He):l(Ne,!1)})}var Se=s(ke,2);mt(Se,{get editingPack(){return W.data},get open(){return W.show},set open(l){W.show=l}}),t(he),t(te),P(()=>m(De,e(i)?.title||"Follow Pack")),n(y,te),lt(),Y()}st(["click"]);export{Zt as component};
