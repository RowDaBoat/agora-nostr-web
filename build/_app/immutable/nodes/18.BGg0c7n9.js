import"../chunks/DsnmJJEf.js";import{p as De,u as ne,s as _,b as C,i as u,k as r,j as o,g as e,r as t,t as y,e as l,h as He,l as h,f as T,d as lt,a as L,c as ye}from"../chunks/UP8uQ6W_.js";import{i as c}from"../chunks/_gFmmxLT.js";import{e as qe}from"../chunks/DA17f6bB.js";import{a as W,c as le}from"../chunks/BUa9uPHk.js";import{s as vt,a as dt}from"../chunks/B2G7F-H5.js";import{n as j,a as ut,N as ct}from"../chunks/CnpwhG0Y.js";import{p as ft}from"../chunks/D1QAb2Yt.js";import{g as Fe}from"../chunks/C3QbOBEF.js";import{t as Pe}from"../chunks/BeJK5XQO.js";import{f as ze}from"../chunks/DzQV0z0u.js";import{c as se}from"../chunks/D4-snA2H.js";import{m as mt}from"../chunks/C6SIxCTZ.js";import{A as Ie}from"../chunks/BoWL87Fx.js";import{N as pt}from"../chunks/Btpm2RVz.js";import{C as _t}from"../chunks/DvkoW-uU.js";import{p as ie}from"../chunks/B36lUvow.js";import{F as gt}from"../chunks/BUVM5Lwt.js";import{f as bt}from"../chunks/KSN4Ur19.js";import{g as Le}from"../chunks/7RLc7DUv.js";var ht=u('<p class="text-sm text-muted-foreground truncate"> </p>'),xt=u('<a class="block group"><h4 class="font-semibold text-foreground group-hover:text-primary transition-colors truncate"> </h4> <!></a>'),kt=u('<p class="text-sm text-muted-foreground truncate"> </p>'),wt=u('<h4 class="font-semibold text-foreground truncate"> </h4> <!>',1),yt=u("<span> </span>"),Ft=u("<span>â€¢</span>"),Pt=u('<!> <span>Invited by <a class="text-primary hover:underline"> </a></span>',1),At=u('<div class="flex items-center gap-2 mt-1 text-xs text-muted-foreground"><!> <!></div>'),jt=u('<p class="mt-2 text-sm text-foreground/80 line-clamp-2"> </p>'),Mt=u('<div class="flex-shrink-0"><!></div>'),Ct=u('<div><!> <div class="flex-1 min-w-0"><div class="flex items-start justify-between gap-2"><div class="flex-1 min-w-0"><!> <!> <!></div> <!></div></div></div>');function Nt(ve,f){De(f,!0);let de=ie(f,"showFollow",3,!0),ue=ie(f,"showAbout",3,!0),ce=ie(f,"clickable",3,!0),V=ie(f,"class",3,""),F=C(void 0),g=C(null),i=C(void 0),A=C(null);ne(()=>{j.fetchUser(f.pubkey).then(v=>{_(F,v,!0),v?.fetchProfile().then(d=>{_(g,d,!0)})})}),ne(()=>{if(!f.inviterPubkey){_(i,void 0),_(A,null);return}j.fetchUser(f.inviterPubkey).then(v=>{_(i,v,!0),v?.fetchProfile().then(d=>{_(A,d,!0)})})});var x=Ct(),D=r(x);Ie(D,{get ndk(){return j},get pubkey(){return f.pubkey},class:"w-12 h-12 rounded-full"});var J=o(D,2),X=r(J),H=r(X),I=r(H);{var fe=v=>{var d=xt(),m=r(d),N=r(m,!0);t(m);var B=o(m,2);{var U=p=>{var a=ht(),b=r(a,!0);t(a),y(()=>h(b,e(g).nip05)),l(p,a)};c(B,p=>{e(g)?.nip05&&p(U)})}t(d),y(()=>{le(d,"href",`/p/${e(F).npub??""}`),h(N,e(g)?.displayName||e(g)?.name||"Anon")}),l(v,d)},me=v=>{var d=wt(),m=T(d),N=r(m,!0);t(m);var B=o(m,2);{var U=p=>{var a=kt(),b=r(a,!0);t(a),y(()=>h(b,e(g).nip05)),l(p,a)};c(B,p=>{e(g)?.nip05&&p(U)})}y(()=>h(N,e(g)?.displayName||e(g)?.name||"Anon")),l(v,d)};c(I,v=>{ce()?v(fe):v(me,!1)})}var Y=o(I,2);{var Z=v=>{var d=At(),m=r(d);{var N=p=>{var a=yt(),b=r(a);t(a),y(M=>h(b,`Joined ${M??""}`),[()=>bt(f.joinedAt)]),l(p,a)};c(m,p=>{f.joinedAt&&p(N)})}var B=o(m,2);{var U=p=>{var a=Pt(),b=T(a);{var M=k=>{var z=Ft();l(k,z)};c(b,k=>{f.joinedAt&&k(M)})}var E=o(b,2),q=o(r(E)),P=r(q,!0);t(q),t(E),y(()=>{le(q,"href",`/p/${e(i)?.npub??""}`),h(P,e(A).displayName||e(A).name||"someone")}),l(p,a)};c(B,p=>{f.inviterPubkey&&e(A)&&p(U)})}t(d),l(v,d)};c(Y,v=>{(f.joinedAt||f.inviterPubkey)&&v(Z)})}var pe=o(Y,2);{var O=v=>{var d=jt(),m=r(d,!0);t(d),y(()=>h(m,e(g).about)),l(v,d)};c(pe,v=>{ue()&&e(g)?.about&&v(O)})}t(H);var G=o(H,2);{var $=v=>{var d=Mt(),m=r(d);gt(m,{get pubkey(){return f.pubkey},iconOnly:!0}),t(d),l(v,d)};c(G,v=>{de()&&v($)})}t(X),t(J),t(x),y(()=>W(x,1,`flex items-start gap-3 p-4 bg-card rounded-lg border border-border hover:border-primary/30 transition-colors ${V()??""}`)),l(ve,x),He()}var Bt=u('<div class="h-48 w-full"><img class="w-full h-full object-cover"/></div>'),Ut=u('<button class="flex items-center gap-2 px-4 py-2 bg-muted hover:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg> Edit</button>'),Et=u('<button class="flex items-center gap-2 px-4 py-2 bg-primary hover:bg-primary/90 disabled:bg-muted text-foreground font-medium rounded-lg transition-colors whitespace-nowrap"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path></svg> </button>'),qt=u('<div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> <span> </span></div>'),zt=u('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),Lt=u('<div class="absolute bottom-0 left-0 right-0 h-0.5 bg-primary"></div>'),Dt=u('<div class="p-8 text-center text-muted-foreground">Loading notes from pack members...</div>'),Ht=u('<div class="p-8 text-center text-muted-foreground">No notes found from pack members</div>'),It=u('<div class="divide-y divide-neutral-800/50 border-y border-border"><!></div>'),Kt=u('<div class="grid gap-4 md:grid-cols-2"></div>'),St=u('<div class="bg-card border border-border rounded-xl overflow-hidden mb-6"><!> <div class="p-6"><div class="flex items-start justify-between mb-4"><div><h1 class="text-2xl font-bold text-foreground mb-2 svelte-1xwqwht"> </h1> <p class="text-muted-foreground"> </p></div> <div class="flex items-center gap-2"><!> <button><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg></button></div></div> <div class="flex items-center gap-6 mb-6 text-sm"><div class="flex items-center gap-2 text-muted-foreground"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> <span> </span></div> <!></div> <div class="flex items-center gap-3"><button type="button" class="flex-shrink-0"><!></button> <div><p class="text-sm text-muted-foreground">Created by</p> <button class="font-medium text-foreground hover:text-primary transition-colors"> </button></div></div></div></div> <div class="border-b border-border mb-6"><div class="flex gap-6"><button>Feed <!></button> <button> <!></button></div></div> <!>',1),Tt=u('<div class="text-center py-12"><div class="inline-block w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mb-4"></div> <p class="text-muted-foreground">Loading follow pack...</p></div>'),Vt=u('<div class="text-center py-12"><p class="text-muted-foreground">Follow pack not found</p> <button class="text-primary hover:text-primary/90 mt-4 inline-block transition-colors">Browse all packs</button></div>'),Jt=u('<div class="pack-detail-container svelte-1xwqwht"><div class="pack-header svelte-1xwqwht"><button class="back-btn svelte-1xwqwht"><svg class="w-6 h-6 svelte-1xwqwht" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></button> <h1 class="svelte-1xwqwht"> </h1></div> <div class="pack-content svelte-1xwqwht"><!> <!></div></div>');function ur(ve,f){De(f,!0);const de=()=>dt(ft,"$page",ue),[ue,ce]=vt(),V=L(()=>de().params.packId);let F=C("feed"),g=C(!1),i=C(null),A=C(!0);ne(()=>{e(V)&&(_(A,!0),j.fetchEvent(e(V)).then(a=>{a?_(i,ut.from(a),!0):_(i,mt.find(b=>b.encode()===e(V))||null,!0),_(A,!1)}).catch(a=>{console.error("Failed to fetch pack:",a),_(A,!1)}))});let x=L(()=>e(i)?.pubkeys||[]),D=C(null);ne(()=>{if(!e(i)?.author){_(D,null);return}e(i).author.fetchProfile().then(a=>{_(D,a,!0)})});let J=L(()=>e(i)?ze.isFavorite(e(i).id):!1),X=L(()=>e(i)&&j.$currentUser?e(i).pubkey===j.$currentUser.pubkey:!1);const H=L(()=>e(F)==="feed"&&e(x).length>0?(console.log(`[FollowPackDetail] Creating subscription for ${e(x).length} members`),j.$subscribe(()=>({filters:[{kinds:[ct.Text],authors:e(x),limit:50}],bufferMs:100}))):null),I=L(()=>e(H)?.events||[]),fe=L(()=>e(H)?.eosed||!1);function me(){e(i)&&ze.toggleFavorite(e(i).id)}async function Y(){if(!e(i)||!j.activeUser||e(x).length===0){Pe.error("Please login to follow users");return}_(g,!0);try{Pe.success(`Following ${e(x).length} users`),j.$follows.add(e(x))}catch(a){console.error("Error following all users:",a),Pe.error("Failed to follow users")}finally{_(g,!1)}}function Z(){Fe("/packs")}function pe(){packEvent&&se.open(packEvent)}var O=Jt(),G=r(O),$=r(G);$.__click=Z;var v=o($,2),d=r(v,!0);t(v),t(G);var m=o(G,2),N=r(m);{var B=a=>{var b=St(),M=T(b),E=r(M);{var q=s=>{var n=Bt(),w=r(n);t(n),y(()=>{le(w,"src",e(i).image),le(w,"alt",e(i).title)}),l(s,n)};c(E,s=>{e(i).image&&s(q)})}var P=o(E,2),k=r(P),z=r(k),_e=r(z),Ke=r(_e,!0);t(_e);var Ae=o(_e,2),Se=r(Ae,!0);t(Ae),t(z);var je=o(z,2),Me=r(je);{var Te=s=>{var n=Ut();n.__click=pe,l(s,n)},Ve=s=>{var n=Et();n.__click=Y;var w=o(r(n));t(n),y(()=>{n.disabled=e(g),h(w,` ${e(g)?"Following...":"Follow All"}`)}),l(s,n)};c(Me,s=>{e(X)?s(Te):s(Ve,!1)})}var ee=o(Me,2);ee.__click=me;var Je=r(ee);t(ee),t(je),t(k);var ge=o(k,2),be=r(ge),Ce=o(r(be),2),Oe=r(Ce);t(Ce),t(be);var Ge=o(be,2);{var Qe=s=>{var n=qt(),w=o(r(n),2),R=r(w);t(w),t(n),y(ke=>h(R,`Updated ${ke??""}`),[()=>new Date(e(i).created_at*1e3).toLocaleDateString()]),l(s,n)};c(Ge,s=>{e(i).created_at&&s(Qe)})}t(ge);var Ne=o(ge,2),te=r(Ne);te.__click=()=>Fe(Le(e(i).pubkey));var Re=r(te);Ie(Re,{get ndk(){return j},get pubkey(){return e(i).pubkey},class:"w-10 h-10 rounded-full cursor-pointer hover:opacity-80 transition-opacity"}),t(te);var Be=o(te,2),he=o(r(Be),2);he.__click=()=>Fe(Le(e(i).pubkey));var We=r(he,!0);t(he),t(Be),t(Ne),t(P),t(M);var xe=o(M,2),Ue=r(xe),Q=r(Ue);Q.__click=()=>_(F,"feed");var Xe=o(r(Q));{var Ye=s=>{var n=zt();l(s,n)};c(Xe,s=>{e(F)==="feed"&&s(Ye)})}t(Q);var re=o(Q,2);re.__click=()=>_(F,"members");var Ee=r(re),Ze=o(Ee);{var $e=s=>{var n=Lt();l(s,n)};c(Ze,s=>{e(F)==="members"&&s($e)})}t(re),t(Ue),t(xe);var et=o(xe,2);{var tt=s=>{var n=It(),w=r(n);{var R=K=>{var ae=Dt();l(K,ae)},ke=K=>{var ae=ye(),at=T(ae);{var ot=S=>{var oe=Ht();l(S,oe)},st=S=>{var oe=ye(),it=T(oe);qe(it,17,()=>e(I),we=>we.id,(we,nt)=>{pt(we,{get event(){return e(nt)}})}),l(S,oe)};c(at,S=>{e(I).length===0?S(ot):S(st,!1)},!0)}l(K,ae)};c(w,K=>{e(I).length===0&&!e(fe)?K(R):K(ke,!1)})}t(n),l(s,n)},rt=s=>{var n=Kt();qe(n,20,()=>e(x),w=>w,(w,R)=>{Nt(w,{get pubkey(){return R}})}),t(n),l(s,n)};c(et,s=>{e(F)==="feed"?s(tt):s(rt,!1)})}y(()=>{h(Ke,e(i).title),h(Se,e(i).description||"A curated list of accounts to follow"),W(ee,1,`p-2.5 rounded-lg transition-colors ${e(J)?"bg-red-500/10 text-red-500":"bg-muted text-muted-foreground hover:text-foreground"}`),W(Je,0,`w-5 h-5 ${e(J)?"fill-current":""}`),h(Oe,`${e(x).length??""} members`),h(We,e(D)?.name||"Anonymous"),W(Q,1,`pb-3 px-1 font-medium transition-colors relative ${e(F)==="feed"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),W(re,1,`pb-3 px-1 font-medium transition-colors relative ${e(F)==="members"?"text-foreground":"text-muted-foreground hover:text-foreground"}`),h(Ee,`Members (${e(x).length??""}) `)}),l(a,b)},U=a=>{var b=ye(),M=T(b);{var E=P=>{var k=Tt();l(P,k)},q=P=>{var k=Vt(),z=o(r(k),2);z.__click=Z,t(k),l(P,k)};c(M,P=>{e(A)?P(E):P(q,!1)},!0)}l(a,b)};c(N,a=>{e(i)?a(B):a(U,!1)})}var p=o(N,2);_t(p,{get editingPack(){return se.data},get open(){return se.show},set open(a){se.show=a}}),t(m),t(O),y(()=>h(d,e(i)?.title||"Follow Pack")),l(ve,O),He(),ce()}lt(["click"]);export{ur as component};
