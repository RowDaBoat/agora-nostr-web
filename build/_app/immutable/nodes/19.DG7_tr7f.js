import{f as u,a as s,s as N,c as S}from"../chunks/CiPFrJr-.js";import{p as Ae,a as ze,s as Fe,b as Ne,g as e,t as H,c as Se,d as M,e as o,u as m,r as n,y as Te,f as y}from"../chunks/CSbKtK4P.js";import{i as w,s as Ue,a as je}from"../chunks/87vUJtvC.js";import{N as _,n as P,i as He,e as Y,f as Ie,h as Ve,j as Be}from"../chunks/D0X4VYcq.js";import{p as Ke}from"../chunks/fk9xBW3Y.js";import{s as oe}from"../chunks/BRVPpNUj.js";import{N as Pe}from"../chunks/Cybom7lU.js";import{A as De}from"../chunks/BFBlLZUW.js";import{M as Ee}from"../chunks/BVXFxIlg.js";import{c as Z,L as ne}from"../chunks/BZ_HYA_A.js";import{M as Ge}from"../chunks/DzmEV5EQ.js";import{g as qe}from"../chunks/DeBk5QYO.js";var Je=u('<div class="h-12 bg-neutral-800 rounded animate-pulse"></div> <div class="h-12 bg-neutral-800 rounded animate-pulse"></div> <div class="h-12 bg-neutral-800 rounded animate-pulse"></div>',1),Oe=u('<a class="flex items-center gap-3 hover:bg-muted/50 rounded-lg p-2 transition-colors"><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-neutral-500"> </div></div></a>'),Qe=u('<div class="p-4 bg-card rounded-lg border border-border"><div class="flex items-center gap-2 mb-4"><svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <h2 class="text-lg font-semibold text-foreground">Top Authors</h2></div> <div class="space-y-3"><!></div></div>'),Re=u('<div class="p-8 text-center text-neutral-400"> </div>'),We=u('<div class="p-8 text-center text-neutral-400">Loading articles...</div>'),Xe=u("<!> <!>",1),Ye=u('<div class="p-8 text-center text-neutral-400"> </div>'),Ze=u('<div class="p-8 text-center text-neutral-400"> </div>'),$e=u('<div class="p-4"><!></div>'),et=u('<div class="p-8 text-center text-neutral-400">Connecting to relays...</div>'),tt=u('<div class="p-8 text-center text-neutral-400"> </div>'),rt=u('<div class="p-8 text-center text-neutral-400">Loading notes...</div>'),at=u("<!> <!>",1),st=u('<div class="max-w-full mx-auto"><div class="sticky top-0 z-10 bg-background/90 backdrop-blur-xl border-b border-border/50"><div class="px-4 py-4"><div class="flex items-center gap-3"><a href="/" class="flex items-center justify-center w-8 h-8 rounded-full hover:bg-neutral-800 transition-colors" aria-label="Back to home"><svg class="w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg></a> <div><h1 class="text-xl font-bold text-foreground flex items-center gap-2"><span class="text-primary">#</span> </h1> <p class="text-sm text-neutral-400"> </p></div></div></div> <!></div> <div class="divide-y divide-neutral-800/50"><!></div></div>');function _t(de,le){Ae(le,!0);const ve=()=>je(Ke,"$page",ce),[ce,ge]=Ue(),fe=t=>{var r=Qe(),c=M(o(r),2),I=o(c);{var V=i=>{var d=Je();Te(4),s(i,d)},h=i=>{var d=S(),C=y(d);Y(C,17,()=>e(te),({pubkey:A,count:g})=>A,(A,g)=>{let a=()=>e(g).pubkey,l=()=>e(g).count;var x=Oe(),b=o(x);Ie(b,{get ndk(){return P},get pubkey(){return a()},class:"w-10 h-10 rounded-full flex-shrink-0"});var p=M(b,2),f=o(p),k=o(f);n(f);var j=M(f,2),R=o(j);n(j),n(p),n(x),H((W,F)=>{Ve(x,"href",W),N(k,`${F??""}...`),N(R,`${l()??""} ${l()===1?"post":"posts"}`)},[()=>qe(a()),()=>a().slice(0,16)]),s(A,x)}),s(i,d)};w(I,i=>{e(te).length===0?i(V):i(h,!1)})}n(c),n(r),s(t,r)};let v=Ne("conversations");const z=m(()=>ve().params.hashtag),T=m(()=>He.relays.filter(t=>t.enabled&&t.read).map(t=>t.url)),U=Z(P,()=>{const t=e(z);return{filters:[{kinds:[_.Text],"#t":[t.toLowerCase()],limit:200}],relayUrls:e(T).length>0?e(T):void 0}},{initialLimit:20,pageSize:20}),B=Z(P,()=>{const t=e(z);return{filters:[{kinds:[_.Text,_.Image,_.Video,_.ShortVideo],"#t":[t.toLowerCase()],limit:300}],relayUrls:e(T).length>0?e(T):void 0}},{initialLimit:30,pageSize:30}),L=Z(P,()=>{const t=e(z);return{filters:[{kinds:[_.Article],"#t":[t.toLowerCase()],limit:100}],cacheUsage:1,relayUrls:e(T).length>0?e(T):void 0}},{initialLimit:10,pageSize:10}),ue=m(()=>L.events.map(t=>Be.from(t))),D=m(()=>e(ue).filter(t=>t.title&&t.content).sort((t,r)=>(r.published_at??r.created_at??0)-(t.published_at??t.created_at??0)));function $(t,r){return(r==="image"?/(https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg|avif))/gi:/(https?:\/\/[^\s]+\.(mp4|webm|mov|avi|mkv))/gi).test(t)}const E=m(()=>e(v)==="images"?B.events.filter(t=>t.kind===_.Image||t.kind===_.Text&&$(t.content,"image")):e(v)==="videos"?B.events.filter(t=>t.kind===_.Video||t.kind===_.ShortVideo||t.kind===_.Text&&$(t.content,"video")):[]),G=m(()=>e(v)==="articles"?[]:U.events),pe=m(()=>e(v)==="articles"?L.eosed:U.eosed),me=m(()=>(e(v)==="articles","connected")),_e=m(()=>e(v)==="articles"?L.hasMore:U.hasMore),he=m(()=>e(v)==="articles"?L.isLoading:U.isLoading);function ee(){e(v)==="articles"?L.loadMore():U.loadMore()}const te=m(()=>{const t=new Map;return[...U.events,...B.events,...L.events].forEach(r=>{const c=t.get(r.pubkey)||0;t.set(r.pubkey,c+1)}),Array.from(t.entries()).sort((r,c)=>c[1]-r[1]).slice(0,5).map(([r,c])=>({pubkey:r,count:c}))});ze(()=>(oe.rightSidebar=fe,()=>{oe.clear()}));var q=st(),J=o(q),O=o(J),re=o(O),ae=M(o(re),2),Q=o(ae),xe=M(o(Q));n(Q);var se=M(Q,2),be=o(se);n(se),n(ae),n(re),n(O);var ke=M(O,2);Ge(ke,{get selectedFilter(){return e(v)},onFilterChange:t=>Fe(v,t,!0)}),n(J);var ie=M(J,2),Me=o(ie);{var ye=t=>{var r=Xe(),c=y(r);{var I=i=>{var d=Re(),C=o(d);n(d),H(()=>N(C,`No articles found with #${e(z)??""}`)),s(i,d)},V=i=>{var d=S(),C=y(d);{var A=a=>{var l=We();s(a,l)},g=a=>{var l=S(),x=y(l);Y(x,17,()=>e(D),b=>b.id,(b,p)=>{De(b,{get article(){return e(p)}})}),s(a,l)};w(C,a=>{e(D).length===0?a(A):a(g,!1)},!0)}s(i,d)};w(c,i=>{e(D).length===0&&L.eosed?i(I):i(V,!1)})}var h=M(c,2);ne(h,{onIntersect:ee,get hasMore(){return L.hasMore},get isLoading(){return L.isLoading}}),s(t,r)},we=t=>{var r=S(),c=y(r);{var I=h=>{var i=$e(),d=o(i);{var C=g=>{var a=Ye(),l=o(a);n(a),H(()=>N(l,`No ${e(v)??""} found with #${e(z)??""}`)),s(g,a)},A=g=>{var a=S(),l=y(a);{var x=p=>{var f=Ze(),k=o(f);n(f),H(()=>N(k,`Loading ${e(v)??""}...`)),s(p,f)},b=p=>{Ee(p,{get events(){return e(E)}})};w(l,p=>{e(E).length===0?p(x):p(b,!1)},!0)}s(g,a)};w(d,g=>{e(E).length===0&&B.eosed?g(C):g(A,!1)})}n(i),s(h,i)},V=h=>{var i=at(),d=y(i);{var C=a=>{var l=et();s(a,l)},A=a=>{var l=S(),x=y(l);{var b=f=>{var k=tt(),j=o(k);n(k),H(()=>N(j,`No notes found with #${e(z)??""}`)),s(f,k)},p=f=>{var k=S(),j=y(k);{var R=F=>{var K=rt();s(F,K)},W=F=>{var K=S(),Le=y(K);Y(Le,17,()=>e(G),X=>X.id,(X,Ce)=>{Pe(X,{get event(){return e(Ce)}})}),s(F,K)};w(j,F=>{e(G).length===0?F(R):F(W,!1)},!0)}s(f,k)};w(x,f=>{e(G).length===0&&e(pe)?f(b):f(p,!1)},!0)}s(a,l)};w(d,a=>{e(me)==="connecting"?a(C):a(A,!1)})}var g=M(d,2);ne(g,{onIntersect:ee,get hasMore(){return e(_e)},get isLoading(){return e(he)}}),s(h,i)};w(c,h=>{e(v)==="images"||e(v)==="videos"?h(I):h(V,!1)},!0)}s(t,r)};w(Me,t=>{e(v)==="articles"?t(ye):t(we,!1)})}n(ie),n(q),H(()=>{N(xe,` ${e(z)??""}`),N(be,`Posts tagged with #${e(z)??""}`)}),s(de,q),Se(),ge()}export{_t as component};
