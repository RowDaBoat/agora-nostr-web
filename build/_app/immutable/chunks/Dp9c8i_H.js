import{f as w,s as J,a as h,d as ue,c as me,j as Y,i as ve}from"./DNmf0A2m.js";import{p as ee,e as c,d as g,r as u,t as B,g as e,b as k,c as te,a as I,x as fe,f as pe,z as ge,s as d}from"./DpkVnRja.js";import{i as U}from"./Btb_Ey2R.js";import{s as he}from"./CszMzaRi.js";import{a as P}from"./Ci0hv7jC.js";import{p as Z}from"./f_qAQkK6.js";import{I as xe}from"./B7jIYntu.js";import{b as be}from"./Cl1e4hnh.js";import{b as $}from"./-Mgh5RB7.js";import{N as _e,c as ye}from"./CwXZxT0m.js";import{n as D}from"./QTLWRGLp.js";import{U as ke}from"./CFmbs-Nt.js";import{B as we}from"./OHIcQ-QL.js";import{t as G}from"./BHGJODx2.js";import{U as Se}from"./DiXitoXJ.js";var ze=w('<div class="mb-3 text-muted-foreground opacity-50"><!></div>'),Ee=w("<p> </p>"),Ue=w('<div class="mt-4"><!></div>'),Ce=w("<div><!> <p> </p> <!> <!></div>");function Re(K,a){ee(a,!0);const o=Z(a,"size",3,"md"),m=Z(a,"class",3,""),l=k(()=>({sm:"py-6",md:"py-12",lg:"py-16"})[o()]),f=k(()=>({sm:"lg",md:"xl",lg:"xl"})[o()]),C=k(()=>({sm:"text-sm",md:"text-base",lg:"text-lg"})[o()]),F=k(()=>({sm:"text-xs",md:"text-sm",lg:"text-base"})[o()]);var S=Ce(),z=c(S);{var M=i=>{var s=ze(),b=c(s);xe(b,{get name(){return a.icon},get size(){return e(f)}}),u(s),h(i,s)};U(z,i=>{a.icon&&i(M)})}var x=g(z,2),H=c(x,!0);u(x);var N=g(x,2);{var O=i=>{var s=Ee(),b=c(s,!0);u(s),B(()=>{P(s,1,`${e(F)??""} text-muted-foreground/70 text-center mt-1 max-w-md`),J(b,a.description)}),h(i,s)};U(N,i=>{a.description&&i(O)})}var L=g(N,2);{var V=i=>{var s=Ue(),b=c(s);he(b,()=>a.action),u(s),h(i,s)};U(L,i=>{a.action&&i(V)})}u(S),B(()=>{P(S,1,`flex flex-col items-center justify-center ${e(l)??""} ${m()??""}`),P(x,1,`${e(C)??""} font-medium text-muted-foreground text-center`),J(H,a.title)}),h(K,S),te()}var Fe=w('<button type="button" class="w-7 h-7 bg-accent text-white rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-200 active:scale-90"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg></button>'),Me=ve('<svg class="w-[18px] h-[18px]" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'),je=w('<div class="flex items-center justify-between pt-2 border-t border-neutral-200 dark:border-neutral-800 opacity-100 transition-opacity duration-200"><div class="flex gap-1"><!> <!></div> <button type="button" class="px-[18px] py-2 bg-accent text-white rounded-[18px] font-semibold text-[14px] transition-all duration-150 active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed"> </button></div>'),Ie=w('<div class="mb-8"><div class="flex gap-2.5 items-end max-md:items-start"><!> <div class="flex-1 flex flex-col gap-2"><div><input type="file" accept="image/*" class="hidden"/> <textarea placeholder="Share your thoughts..." rows="1"></textarea> <!> <!></div></div></div></div>');function Xe(K,a){ee(a,!0);let o=I(""),m=I(!1),l=I(!1),f,C,F=I(fe([]));const S=new _e(D),z=ye(S);let M=I(!1);const x=k(()=>e(o).trim().length>0);async function H(){if(!(!D.$currentUser||!e(o).trim())){d(m,!0);try{const t=a.article.reply();if(t.content=e(o),await t.publish(),t.publishStatus==="error"){const v=t.publishError?.relayErrors||{},E=Object.entries(v).map(([_,j])=>`${_}: ${j}`).join(`
`);a.onError(`Failed to publish:
${E||"Unknown error"}`);return}d(o,""),d(l,!1),d(F,[],!0)}catch(t){const r=t instanceof Error?t.message:"Failed to publish comment";a.onError(r)}finally{d(m,!1)}}}function N(){d(l,!0)}function O(){setTimeout(()=>{e(o).trim()||d(l,!1)},100)}function L(){if(!f)return;f.style.height="auto";const t=Math.min(150,Math.max(20,f.scrollHeight));f.style.height=t+"px"}async function V(t){if(!t.type.startsWith("image/")){G.error("Please select an image file");return}d(M,!0);try{await z.upload(t,{fallbackServer:"https://blossom.primal.net"}),z.result?.url&&(i(z.result.url),G.success("Image uploaded"))}catch(r){console.error("Upload failed:",r),G.error("Failed to upload image")}finally{d(M,!1)}}function i(t){const r=f;if(!r)return;const v=r.selectionStart,E=r.selectionEnd,_=`
${t}
`;d(o,e(o).slice(0,v)+_+e(o).slice(E)),setTimeout(()=>{r.selectionStart=r.selectionEnd=v+_.length,r.focus(),L()},0)}function s(t){const r=t.target,v=r.files?.[0];v&&V(v),r.value=""}function b(){C?.click()}var Q=me(),re=pe(Q);{var ae=t=>{var r=Ie(),v=c(r),E=c(v);{let n=k(()=>e(l)?"w-9 h-9":"w-8 h-8");ke(E,{get pubkey(){return D.$currentUser.pubkey},variant:"avatar",get avatarSize(){return e(n)},class:"transition-all duration-300 max-md:mt-0.5"})}var _=g(E,2),j=c(_),W=c(j);W.__change=s,$(W,n=>C=n,()=>C);var p=g(W,2);ge(p),p.__input=L,$(p,n=>f=n,()=>f);var R=g(p,2);{var oe=n=>{var y=Fe();y.__click=H,B(()=>y.disabled=e(m)),h(n,y)};U(R,n=>{e(x)&&!e(l)&&n(oe)})}var ne=g(R,2);{var se=n=>{var y=je(),q=c(y),X=c(q);{let A=k(()=>e(m)||e(M));we(X,{type:"button",variant:"ghost",size:"icon",onclick:b,get disabled(){return e(A)},class:"h-8 w-8",children:(de,Be)=>{var ce=Me();h(de,ce)},$$slots:{default:!0}})}var ie=g(X,2);Se(ie,{get disabled(){return e(m)},get selectedPubkeys(){return e(F)},set selectedPubkeys(A){d(F,A,!0)}}),u(q);var T=g(q,2);T.__click=H;var le=c(T,!0);u(T),u(y),B(()=>{T.disabled=!e(x)||e(m),J(le,e(m)?"Posting...":"Comment")}),h(n,y)};U(ne,n=>{e(l)&&n(se)})}u(j),u(_),u(v),u(r),B(()=>{P(j,1,`bg-neutral-50 dark:bg-card border border rounded-[18px] ${e(l)?"rounded-[14px] p-3":"py-2.5 px-3.5"} transition-all duration-300 ${e(l)?"border-neutral-300 dark:border-neutral-700":"border-neutral-200 dark:border-neutral-800"} flex ${e(l)?"flex-col":"items-center"} gap-2`),p.disabled=e(m),P(p,1,`w-full bg-transparent text-foreground placeholder-neutral-500 resize-none focus:outline-none text-[15px] leading-[1.4] transition-all duration-300 ${e(l)?"max-h-[150px]":"max-h-9"} overflow-hidden`)}),Y("focus",p,N),Y("blur",p,O),be(p,()=>e(o),n=>d(o,n)),h(t,r)};U(re,t=>{D.$currentUser&&t(ae)})}h(K,Q),te()}ue(["change","input","click"]);export{Xe as C,Re as E};
