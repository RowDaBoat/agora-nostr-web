import"./DsnmJJEf.js";import{p as Ie,c as G,f as h,e as t,h as Me,i as C,k as s,j as o,r as a,g as e,a as pe,t as k,l as c,u as Ne,b as ke,s as P,L as A,Q as z,d as rt}from"./UP8uQ6W_.js";import{i as ie}from"./_gFmmxLT.js";import{e as Ee,i as Ue}from"./DA17f6bB.js";import{c as D}from"./BjHSVvfl.js";import{s as Se,a as Fe}from"./B2G7F-H5.js";import{n as $e,f as je}from"./CnpwhG0Y.js";import{t as ne}from"./BeJK5XQO.js";import{M as Be,b as Je,c as Qe,R as Ae,d as Ve,e as qe,f as Ge}from"./5_jRFLjB.js";import{D as He,a as We}from"./8MhEYoCQ.js";import{D as Xe}from"./BOdE5gG2.js";import{D as Ye,a as Ze}from"./DE0IEdZF.js";import{B as _e}from"./BgcVqX2P.js";import{p as et}from"./B36lUvow.js";import{R as ze}from"./DcUGv5_5.js";import{r as Ke}from"./BUa9uPHk.js";import{a as Te}from"./B1i_fleE.js";import{T as Le}from"./mZotqJh9.js";import{$ as tt}from"./D5Dopks2.js";import{I as Oe}from"./CT5oYcwn.js";import{D as at}from"./jJGSuslB.js";var ot=C('<div class="invisible group-hover:visible absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-card border border-border rounded-lg shadow-xl z-50 w-64 text-xs"><div class="font-semibold text-foreground mb-1"> </div> <div class="text-muted-foreground"> </div> <div class="text-muted-foreground mt-1 break-all"> </div></div>'),st=C('<div class="flex items-center gap-1.5 px-2 py-1 bg-muted/50 rounded text-xs text-muted-foreground group relative"><!> <span class="truncate max-w-[120px]"> </span> <!></div>'),lt=C('<div class="text-xs text-muted-foreground truncate"> </div>'),nt=C('<div class="flex items-center gap-2 px-3 py-2 bg-muted/50 rounded-lg text-sm text-muted-foreground hover:bg-muted transition-colors"><!> <div class="flex-1 min-w-0"><div class="font-medium text-foreground truncate"> </div> <!></div></div>');function it(Pe,i){Ie(i,!0);const d=et(i,"variant",3,"default"),we=pe(()=>i.relay.connectivity.nip11),me=pe(()=>e(we)?.name||new URL(i.relay.url).hostname),de=pe(()=>e(we)?.description);var B=G(),O=h(B);{var K=b=>{var N=st(),re=s(N);ze(re,{get relayUrl(){return i.relay.url},size:"xs"});var H=o(re,2),ae=s(H,!0);a(H);var be=o(H,2);{var ge=oe=>{var M=ot(),$=s(M),ve=s($,!0);a($);var ue=o($,2),fe=s(ue,!0);a(ue);var W=o(ue,2),De=s(W,!0);a(W),a(M),k(()=>{c(ve,e(me)),c(fe,e(de)),c(De,i.relay.url)}),t(oe,M)};ie(be,oe=>{e(de)&&oe(ge)})}a(N),k(()=>c(ae,e(me))),t(b,N)},V=b=>{var N=nt(),re=s(N);ze(re,{get relayUrl(){return i.relay.url},size:"md"});var H=o(re,2),ae=s(H),be=s(ae,!0);a(ae);var ge=o(ae,2);{var oe=M=>{var $=lt(),ve=s($,!0);a($),k(()=>c(ve,e(de))),t(M,$)};ie(ge,M=>{e(de)&&M(oe)})}a(H),a(N),k(()=>c(be,e(me))),t(b,N)};ie(O,b=>{d()==="compact"?b(K):b(V,!1)})}t(Pe,B),Me()}var dt=C("<!> <!>",1),vt=C('<label class="flex items-center gap-3 p-3 border border-border rounded-lg hover:bg-muted cursor-pointer transition-colors"><input type="radio" name="reportType" class="w-4 h-4"/> <span class="text-sm"> </span></label>'),ut=C('<!> <div class="space-y-4 py-4"><div><label class="text-sm font-medium mb-2 block"> </label> <div class="space-y-2"></div></div> <div><label for="report-additional-info" class="text-sm font-medium mb-2 block"> </label> <!></div> <div class="p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg"><p class="text-sm text-yellow-600 dark:text-yellow-400"> </p></div></div> <div class="flex gap-3 justify-end"><!> <!></div>',1),ct=C("<!> <!>",1),pt=C('<label class="flex items-center gap-3 p-3 border border-border rounded-lg hover:bg-muted cursor-pointer transition-colors"><input type="radio" name="reportType" class="w-4 h-4"/> <span class="text-sm"> </span></label>'),ft=C('<div class="flex gap-3"><!> <!></div>'),_t=C('<!> <div class="space-y-4 py-4 px-4"><div><label class="text-sm font-medium mb-2 block"> </label> <div class="space-y-2"></div></div> <div><label for="report-additional-info" class="text-sm font-medium mb-2 block"> </label> <!></div> <div class="p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg"><p class="text-sm text-yellow-600 dark:text-yellow-400"> </p></div></div> <!>',1);function mt(Pe,i){Ie(i,!0);const d=()=>Fe(tt,"$t",we),[we,me]=Se(),de=[],B=new Be("(min-width: 768px)");let O=et(i,"open",7),K=ke(""),V=ke(""),b=ke(!1);const N=[{value:"nudity",labelKey:"report.types.nudity"},{value:"malware",labelKey:"report.types.malware"},{value:"profanity",labelKey:"report.types.profanity"},{value:"illegal",labelKey:"report.types.illegal"},{value:"spam",labelKey:"report.types.spam"},{value:"impersonation",labelKey:"report.types.impersonation"},{value:"other",labelKey:"report.types.other"}];async function re(){if(!e(K)){ne.error(d()("report.errors.selectType"));return}if(!$e.activeUser){ne.error(d()("report.errors.notLoggedIn"));return}try{P(b,!0);const $=new je($e);$.kind=1984,$.tag(i.target,e(K)),e(V).trim()&&($.content=e(V).trim()),await $.publish(),ne.success(d()("report.success")),i.onClose(),P(K,""),P(V,"")}catch($){console.error("Failed to submit report:",$),ne.error(d()("report.errors.failed"))}finally{P(b,!1)}}function H(){e(b)||(P(K,""),P(V,""),i.onClose())}Ne(()=>{O()||H()});var ae=G(),be=h(ae);{var ge=M=>{var $=G(),ve=h($);D(ve,()=>Ae,(ue,fe)=>{fe(ue,{get open(){return O()},set open(W){O(W)},children:(W,De)=>{var xe=G(),r=h(xe);D(r,()=>Je,(w,U)=>{U(w,{class:"max-w-md",children:(X,ce)=>{var E=ut(),Y=h(E);D(Y,()=>Ye,(f,l)=>{l(f,{children:(n,v)=>{var p=dt(),u=h(p);D(u,()=>Qe,(m,y)=>{y(m,{children:(j,ye)=>{A();var he=z();k(le=>c(he,le),[()=>d()("report.title")]),t(j,he)},$$slots:{default:!0}})});var _=o(u,2);D(_,()=>He,(m,y)=>{y(m,{children:(j,ye)=>{A();var he=z();k(le=>c(he,le),[()=>d()("report.description")]),t(j,he)},$$slots:{default:!0}})}),t(n,p)},$$slots:{default:!0}})});var S=o(Y,2),J=s(S),Q=s(J),se=s(Q,!0);a(Q);var Z=o(Q,2);Ee(Z,21,()=>N,Ue,(f,l)=>{var n=vt(),v=s(n);Ke(v);var p,u=o(v,2),_=s(u,!0);a(u),a(n),k(m=>{v.disabled=e(b),p!==(p=e(l).value)&&(v.value=(v.__value=e(l).value)??""),c(_,m)},[()=>d()(e(l).labelKey)]),Te(de,[],v,()=>(e(l).value,e(K)),m=>P(K,m)),t(f,n)}),a(Z),a(J);var ee=o(J,2),F=s(ee),R=s(F);a(F);var I=o(F,2);{let f=pe(()=>d()("report.additionalInfoPlaceholder"));Le(I,{id:"report-additional-info",get placeholder(){return e(f)},get disabled(){return e(b)},class:"resize-none",rows:3,get value(){return e(V)},set value(l){P(V,l,!0)}})}a(ee);var T=o(ee,2),q=s(T),te=s(q,!0);a(q),a(T),a(S);var L=o(S,2),g=s(L);_e(g,{variant:"outline",onclick:H,get disabled(){return e(b)},children:(f,l)=>{A();var n=z();k(v=>c(n,v),[()=>d()("common.cancel")]),t(f,n)},$$slots:{default:!0}});var x=o(g,2);{let f=pe(()=>!e(K)||e(b));_e(x,{onclick:re,get disabled(){return e(f)},variant:"destructive",children:(l,n)=>{var v=G(),p=h(v);{var u=m=>{var y=z();k(j=>c(y,j),[()=>d()("report.submitting")]),t(m,y)},_=m=>{var y=z();k(j=>c(y,j),[()=>d()("report.submit")]),t(m,y)};ie(p,m=>{e(b)?m(u):m(_,!1)})}t(l,v)},$$slots:{default:!0}})}a(L),k((f,l,n,v)=>{c(se,f),c(R,`${l??""} ${n??""}`),c(te,v)},[()=>d()("report.selectReason"),()=>d()("report.additionalInfo"),()=>d()("common.optional"),()=>d()("report.warning")]),t(X,E)},$$slots:{default:!0}})}),t(W,xe)},$$slots:{default:!0}})}),t(M,$)},oe=M=>{var $=G(),ve=h($);D(ve,()=>Ge,(ue,fe)=>{fe(ue,{get open(){return O()},set open(W){O(W)},children:(W,De)=>{var xe=G(),r=h(xe);D(r,()=>Ve,(w,U)=>{U(w,{children:(X,ce)=>{var E=_t(),Y=h(E);D(Y,()=>Ze,(g,x)=>{x(g,{class:"text-left",children:(f,l)=>{var n=ct(),v=h(n);D(v,()=>qe,(u,_)=>{_(u,{children:(m,y)=>{A();var j=z();k(ye=>c(j,ye),[()=>d()("report.title")]),t(m,j)},$$slots:{default:!0}})});var p=o(v,2);D(p,()=>We,(u,_)=>{_(u,{children:(m,y)=>{A();var j=z();k(ye=>c(j,ye),[()=>d()("report.description")]),t(m,j)},$$slots:{default:!0}})}),t(f,n)},$$slots:{default:!0}})});var S=o(Y,2),J=s(S),Q=s(J),se=s(Q,!0);a(Q);var Z=o(Q,2);Ee(Z,21,()=>N,Ue,(g,x)=>{var f=pt(),l=s(f);Ke(l);var n,v=o(l,2),p=s(v,!0);a(v),a(f),k(u=>{l.disabled=e(b),n!==(n=e(x).value)&&(l.value=(l.__value=e(x).value)??""),c(p,u)},[()=>d()(e(x).labelKey)]),Te(de,[],l,()=>(e(x).value,e(K)),u=>P(K,u)),t(g,f)}),a(Z),a(J);var ee=o(J,2),F=s(ee),R=s(F);a(F);var I=o(F,2);{let g=pe(()=>d()("report.additionalInfoPlaceholder"));Le(I,{id:"report-additional-info",get placeholder(){return e(g)},get disabled(){return e(b)},class:"resize-none",rows:3,get value(){return e(V)},set value(x){P(V,x,!0)}})}a(ee);var T=o(ee,2),q=s(T),te=s(q,!0);a(q),a(T),a(S);var L=o(S,2);D(L,()=>Xe,(g,x)=>{x(g,{class:"pt-2",children:(f,l)=>{var n=ft(),v=s(n);_e(v,{variant:"outline",onclick:H,get disabled(){return e(b)},class:"flex-1",children:(u,_)=>{A();var m=z();k(y=>c(m,y),[()=>d()("common.cancel")]),t(u,m)},$$slots:{default:!0}});var p=o(v,2);{let u=pe(()=>!e(K)||e(b));_e(p,{onclick:re,get disabled(){return e(u)},variant:"destructive",class:"flex-1",children:(_,m)=>{var y=G(),j=h(y);{var ye=le=>{var Re=z();k(Ce=>c(Re,Ce),[()=>d()("report.submitting")]),t(le,Re)},he=le=>{var Re=z();k(Ce=>c(Re,Ce),[()=>d()("report.submit")]),t(le,Re)};ie(j,le=>{e(b)?le(ye):le(he,!1)})}t(_,y)},$$slots:{default:!0}})}a(n),t(f,n)},$$slots:{default:!0}})}),k((g,x,f,l)=>{c(se,g),c(R,`${x??""} ${f??""}`),c(te,l)},[()=>d()("report.selectReason"),()=>d()("report.additionalInfo"),()=>d()("common.optional"),()=>d()("report.warning")]),t(X,E)},$$slots:{default:!0}})}),t(W,xe)},$$slots:{default:!0}})}),t(M,$)};ie(be,M=>{B.current?M(ge):M(oe,!1)})}t(Pe,ae),Me(),me()}var bt=C('<div class="border-t border-border mt-1 pt-1"><div class="px-4 py-2 text-xs text-muted-foreground"> </div></div>'),gt=C('<div class="border-t border-border mt-1 pt-1"><div class="px-4 py-2 text-xs text-muted-foreground font-medium"> </div> <div class="px-2 pb-2 space-y-1"></div></div>'),xt=C('<div class="absolute right-0 mt-1 w-72 bg-popover border border-border rounded-lg shadow-lg z-10 max-h-96 overflow-y-auto"><button class="w-full px-4 py-3 text-left text-sm text-foreground hover:bg-muted transition-colors first:rounded-t-lg flex items-center gap-3" type="button"><!> </button> <button class="w-full px-4 py-3 text-left text-sm text-foreground hover:bg-muted transition-colors flex items-center gap-3" type="button"><!> </button> <div class="border-t border-border my-1"></div> <button class="w-full px-4 py-2 text-left text-sm text-foreground hover:bg-muted transition-colors" type="button">Copy author (nprofile)</button> <button class="w-full px-4 py-2 text-left text-sm text-foreground hover:bg-muted transition-colors" type="button">Copy ID (nevent)</button> <button class="w-full px-4 py-2 text-left text-sm text-foreground hover:bg-muted transition-colors" type="button">View raw event</button> <!></div>'),yt=C("<!> <!>",1),ht=C("<!> <!>",1),$t=C('<!> <div class="flex-1 overflow-auto bg-muted/50 rounded-lg p-4 font-mono text-sm"><pre class="whitespace-pre-wrap break-words"> </pre></div> <!>',1),wt=C("<!> <!>",1),kt=C("<!> <!>",1),Pt=C('<!> <div class="px-4 flex-1 overflow-auto bg-muted/50 rounded-lg p-4 font-mono text-sm"><pre class="whitespace-pre-wrap break-words"> </pre></div> <!>',1),Dt=C('<div class="relative flex-shrink-0"><button class="p-1 hover:bg-muted rounded-full transition-colors" type="button" aria-label="More options"><svg class="w-5 h-5 text-muted-foreground" fill="currentColor" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></button> <!></div> <!> <!>',1);function Gt(Pe,i){Ie(i,!0);const d=()=>Fe(tt,"$t",we),[we,me]=Se(),de=new Be("(min-width: 768px)");let B=ke(!1),O=ke(!1),K=ke(!1);const V=$e.$subscribe(()=>$e.$currentUser?.pubkey?{filters:[{kinds:[1e4],authors:[$e.$currentUser.pubkey],limit:1}],bufferMs:100}:void 0),b=pe(()=>{const r=V.events[0];return!r||!i.event.author?!1:r.tags.some(w=>w[0]==="p"&&w[1]===i.event.author.pubkey)});async function N(r,w){try{await navigator.clipboard.writeText(r),ne.success(`Copied ${w}`)}catch(U){console.error("Failed to copy:",U),ne.error(`Failed to copy ${w}`)}P(B,!1)}function re(){const r=i.event.author.nprofile;N(r,"author nprofile")}function H(){const r=i.event.encode();N(r,"event ID")}function ae(){P(B,!1),P(O,!0)}async function be(){if(!(!$e.$currentUser?.pubkey||!i.event.author))try{let r=V.events[0];r||(r=new je($e),r.kind=1e4,r.content="",r.tags=[]);const w=i.event.author.pubkey;if(e(b)?(r.tags=r.tags.filter(U=>!(U[0]==="p"&&U[1]===w)),ne.success("User unmuted")):(r.tags.push(["p",w]),ne.success("User muted")),await r.sign(),await r.publishReplaceable(),r.publishStatus==="error"){const X=r.publishError?.relayErrors||{},ce=Object.entries(X).map(([E,Y])=>`${E}: ${Y}`).join(`
`);ne.error(`Failed to publish:
${ce||"Unknown error"}`);return}P(B,!1)}catch(r){console.error("Failed to toggle mute:",r),ne.error(`Failed to ${e(b)?"unmute":"mute"} user: ${r instanceof Error?r.message:"Unknown error"}`)}}function ge(){P(K,!0),P(B,!1)}Ne(()=>{if(!e(B))return;const r=()=>{P(B,!1)};return document.addEventListener("click",r),()=>document.removeEventListener("click",r)});var oe=Dt(),M=h(oe),$=s(M);$.__click=r=>{r.stopPropagation(),P(B,!e(B))};var ve=o($,2);{var ue=r=>{var w=xt();w.__click=R=>R.stopPropagation();var U=s(w);U.__click=be;var X=s(U);{let R=pe(()=>e(b)?"speaker":"speaker-muted");Oe(X,{get name(){return e(R)},size:"md",class:"text-red-500"})}var ce=o(X);a(U);var E=o(U,2);E.__click=ge;var Y=s(E);Oe(Y,{name:"alert",size:"md",class:"text-yellow-500"});var S=o(Y);a(E);var J=o(E,4);J.__click=re;var Q=o(J,2);Q.__click=H;var se=o(Q,2);se.__click=ae;var Z=o(se,2);{var ee=R=>{var I=bt(),T=s(I),q=s(T,!0);a(T),a(I),k(()=>c(q,i.event.relay.url)),t(R,I)},F=R=>{var I=G(),T=h(I);{var q=te=>{var L=gt(),g=s(L),x=s(g);a(g);var f=o(g,2);Ee(f,21,()=>i.event.onRelays,l=>l.url,(l,n)=>{it(l,{get relay(){return e(n)},variant:"compact"})}),a(f),a(L),k(()=>c(x,`Seen on ${i.event.onRelays.length??""} relay${i.event.onRelays.length===1?"":"s"}`)),t(te,L)};ie(T,te=>{i.event.onRelays&&i.event.onRelays.length>0&&te(q)},!0)}t(R,I)};ie(Z,R=>{i.event.relay?.url?R(ee):R(F,!1)})}a(w),k((R,I)=>{c(ce,` ${R??""}`),c(S,` ${I??""}`)},[()=>e(b)?d()("userDropdown.unmute"):d()("userDropdown.mute"),()=>d()("noteDropdown.report")]),t(r,w)};ie(ve,r=>{e(B)&&r(ue)})}a(M);var fe=o(M,2);{var W=r=>{var w=G(),U=h(w);D(U,()=>Ae,(X,ce)=>{ce(X,{get open(){return e(O)},set open(E){P(O,E,!0)},children:(E,Y)=>{var S=G(),J=h(S);D(J,()=>Je,(Q,se)=>{se(Q,{class:"max-w-4xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:(Z,ee)=>{var F=$t(),R=h(F);D(R,()=>Ye,(L,g)=>{g(L,{children:(x,f)=>{var l=yt(),n=h(l);D(n,()=>Qe,(p,u)=>{u(p,{children:(_,m)=>{A();var y=z("Raw Event");t(_,y)},$$slots:{default:!0}})});var v=o(n,2);D(v,()=>He,(p,u)=>{u(p,{children:(_,m)=>{A();var y=z("JSON representation of this Nostr event");t(_,y)},$$slots:{default:!0}})}),t(x,l)},$$slots:{default:!0}})});var I=o(R,2),T=s(I),q=s(T,!0);a(T),a(I);var te=o(I,2);D(te,()=>at,(L,g)=>{g(L,{class:"flex justify-end gap-2",children:(x,f)=>{var l=ht(),n=h(l);_e(n,{variant:"outline",onclick:()=>N(i.event.inspect,"raw event"),children:(p,u)=>{A();var _=z("Copy to Clipboard");t(p,_)},$$slots:{default:!0}});var v=o(n,2);_e(v,{onclick:()=>P(O,!1),children:(p,u)=>{A();var _=z("Close");t(p,_)},$$slots:{default:!0}}),t(x,l)},$$slots:{default:!0}})}),k(()=>c(q,i.event.inspect)),t(Z,F)},$$slots:{default:!0}})}),t(E,S)},$$slots:{default:!0}})}),t(r,w)},De=r=>{var w=G(),U=h(w);D(U,()=>Ge,(X,ce)=>{ce(X,{get open(){return e(O)},set open(E){P(O,E,!0)},children:(E,Y)=>{var S=G(),J=h(S);D(J,()=>Ve,(Q,se)=>{se(Q,{children:(Z,ee)=>{var F=Pt(),R=h(F);D(R,()=>Ze,(L,g)=>{g(L,{class:"text-left",children:(x,f)=>{var l=wt(),n=h(l);D(n,()=>qe,(p,u)=>{u(p,{children:(_,m)=>{A();var y=z("Raw Event");t(_,y)},$$slots:{default:!0}})});var v=o(n,2);D(v,()=>We,(p,u)=>{u(p,{children:(_,m)=>{A();var y=z("JSON representation of this Nostr event");t(_,y)},$$slots:{default:!0}})}),t(x,l)},$$slots:{default:!0}})});var I=o(R,2),T=s(I),q=s(T,!0);a(T),a(I);var te=o(I,2);D(te,()=>Xe,(L,g)=>{g(L,{class:"pt-2",children:(x,f)=>{var l=kt(),n=h(l);_e(n,{variant:"outline",onclick:()=>N(i.event.inspect,"raw event"),children:(p,u)=>{A();var _=z("Copy to Clipboard");t(p,_)},$$slots:{default:!0}});var v=o(n,2);_e(v,{onclick:()=>P(O,!1),children:(p,u)=>{A();var _=z("Close");t(p,_)},$$slots:{default:!0}}),t(x,l)},$$slots:{default:!0}})}),k(()=>c(q,i.event.inspect)),t(Z,F)},$$slots:{default:!0}})}),t(E,S)},$$slots:{default:!0}})}),t(r,w)};ie(fe,r=>{de.current?r(W):r(De,!1)})}var xe=o(fe,2);mt(xe,{get target(){return i.event},get open(){return e(K)},onClose:()=>P(K,!1)}),t(Pe,oe),Me(),me()}rt(["click"]);export{Gt as E,mt as R};
