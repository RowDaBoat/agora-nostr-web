import{s as x,a as N,g as e,p as Qe,x as ge,u as ze,e as r,d as n,t as k,c as Xe,r as o,b as w,f as G,y as se}from"./DpkVnRja.js";import{d as Ze,f,a as l,c as xe,s as E,i as ve}from"./DNmf0A2m.js";import{i as g}from"./Btb_Ey2R.js";import{e as he}from"./DD8s4tVe.js";import{a as _e}from"./Danls9zm.js";import{a as O,c as le,b as et}from"./Ci0hv7jC.js";import{b as tt}from"./-Mgh5RB7.js";import{p as we}from"./f_qAQkK6.js";import{g as ye}from"./BFZgCa8b.js";import{n as Y,s as a,r as ie,j as rt,A as ot}from"./QTLWRGLp.js";import{u as ne}from"./ACGw3gZU.js";import{c as Pe}from"./a7XEC-kH.js";import{p as at}from"./Bm7To3ke.js";import{f as st}from"./DGDGar-n.js";import{R as de}from"./HqbGqMNs.js";let Be=N(!1);const Tt={get show(){return e(Be)},set show(q){x(Be,q,!0)}};let Le=N("conversations");const Wt={get selected(){return e(Le)},set(q){x(Le,q,!0)}};var lt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),it=f('<div class="px-2 py-1"><button class="w-full px-3 py-2.5 rounded-lg bg-muted/50 transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div> <svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></button></div> <div class="border-t border-border my-1"></div>',1),nt=ve('<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),dt=f('<button><svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <div class="flex-1"><div class="font-medium text-foreground">Following</div> <div class="text-xs text-muted-foreground">All posts from people you follow</div></div> <!></button>'),vt=f('<div class="border-t border-border my-1"></div>'),ct=f('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),ft=f('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),ut=ve('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),mt=f('<button><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div> <!></button>'),pt=f('<!> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Follow Packs</div> <!></div>',1),gt=f('<div class="text-xs text-muted-foreground truncate"> </div>'),xt=f('<button class="w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <svg class="w-3.5 h-3.5 text-primary flex-shrink-0" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div></button>'),ht=f('<div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium flex items-center justify-between"><span>Favorite Relays</span> <svg class="w-3 h-3 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg></div> <!></div>',1),_t=f('<div class="text-xs text-muted-foreground truncate"> </div>'),wt=ve('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),yt=f('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div> <!></button>'),kt=f('<!> <!> <!> <!> <div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Agoras</div> <!></div> <div class="border-t border-border mt-1"><a href="/relay-feeds" class="block w-full px-4 py-2.5 text-sm text-center text-primary hover:bg-muted transition-colors">Browse Interesting Relays</a></div>',1),bt=f('<img alt=""/>'),Rt=f('<div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),Mt=ve('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>'),Ct=f('<span class="font-medium flex-1 text-left whitespace-nowrap overflow-hidden text-ellipsis"> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',1),Ft=f('<div class="absolute left-0 mt-1 w-64 bg-popover border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),jt=f('<div class="w-80 bg-card border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),zt=f('<div class="relative"><button><!> <!></button>  <!></div>');function Yt(q,Z){Qe(Z,!0);const ee=we(Z,"active",3,!1),ce=we(Z,"collapsed",3,!1),z=we(Z,"iconOnly",3,!1);let M=N(!1),te=N(null),re=N(ge({top:0,left:0,width:0}));const Ie=w(()=>Y.$sessions?.follows||[]),Ve=w(()=>e(Ie).size>0),ke=w(()=>!!Y.$currentUser&&e(Ve));let oe=N(ge([])),ae=N(ge([]));ze(()=>{const i=st.favoritePacks;if(i.length===0){x(oe,[],!0);return}Promise.all(i.map(t=>Y.fetchEvent(t))).then(t=>{x(oe,t.filter(_=>_!==null),!0)}).catch(t=>{console.error("Failed to fetch favorite packs:",t),x(oe,[],!0)})}),ze(()=>{if(!Y.$currentUser){x(ae,[],!0);return}Y.fetchEvents({kinds:[39089],authors:[Y.$currentUser.pubkey]}).then(i=>{x(ae,Array.from(i),!0)}).catch(i=>{console.error("Failed to fetch user packs:",i),x(ae,[],!0)})});const fe=w(()=>{const i=new Map;for(const t of e(ae))i.set(t.id,t);for(const t of e(oe))i.set(t.id,t);return Array.from(i.values())}),be=w(()=>!a.selectedRelay||T(a.selectedRelay)?null:ne(a.selectedRelay));function T(i){return i?.startsWith("followpack:")??!1}const J=w(()=>{if(!a.selectedRelay||!T(a.selectedRelay))return null;const i=a.selectedRelay.replace("followpack:","");return e(fe).find(t=>t.id===i||t.encode()===i)}),Re=w(()=>T(a.selectedRelay)&&e(J)?e(J).tagValue("title")||"Untitled Pack":a.selectedRelay&&e(be)?.info?.name?e(be).info.name:a.selectedRelay?a.selectedRelay.replace("wss://","").replace("ws://",""):"Following");function Ae(){if(ee()||z()){if(!e(M)&&e(te)&&!z()){const i=e(te).getBoundingClientRect();x(re,{top:i.bottom+4,left:i.left,width:i.width},!0)}x(M,!e(M))}else ye("/")}function Se(i){a.setSelectedRelay(i),x(M,!1)}function He(){a.setSelectedRelay(null),x(M,!1)}function Ee(i){a.setSelectedRelay(`followpack:${i}`),x(M,!1)}function Me(){x(M,!1)}var ue=zt();{const i=t=>{var _=kt(),C=G(_);{var I=u=>{const v=w(()=>ne(a.selectedRelay));var b=it(),R=G(b),h=r(R);h.__click=()=>{x(M,!1),ye(`/?relay=${encodeURIComponent(a.selectedRelay)}`)};var y=r(h);de(y,{get relayUrl(){return a.selectedRelay},size:"md"});var p=n(y,2),c=r(p),D=r(c,!0);o(c);var A=n(c,2);{var S=F=>{var B=lt(),m=r(B,!0);o(B),k(()=>E(m,e(v).info.description)),l(F,B)};g(A,F=>{e(v).info?.description&&F(S)})}o(p),se(2),o(h),o(R),se(2),k(F=>E(D,F),[()=>e(v).info?.name||a.selectedRelay.replace("wss://","").replace("ws://","")]),l(u,b)};g(C,u=>{a.selectedRelay&&!T(a.selectedRelay)&&!ie?.isFavorite(a.selectedRelay)&&!rt(a.selectedRelay)&&u(I)})}var P=n(C,2);{var d=u=>{var v=dt();v.__click=He;var b=n(r(v),4);{var R=h=>{var y=nt();l(h,y)};g(b,h=>{a.selectedRelay||h(R)})}o(v),k(()=>O(v,1,`w-full px-4 py-3 hover:bg-muted transition-colors text-left flex items-center gap-3 ${a.selectedRelay?"":"bg-muted/50"}`)),l(u,v)};g(P,u=>{e(ke)&&u(d)})}var s=n(P,2);{var V=u=>{var v=pt(),b=G(v);{var R=p=>{var c=vt();l(p,c)};g(b,p=>{e(ke)&&p(R)})}var h=n(b,2),y=n(r(h),2);he(y,17,()=>e(fe),p=>p.id,(p,c)=>{const D=w(()=>e(c).tagValue("title")||"Untitled Pack"),A=w(()=>e(c).tagValue("image")),S=w(()=>e(c).tagValue("description")),F=w(()=>e(c).tags.filter(j=>j[0]==="p").length),B=w(()=>T(a.selectedRelay)&&e(J)?.id===e(c).id);var m=mt();m.__click=()=>Ee(e(c).id);var L=r(m);{var H=j=>{var W=ct();k(()=>le(W,"src",e(A))),l(j,W)},Q=j=>{var W=ft();l(j,W)};g(L,j=>{e(A)?j(H):j(Q,!1)})}var X=n(L,2),pe=r(X),Ye=r(pe,!0);o(pe);var je=n(pe,2),qe=r(je,!0);o(je),o(X);var Je=n(X,2);{var Ke=j=>{var W=ut();l(j,W)};g(Je,j=>{e(B)&&j(Ke)})}o(m),k(()=>{O(m,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${e(B)?"bg-muted/50":""}`),E(Ye,e(D)),E(qe,e(S)||`${e(F)} members`)}),l(p,m)}),o(h),l(u,v)};g(s,u=>{e(fe).length>0&&u(V)})}var $=n(s,2);{var K=u=>{var v=ht(),b=n(G(v),2),R=n(r(b),2);he(R,16,()=>ie.relays,h=>h,(h,y)=>{const p=w(()=>ne(y));var c=xt();c.__click=()=>{x(M,!1),ye(`/?relay=${encodeURIComponent(y)}`)};var D=r(c);de(D,{get relayUrl(){return y},size:"md"});var A=n(D,2),S=r(A),F=r(S),B=r(F,!0);o(F),se(2),o(S);var m=n(S,2);{var L=H=>{var Q=gt(),X=r(Q,!0);o(Q),k(()=>E(X,e(p).info.description)),l(H,Q)};g(m,H=>{e(p).info?.description&&H(L)})}o(A),o(c),k(H=>E(B,H),[()=>e(p).info?.name||y.replace("wss://","").replace("ws://","")]),l(h,c)}),o(b),l(u,v)};g($,u=>{ie&&ie.relays.length>0&&u(K)})}var me=n($,4),Te=n(r(me),2);he(Te,16,()=>ot,u=>u,(u,v)=>{const b=w(()=>ne(v));var R=yt();R.__click=()=>Se(v);var h=r(R);de(h,{get relayUrl(){return v},size:"md"});var y=n(h,2),p=r(y),c=r(p),D=r(c,!0);o(c),se(2),o(p);var A=n(p,2);{var S=m=>{var L=_t(),H=r(L,!0);o(L),k(()=>E(H,e(b).info.description)),l(m,L)};g(A,m=>{e(b).info?.description&&m(S)})}o(y);var F=n(y,2);{var B=m=>{var L=wt();l(m,L)};g(F,m=>{a.selectedRelay===v&&m(B)})}o(R),k(m=>{O(R,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${a.selectedRelay===v?"bg-muted/50":""}`),E(D,m)},[()=>e(b).info?.name||v.replace("wss://","").replace("ws://","")]),l(u,R)}),o(me);var Fe=n(me,2),We=r(Fe);We.__click=()=>x(M,!1),o(Fe),l(t,_)};var U=r(ue);U.__click=Ae;var Ce=r(U);{var Oe=t=>{var _=xe(),C=G(_);{var I=d=>{var s=bt();k(V=>{le(s,"src",V),O(s,1,`${z()?"w-5 h-5":"w-6 h-6"} rounded flex-shrink-0`)},[()=>e(J).tagValue("image")]),l(d,s)},P=d=>{var s=Rt(),V=r(s);o(s),k(()=>{O(s,1,`${z()?"w-5 h-5":"w-6 h-6"} rounded bg-primary flex items-center justify-center flex-shrink-0`),O(V,0,`${z()?"w-3 h-3":"w-4 h-4"} text-foreground`)}),l(d,s)};g(C,d=>{e(J)?.tagValue("image")?d(I):d(P,!1)})}l(t,_)},Ue=t=>{var _=xe(),C=G(_);{var I=d=>{{let s=w(()=>z()?"md":"lg");de(d,{get relayUrl(){return a.selectedRelay},get size(){return e(s)}})}},P=d=>{var s=Mt();k(()=>O(s,0,z()?"w-5 h-5 text-muted-foreground":"w-6 h-6")),l(d,s)};g(C,d=>{a.selectedRelay?d(I):d(P,!1)},!0)}l(t,_)};g(Ce,t=>{T(a.selectedRelay)?t(Oe):t(Ue,!1)})}var $e=n(Ce,2);{var De=t=>{var _=Ct(),C=G(_),I=r(C,!0);o(C);var P=n(C,2);k(()=>{E(I,e(Re)),O(P,0,`w-4 h-4 transition-transform ${e(M)?"rotate-180":""}`)}),l(t,_)};g($e,t=>{!ce()&&!z()&&t(De)})}o(U),tt(U,t=>x(te,t),()=>e(te));var Ge=n(U,2);{var Ne=t=>{var _=xe(),C=G(_);{var I=d=>{var s=Ft(),V=r(s);i(V),o(s),_e(s,($,K)=>Pe?.($,K),()=>Me),l(d,s)},P=d=>{var s=jt(),V=r(s);i(V),o(s),_e(s,$=>at?.($)),_e(s,($,K)=>Pe?.($,K),()=>Me),k(()=>et(s,`position: fixed; top: ${e(re).top??""}px; left: ${e(re).left??""}px; min-width: ${e(re).width??""}px;`)),l(d,s)};g(C,d=>{z()?d(I):d(P,!1)})}l(t,_)};g(Ge,t=>{e(M)&&(ee()||z())&&t(Ne)})}o(ue),k(()=>{O(U,1,z()?"flex items-center justify-center w-8 h-8 rounded-full hover:bg-muted/50 transition-colors":ce()?"flex items-center justify-center p-3 rounded-lg transition-colors w-full "+(ee()?"text-primary bg-primary/10 text-primary":"text-foreground hover:bg-muted/50"):"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors w-full "+(ee()?"text-primary bg-primary/10":"text-foreground hover:bg-muted/50")),le(U,"aria-label",a.selectedRelay?"Change filter":"Change following filter"),le(U,"title",ce()?e(Re):void 0)})}l(q,ue),Xe()}Ze(["click"]);export{Yt as R,Tt as c,Wt as h};
