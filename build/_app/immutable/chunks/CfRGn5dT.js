import"./DsnmJJEf.js";import{p as ze,u as Se,s as y,b as ae,c as ne,f as F,e as l,h as Me,i as T,k as t,g as a,r,j as d,L as ke,a as me,t as I,l as S,M as Be,Q as we,d as Ee,K as Le,P as k,N as Ne}from"./UP8uQ6W_.js";import{i as g}from"./_gFmmxLT.js";import{b as Ce,c as Pe,a as z}from"./BUa9uPHk.js";import{b as fe}from"./CEMA3FH2.js";import{p as q}from"./B36lUvow.js";import{n as M}from"./CnpwhG0Y.js";import{A as ie}from"./BoWL87Fx.js";import{E as Ve}from"./BcbwITVo.js";import{F as Ae}from"./BUVM5Lwt.js";function We(x){if(!x||x.length<8)return"linear-gradient(135deg, hsl(220, 70%, 50%), hsl(280, 70%, 50%))";const e=x.slice(0,4),o=x.slice(4,8),B=parseInt(e,16)%360,N=parseInt(o,16)%360,se=60+parseInt(x.slice(8,10)||"00",16)%20,oe=60+parseInt(x.slice(10,12)||"00",16)%20,le=45+parseInt(x.slice(12,14)||"00",16)%10,U=45+parseInt(x.slice(14,16)||"00",16)%10;return`linear-gradient(135deg, hsl(${B}, ${se}%, ${le}%), hsl(${N}, ${oe}%, ${U}%))`}var je=T('<img alt="Banner" class="w-full h-full object-cover opacity-80"/> <div class="absolute inset-0 bg-gradient-to-b from-transparent to-neutral-900"></div>',1),Fe=Be('<svg class="w-3.5 h-3.5 text-blue-500 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'),Ge=T('<div class="mb-4"><div class="text-sm text-muted-foreground line-clamp-3 leading-relaxed svelte-5mo7x1"><!></div></div>'),Ke=T('<div class="fixed z-50 pointer-events-none animate-in fade-in duration-200 svelte-5mo7x1"><div class="relative pointer-events-auto"><div class="relative w-80 bg-card border border-border rounded-xl shadow-2xl overflow-hidden"><div class="relative h-20"><!></div> <div class="relative px-5 pb-5 -mt-10"><div class="relative inline-block mb-3"><!></div> <div class="mb-3"><h3 class="text-base font-semibold text-foreground flex items-center gap-1.5 mb-0.5"><span class="truncate"> </span> <!></h3> <p class="text-sm text-muted-foreground truncate"><!></p></div> <!> <div class="flex items-center gap-4 mb-4 text-sm border-t border-border pt-3"><div class="flex items-center gap-1.5"><span class="font-medium text-foreground"> </span> <span class="text-muted-foreground">notes</span></div> <div class="flex items-center gap-1.5"><span class="font-medium text-foreground"> </span> <span class="text-muted-foreground">following</span></div></div> <!></div></div></div></div>');function Oe(x,e){ze(e,!0);let o=ae(null);Se(()=>{M.fetchUser(e.pubkey).then(c=>{c?.fetchProfile().then(b=>{y(o,b,!0)})})});const B=me(()=>M.$currentUser?.pubkey===e.pubkey),N=M.$subscribe(()=>e.pubkey&&e.isVisible?{filters:[{kinds:[1],authors:[e.pubkey],limit:100}],bufferMs:100}:void 0),se=M.$subscribe(()=>e.pubkey&&e.isVisible?{filters:[{kinds:[3],authors:[e.pubkey],limit:1}],bufferMs:100}:void 0),oe=me(()=>N.events.filter(c=>!c.tags.some(b=>b[0]==="e")).length),le=me(()=>{const c=se.events[0];return c?c.tags.filter(b=>b[0]==="p").length:0});var U=ne(),be=F(U);{var P=c=>{var b=Ke(),_=t(b),f=t(_),w=t(f),G=t(w);{var K=n=>{var i=je(),s=F(i);ke(2),I(()=>Pe(s,"src",a(o).banner)),l(n,i)};g(G,n=>{a(o)?.banner&&n(K)})}r(w);var _e=d(w,2),ve=t(_e),D=t(ve);ie(D,{get ndk(){return M},get pubkey(){return e.pubkey},class:"w-20 h-20 rounded-full border-4 border-foreground shadow-xl"}),r(ve);var ue=d(ve,2),J=t(ue),X=t(J),ge=t(X,!0);r(X);var xe=d(X,2);{var Y=n=>{var i=Fe();l(n,i)};g(xe,n=>{a(o)?.nip05&&n(Y)})}r(J);var pe=d(J,2),v=t(pe);{var u=n=>{var i=we();I(()=>S(i,a(o).nip05)),l(n,i)},V=n=>{var i=we();I(s=>S(i,`${s??""}...`),[()=>e.pubkey.slice(0,16)]),l(n,i)};g(v,n=>{a(o)?.nip05?n(u):n(V,!1)})}r(pe),r(ue);var H=d(ue,2);{var O=n=>{var i=Ge(),s=t(i),A=t(s);Ve(A,{get content(){return a(o).about},class:"text-muted-foreground"}),r(s),r(i),l(n,i)};g(H,n=>{a(o)?.about&&n(O)})}var h=d(H,2),m=t(h),Q=t(m),R=t(Q,!0);r(Q),ke(2),r(m);var Z=d(m,2),C=t(Z),p=t(C,!0);r(C),ke(2),r(Z),r(h);var $=d(h,2);{var ee=n=>{Ae(n,{get pubkey(){return e.pubkey}})};g($,n=>{a(B)||n(ee)})}r(_e),r(f),r(_),r(b),I(n=>{Ce(b,`left: ${e.position.x??""}px; top: ${e.position.y??""}px;`),Ce(w,n),S(ge,a(o)?.displayName||a(o)?.name||"Anonymous"),S(R,a(oe)),S(p,a(le))},[()=>`background: ${a(o)?.banner?"transparent":We(e.pubkey)}`]),l(c,b)};g(be,c=>{e.isVisible&&c(P)})}l(x,U),Me()}var Qe=T('<button type="button"><!></button>'),Re=T('<button type="button"><!> <p> </p></button>'),qe=T('<button type="button"><!> <div class="flex-1 min-w-0 flex flex-col"><p> </p> <p> </p></div></button>'),De=T("<p> </p>"),Je=T('<button type="button"><!> <div class="flex-1 min-w-0"><p> </p> <!></div></button>'),Xe=T('<div><button type="button" class="flex-shrink-0"><!></button> <div class="flex-1 min-w-0"><button type="button" class="text-left w-full min-w-0"><p> </p></button> <!></div></div>'),Ye=T("<!> <div><!></div>",1);function lt(x,e){ze(e,!0);const o=q(e,"variant",3,"avatar"),B=q(e,"avatarSize",3,"w-10 h-10"),N=q(e,"nameSize",3,"text-base font-semibold"),se=q(e,"handleSize",3,"text-sm text-muted-foreground"),oe=q(e,"bioSize",3,"text-sm text-muted-foreground"),le=q(e,"showHoverCard",3,!0),U=q(e,"class",3,"");let be=ae(void 0),P=ae(null);Se(()=>{M.fetchUser(e.pubkey).then(v=>{y(be,v,!0),v?.fetchProfile().then(u=>{y(P,u,!0)})})});let c=ae(!1),b=ae(Le({x:0,y:0})),_=null,f=ae(null);function w(v){e.onclick?e.onclick(v):window.location.href=`/p/${a(be)?.npub}`}function G(){le()&&(_&&clearTimeout(_),_=setTimeout(()=>{if(a(f)){const v=a(f).getBoundingClientRect(),u=window.innerWidth,V=320,H=16;let O=v.right+H;O+V>u-H&&(O=v.left-V-H);const h=v.top;y(b,{x:O,y:h},!0),y(c,!0)}},500))}function K(){_&&(clearTimeout(_),_=null),_=setTimeout(()=>{y(c,!1)},100)}function _e(){_&&(clearTimeout(_),_=null)}function ve(){y(c,!1)}const D=me(()=>a(P)?.displayName||a(P)?.name||`${e.pubkey?.slice(0,8)}...`),ue=me(()=>a(P)?.name||e.pubkey?.slice(0,8));var J=Ye(),X=F(J);{var ge=v=>{var u=Qe();u.__click=w;var V=t(u);ie(V,{get ndk(){return M},get pubkey(){return e.pubkey},get class(){return`${B()??""} cursor-pointer hover:opacity-80 transition-opacity`}}),r(u),fe(u,H=>y(f,H),()=>a(f)),I(()=>z(u,1,`flex-shrink-0 ${U()??""}`,"svelte-8apr3t")),k("mouseenter",u,G),k("mouseleave",u,K),l(v,u)},xe=v=>{var u=ne(),V=F(u);{var H=h=>{var m=Re();m.__click=w;var Q=t(m);ie(Q,{get ndk(){return M},get pubkey(){return e.pubkey},get class(){return`${B()??""} hover:opacity-80 transition-opacity`}});var R=d(Q,2),Z=t(R,!0);r(R),r(m),fe(m,C=>y(f,C),()=>a(f)),I(()=>{z(m,1,`flex items-center gap-3 cursor-pointer ${U()??""}`,"svelte-8apr3t"),z(R,1,`${N()??""} text-foreground truncate hover:underline flex-1 min-w-0 text-left`,"svelte-8apr3t"),S(Z,a(D))}),k("mouseenter",m,G),k("mouseleave",m,K),l(h,m)},O=h=>{var m=ne(),Q=F(m);{var R=C=>{var p=qe();p.__click=w;var $=t(p);ie($,{get ndk(){return M},get pubkey(){return e.pubkey},get class(){return`${B()??""} hover:opacity-80 transition-opacity flex-shrink-0`}});var ee=d($,2),n=t(ee),i=t(n,!0);r(n);var s=d(n,2),A=t(s);r(s),r(ee),r(p),fe(p,te=>y(f,te),()=>a(f)),I(()=>{z(p,1,`flex items-center gap-3 cursor-pointer text-left w-full ${U()??""}`,"svelte-8apr3t"),z(n,1,`${N()??""} text-foreground truncate hover:underline`,"svelte-8apr3t"),S(i,a(D)),z(s,1,`${se()??""} truncate`,"svelte-8apr3t"),S(A,`@${a(ue)??""}`)}),k("mouseenter",p,G),k("mouseleave",p,K),l(C,p)},Z=C=>{var p=ne(),$=F(p);{var ee=i=>{var s=Je();s.__click=w;var A=t(s);ie(A,{get ndk(){return M},get pubkey(){return e.pubkey},get class(){return`${B()??""} hover:opacity-80 transition-opacity flex-shrink-0`}});var te=d(A,2),W=t(te),E=t(W,!0);r(W);var re=d(W,2);{var he=j=>{var L=De(),de=t(L,!0);r(L),I(()=>{z(L,1,`${oe()??""} truncate line-clamp-2`,"svelte-8apr3t"),S(de,a(P).about)}),l(j,L)};g(re,j=>{a(P)?.about&&j(he)})}r(te),r(s),fe(s,j=>y(f,j),()=>a(f)),I(()=>{z(s,1,`flex items-center gap-3 cursor-pointer text-left w-full ${U()??""}`,"svelte-8apr3t"),z(W,1,`${N()??""} text-foreground truncate hover:underline`,"svelte-8apr3t"),S(E,a(D))}),k("mouseenter",s,G),k("mouseleave",s,K),l(i,s)},n=i=>{var s=ne(),A=F(s);{var te=W=>{var E=Xe(),re=t(E);re.__click=w;var he=t(re);ie(he,{get ndk(){return M},get pubkey(){return e.pubkey},get class(){return`${B()??""} cursor-pointer hover:opacity-80 transition-opacity`}}),r(re);var j=d(re,2),L=t(j);L.__click=w;var de=t(L),Ue=t(de,!0);r(de),r(L);var He=d(L,2);{var Ie=ce=>{var ye=ne(),Te=F(ye);Ne(Te,()=>e.meta),l(ce,ye)};g(He,ce=>{e.meta&&ce(Ie)})}r(j),r(E),fe(E,ce=>y(f,ce),()=>a(f)),I(()=>{z(E,1,`flex items-center gap-3 ${U()??""}`,"svelte-8apr3t"),z(de,1,`${N()??""} text-foreground truncate hover:underline`,"svelte-8apr3t"),S(Ue,a(D))}),k("mouseenter",E,G),k("mouseleave",E,K),l(W,E)};g(A,W=>{o()==="avatar-name-meta"&&W(te)},!0)}l(i,s)};g($,i=>{o()==="avatar-name-bio"?i(ee):i(n,!1)},!0)}l(C,p)};g(Q,C=>{o()==="avatar-name-handle"?C(R):C(Z,!1)},!0)}l(h,m)};g(V,h=>{o()==="avatar-name"?h(H):h(O,!1)},!0)}l(v,u)};g(X,v=>{o()==="avatar"?v(ge):v(xe,!1)})}var Y=d(X,2),pe=t(Y);Oe(pe,{get pubkey(){return e.pubkey},get isVisible(){return a(c)},get position(){return a(b)}}),r(Y),k("mouseenter",Y,_e),k("mouseleave",Y,ve),l(x,J),Me()}Ee(["click"]);export{lt as U,We as g};
