import"./DsnmJJEf.js";import{bd as B,p as G,u as J,s as F,b as Q,g as t,a as _,be as ee,i as p,k as E,N as te,r as q,t as N,e as v,h as L,c as I,f as M,l as V,d as re,j as ae}from"./UP8uQ6W_.js";import{i as O}from"./_gFmmxLT.js";import{c as Y}from"./BjHSVvfl.js";import{a as j,c as T,b as D,d as ne}from"./BUa9uPHk.js";import{p as y}from"./B36lUvow.js";import{H as W}from"./CnpwhG0Y.js";import{e as se}from"./DA17f6bB.js";import{c as ie}from"./D8EaCCWh.js";function le(k){const e=k.slice(0,6),o=`#${e}`,s=parseInt(e.slice(0,2),16),n=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16),l=Math.max(s,n,r)/255,d=Math.min(s,n,r)/255,c=(l+d)/2;let i=0,f=0;if(l!==d){const u=l-d;switch(f=c>.5?u/(2-l-d):u/(l+d),l){case s/255:i=((n/255-r/255)/u+(n<r?6:0))/6;break;case n/255:i=((r/255-s/255)/u+2)/6;break;case r/255:i=((s/255-n/255)/u+4)/6;break}}const C=(i*360+30)%360,h=Math.min(c*100+10,90);return`linear-gradient(135deg, ${o}, hsl(${C}, ${f*100}%, ${h}%))`}const Z=Symbol("user-profile"),oe="ndk";function ce(k){if(k)return k;const e=B(oe);if(!e)throw new Error("NDK not found. Either provide an `ndk` prop or ensure NDK is set in context via setContext('ndk', ndk) in a parent component.");return e}var ue=p("<div><!></div>");function ve(k,e){G(e,!0);let o=y(e,"class",3,"");const s=ce(e.ndk),n=_(()=>{if(e.user)return e.user;if(e.pubkey)try{return s.getUser({pubkey:e.pubkey})}catch{return null}return null});let r=Q(null);J(()=>{e.profile!==void 0?F(r,null):t(n)?F(r,W(()=>({user:t(n)}),s),!0):F(r,null)});const l=_(()=>e.profile!==void 0?e.profile:t(r)?.profile);ee(Z,{get ndk(){return s},get user(){return e.user},get ndkUser(){return t(n)},get profile(){return t(l)},get onclick(){return e.onclick}});var c=ue(),i=E(c);te(i,()=>e.children),q(c),N(()=>j(c,1,`inline-block ${o()??""}`)),v(k,c),L()}var de=p("<img/>"),fe=p("<div> </div>");function X(k,e){G(e,!0);let o=y(e,"size",3,48),s=y(e,"class",3,"");const n=B(Z),r=_(()=>e.ndk||n?.ndk),l=_(()=>e.user||n?.ndkUser||(e.pubkey&&t(r)?t(r).getUser({pubkey:e.pubkey}):void 0));let d=Q(null);J(()=>{e.profile!==void 0||n?.profile!==void 0?F(d,null):t(l)&&t(r)?F(d,W(()=>({user:t(l)}),t(r)),!0):F(d,null)});const c=_(()=>e.profile!==void 0?e.profile:n?.profile!==void 0?n.profile:t(d)?.profile),i=_(()=>t(c)?.picture||e.fallback),f=_(()=>e.alt||t(c)?.displayName||t(c)?.name||"Anon"),C=_(()=>t(l)?.pubkey?le(t(l).pubkey):"var(--color-primary)");var h=I(),u=M(h);{var m=x=>{var a=de();N(()=>{T(a,"src",t(i)),T(a,"alt",t(f)),j(a,1,`rounded-full object-cover block shrink-0 ${s()??""}`),D(a,`width: ${o()??""}px; height: ${o()??""}px;`)}),v(x,a)},g=x=>{var a=fe(),b=E(a,!0);q(a),N(z=>{j(a,1,`rounded-full flex items-center justify-center text-primary-foreground font-semibold text-sm shrink-0 ${s()??""}`),D(a,`width: ${o()??""}px; height: ${o()??""}px; background: ${t(C)??""}; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);`),V(b,z)},[()=>t(f).slice(0,2).toUpperCase()]),v(x,a)};O(u,x=>{t(i)?x(m):x(g,!1)})}v(k,h),L()}var ge=p('<button type="button" class="avatar-group-button svelte-q5lcpr"><!></button>'),me=p('<div class="avatar-group-item svelte-q5lcpr"><!></div>'),ke=p('<button type="button" class="avatar-group-overflow-button svelte-q5lcpr"> </button>'),be=p('<div class="avatar-group-overflow-content svelte-q5lcpr"> </div>'),_e=p('<div class="avatar-group-overflow svelte-q5lcpr"><!></div>'),he=p('<div role="group" aria-label="User avatars"><!> <!></div>');function Ke(k,e){G(e,!0);let o=y(e,"pubkeys",19,()=>[]),s=y(e,"users",19,()=>[]),n=y(e,"max",3,5),r=y(e,"size",3,40),l=y(e,"spacing",3,"normal"),d=y(e,"class",3,"");const c=_(()=>s().length>0?s():o().map(a=>e.ndk.getUser({pubkey:a}))),i=_(()=>t(c).slice(0,n())),f=_(()=>Math.max(0,t(c).length-n())),h={tight:-8,normal:-12,loose:-6}[l()];var u=he(),m=E(u);se(m,19,()=>t(i),a=>a.pubkey,(a,b,z)=>{var K=me();let R;var S=E(K);{var A=w=>{var P=ge();P.__click=()=>e.onAvatarClick?.(t(b));var $=E(P);X($,{get ndk(){return e.ndk},get user(){return t(b)},get size(){return r()},class:"ring-2 ring-background"}),q(P),v(w,P)},U=w=>{X(w,{get ndk(){return e.ndk},get user(){return t(b)},get size(){return r()},class:"ring-2 ring-background"})};O(S,w=>{e.onAvatarClick?w(A):w(U,!1)})}q(K),N(()=>R=D(K,"",R,{"margin-left":t(z)===0?"0":`${h}px`,"z-index":t(i).length-t(z)})),v(a,K)});var g=ae(m,2);{var x=a=>{var b=_e();let z;var K=E(b);{var R=A=>{var U=ke();U.__click=function(...P){e.onOverflowClick?.apply(this,P)};var w=E(U);q(U),N(()=>V(w,`+${t(f)??""}`)),v(A,U)},S=A=>{var U=be(),w=E(U);q(U),N(()=>V(w,`+${t(f)??""}`)),v(A,U)};O(K,A=>{e.onOverflowClick?A(R):A(S,!1)})}q(b),N(()=>z=D(b,"",z,{"margin-left":`${h??""}px`,width:`${r()??""}px`,height:`${r()??""}px`,"font-size":`${r()*.35}px`,"z-index":0})),v(a,b)};O(g,a=>{t(f)>0&&a(x)})}q(u),N(a=>j(u,1,a,"svelte-q5lcpr"),[()=>ne(ie("avatar-group","flex items-center",d()))]),v(k,u),L()}re(["click"]);const H={Root:ve,Avatar:X};var xe=p("<img/>"),ye=p("<div>?</div>");function Pe(k,e){G(e,!0);let o=y(e,"size",3,48),s=y(e,"class",3,"");const n=_(()=>e.pubkey||e.user?.pubkey);var r=I(),l=M(r);{var d=i=>{var f=I(),C=M(f);Y(C,()=>H.Root,(h,u)=>{u(h,{get ndk(){return e.ndk},get pubkey(){return t(n)},children:(m,g)=>{var x=I(),a=M(x);Y(a,()=>H.Avatar,(b,z)=>{z(b,{get size(){return o()},get class(){return s()}})}),v(m,x)},$$slots:{default:!0}})}),v(i,f)},c=i=>{var f=I(),C=M(f);{var h=m=>{var g=xe();N(()=>{T(g,"src",e.fallback),T(g,"alt",e.alt||"Avatar"),j(g,1,`avatar ${s()??""}`,"svelte-1robf2b"),D(g,`width: ${o()??""}px; height: ${o()??""}px; border-radius: 50%; object-fit: cover;`)}),v(m,g)},u=m=>{var g=ye();N(()=>{j(g,1,`avatar avatar-fallback ${s()??""}`,"svelte-1robf2b"),D(g,`width: ${o()??""}px; height: ${o()??""}px;`)}),v(m,g)};O(C,m=>{e.fallback?m(h):m(u,!1)},!0)}v(i,f)};O(l,i=>{e.ndk&&t(n)?i(d):i(c,!1)})}v(k,r),L()}export{Pe as A,Z as U,Ke as a,X as b,H as c,ce as g};
