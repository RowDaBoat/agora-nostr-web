import{d as U,c as M,a as E,f as S,s as A}from"./CiPFrJr-.js";import{p as O,f as T,c as q,e as n,u as z,r as i,d as w,s as m,b as C,g as t,t as B}from"./CSbKtK4P.js";import{i as D}from"./87vUJtvC.js";import{n as _,f as G}from"./D0X4VYcq.js";import{n as H}from"./BSsXfEb0.js";import{a as I}from"./CGbTV4zP.js";function J(b,o){t(o)&&(window.location.href=`/p/${t(o)}`)}async function K(b,o,a,s,r){if(!(!o||!t(a).trim())){m(s,!0);try{const e=r.article.reply();if(e.content=t(a),await e.publish(),e.publishStatus==="error"){const v=e.publishError?.relayErrors||{},p=Object.entries(v).map(([d,c])=>`${d}: ${c}`).join(`
`);r.onError(`Failed to publish:
${p||"Unknown error"}`);return}r.onCommentPublished(e),m(a,"")}catch(e){const l=e instanceof Error?e.message:"Failed to publish comment";r.onError(l)}finally{m(s,!1)}}}var L=S('<div class="mb-8"><div class="flex gap-3"><button type="button" class="flex-shrink-0"><!></button> <div class="flex-1 flex flex-col gap-2"><div class="p-3 bg-neutral-50 dark:bg-card border border rounded-lg"><!></div> <div class="flex justify-end"><button type="button" class="px-4 py-2 bg-card dark:bg-white text-foreground dark:text-black rounded-full hover:bg-muted dark:hover:bg-neutral-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium"> </button></div></div></div></div>');function Y(b,o){O(o,!0);let a=C(""),s=C(!1);const r=_.$currentUser;_.$fetchProfile(()=>r?.pubkey);const e=z(()=>r?H.npubEncode(r.pubkey):"");var l=M(),v=T(l);{var p=d=>{var c=L(),y=n(c),u=n(y);u.__click=[J,e];var P=n(u);G(P,{get ndk(){return _},get pubkey(){return r.pubkey},class:"w-10 h-10 cursor-pointer hover:opacity-80 transition-opacity"}),i(u);var k=w(u,2),g=n(k),j=n(g);I(j,{placeholder:"Share your thoughts...",get disabled(){return t(s)},get value(){return t(a)},set value(h){m(a,h,!0)}}),i(g);var x=w(g,2),f=n(x);f.__click=[K,r,a,s,o];var F=n(f,!0);i(f),i(x),i(k),i(y),i(c),B(h=>{f.disabled=h,A(F,t(s)?"Posting...":"Comment")},[()=>!t(a).trim()||t(s)]),E(d,c)};D(v,d=>{r&&d(p)})}E(b,l),q()}U(["click"]);export{Y as C};
