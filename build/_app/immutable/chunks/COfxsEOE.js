import"./DsnmJJEf.js";import{u as Te,s as P,b as de,g as t,p as V,bd as pe,a as p,i as N,k as j,r as C,t as T,l as Z,e as i,h as W,c as g,f as m,d as ce,Q as Ue,be as Ge,N as se,aT as Ve,bo as We,j as ie}from"./UP8uQ6W_.js";import{i as y}from"./_gFmmxLT.js";import{e as De,i as Oe}from"./DA17f6bB.js";import{d as ve,a as Y,b as Ke,c as Q}from"./BUa9uPHk.js";import{p as E}from"./B36lUvow.js";import{S as Xe,q as Je,H as je}from"./CnpwhG0Y.js";import{g as qe}from"./C3QbOBEF.js";import{c as re}from"./BjHSVvfl.js";import{U as Ie,g as Qe,b as $e,c as et}from"./BoWL87Fx.js";import{c as oe}from"./D8EaCCWh.js";import{k as tt}from"./COgQ-N07.js";import{b as at}from"./CEMA3FH2.js";const nt={EMOJI_SHORTCODE:/:([a-zA-Z0-9_]+):/g,NOSTR_URI:/nostr:(npub1[a-z0-9]{58}|nprofile1[a-z0-9]+|note1[a-z0-9]{58}|nevent1[a-z0-9]+|naddr1[a-z0-9]+)/gi,HASHTAG:/(^|\s)#([a-zA-Z0-9_\u0080-\uFFFF]+)(?=\s|$|[^\w])/g,MEDIA_FILE:/https?:\/\/[^\s<>"]+\.(jpg|jpeg|png|gif|webp|svg|mp4|webm|mov)(\?[^\s<>"]*)?/gi,YOUTUBE:/https?:\/\/(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})[^\s<>"]*/gi,URL:/https?:\/\/[^\s<>"]+/gi};function He(n){const e=new Map;if(!Array.isArray(n))return console.warn("[buildEmojiMap] Expected tags to be an array, got:",typeof n),e;for(const[r,s,l]of n)r==="emoji"&&s&&l&&e.set(s,l);return e}function rt(n,e){const r=e.get(n);return r?{type:"emoji",content:n,data:r}:{type:"text",content:`:${n}:`}}function it(n){try{const e=n.substring(0,n.indexOf("1")+1);if(Xe.decode(n),e==="npub1")return{type:"npub",content:n,data:n};if(e==="nprofile1")return{type:"nprofile",content:n,data:n};if(e==="note1"||e==="nevent1"||e==="naddr1")return{type:"event-ref",content:n,data:n}}catch{console.warn("[EventContent] Failed to decode Nostr URI:",n)}return{type:"text",content:`nostr:${n}`}}function Ze(n){return/\.(jpg|jpeg|png|gif|webp|svg)(\?|$)/i.test(n)}function ot(n){return/\.(mp4|webm|mov)(\?|$)/i.test(n)}function lt(n){return/youtube\.com|youtu\.be/i.test(n)}function st(n,e){const r=n.match(/^(\s)?#([a-zA-Z0-9_\u0080-\uFFFF]+)$/);if(r){const[,s,l]=r;return s?{type:"hashtag",content:l,data:l}:{type:"hashtag",content:l,data:l}}if(n.startsWith(":")&&n.endsWith(":")){const s=n.slice(1,-1);return rt(s,e)}return n.startsWith("nostr:")?it(n.slice(6)):Ze(n)||ot(n)||lt(n)?{type:"media",content:n}:n.startsWith("http")?{type:"link",content:n}:{type:"text",content:n}}function dt(n){const e=[];for(const r of Object.values(nt)){r.lastIndex=0;let s=r.exec(n);for(;s!==null;)e.push({match:s,index:s.index}),s=r.exec(n)}return e.sort((r,s)=>r.index-s.index)}function vt(n,e){const r=[],s=dt(n);let l=0;for(const{match:v,index:a}of s)if(!(a<l)){if(a>l&&r.push({type:"text",content:n.slice(l,a)}),v[0].match(/^\s?#[a-zA-Z0-9_\u0080-\uFFFF]+$/)){const o=v[0].match(/^(\s)?#([a-zA-Z0-9_\u0080-\uFFFF]+)$/);if(o){const[,c,h]=o;c&&r.push({type:"text",content:c}),r.push({type:"hashtag",content:h,data:h})}}else r.push(st(v[0],e));l=a+v[0].length}return l<n.length&&r.push({type:"text",content:n.slice(l)}),r}function ct(n){const e=[];let r=[];function s(){r.length!==0&&(r.length===1?e.push({type:"media",content:r[0]}):e.push({type:"image-grid",content:"",data:r}),r=[])}for(const l of n)l.type==="media"&&Ze(l.content)?r.push(l.content):(s(),e.push(l));return s(),e}function ft(n,e){return{get segments(){const r=String(n().event?.content??n().content??""),s=n().event,l=s?.tags&&Array.isArray(s.tags)?s.tags.filter(c=>c[0]==="emoji"):n().emojiTags??[],v=r.replace(/\[Image #\d+\]/gi,"").trim(),a=He(l),o=vt(v,a);return ct(o)},get content(){return String(n().event?.content??n().content??"").replace(/\[Image #\d+\]/gi,"").trim()},get emojiMap(){const r=n().event,s=r?.tags&&Array.isArray(r.tags)?r.tags.filter(l=>l[0]==="emoji"):n().emojiTags??[];return He(s)}}}function ut(n,e){const r=Je(e);let s=de(null),l=de(!0),v=de(null);return Te(()=>{const{bech32:a}=n();a&&(P(l,!0),P(v,null),r.fetchEvent(a).then(o=>{o?P(s,o,!0):P(v,"Event not found"),P(l,!1)}).catch(o=>{console.error("Failed to fetch embedded event:",o),P(v,"Failed to load event"),P(l,!1)}))}),{get event(){return t(s)},get loading(){return t(l)},get error(){return t(v)}}}var mt=N("<span> </span>");function Le(n,e){V(e,!0);let r=E(e,"field",3,"displayName"),s=E(e,"size",3,"text-base"),l=E(e,"class",3,""),v=E(e,"truncate",3,!0);const a=pe(Ie),o=p(()=>e.ndk||a?.ndk),c=p(()=>e.user||a?.ndkUser),h=p(()=>{if(t(c))try{return t(c).pubkey}catch{return}});let _=de(null);Te(()=>{e.profile!==void 0||a?.profile!==void 0?P(_,null):t(c)&&t(o)?P(_,je(()=>({user:t(c)}),t(o)),!0):P(_,null)});const d=p(()=>e.profile!==void 0?e.profile:a?.profile!==void 0?a.profile:t(_)?.profile),f=p(()=>{if(!t(d))return t(h)?.slice(0,8)+"..."||"Unknown";if(r()==="name")return t(d).name||t(h)?.slice(0,8)+"...";if(r()==="displayName")return t(d).displayName||t(d).name||t(h)?.slice(0,8)+"...";if(r()==="both"){const b=t(d).displayName||t(d).name,w=t(d).name&&t(d).name!==t(d).displayName?t(d).name:null;return w?`${b} (@${w})`:b||t(h)?.slice(0,8)+"..."}return t(h)?.slice(0,8)+"..."||"Unknown"});var u=mt(),k=j(u,!0);C(u),T(b=>{Y(u,1,b),Z(k,t(f))},[()=>ve(oe(s(),v()&&"truncate inline-block max-w-full",l()))]),i(n,u),W()}var gt=N("<p> </p>");function ht(n,e){V(e,!0);let r=E(e,"class",3,""),s=E(e,"maxLines",3,3);const l=pe(Ie);if(!l)throw new Error("UserProfile.Bio must be used within UserProfile.Root");const v=p(()=>l.profile?.about||"");var a=g(),o=m(a);{var c=h=>{var _=gt(),d=j(_,!0);C(_),T(f=>{Y(_,1,f),Z(d,t(v))},[()=>ve(oe(`line-clamp-${s()}`,r()))]),i(h,_)};y(o,h=>{t(v)&&h(c)})}i(n,a),W()}var _t=N("<span> </span>");function kt(n,e){V(e,!0);let r=E(e,"size",3,"text-sm"),s=E(e,"class",3,"");const l=pe(Ie),v=p(()=>e.ndk||l?.ndk),a=p(()=>e.user||l?.ndkUser);let o=de(null);Te(()=>{e.profile!==void 0||l?.profile!==void 0?P(o,null):t(a)&&t(v)?P(o,je(()=>({user:t(a)}),t(v)),!0):P(o,null)});const c=p(()=>e.profile!==void 0?e.profile:l?.profile!==void 0?l.profile:t(o)?.profile),h=p(()=>t(c)?.[e.field]);var _=g(),d=m(_);{var f=k=>{{let b=p(()=>oe(r(),s()));ht(k,{get class(){return t(b)},get maxLines(){return e.maxLines}})}},u=k=>{var b=g(),w=m(b);{var z=F=>{var A=_t();let U;var S=j(A,!0);C(A),T(M=>{Y(A,1,M),U=Ke(A,"",U,{display:e.maxLines?"-webkit-box":void 0,"-webkit-line-clamp":e.maxLines,"-webkit-box-orient":e.maxLines?"vertical":void 0,overflow:e.maxLines?"hidden":void 0}),Z(S,t(h))},[()=>ve(oe(r(),s()))]),i(F,A)};y(w,F=>{t(h)&&F(z)},!0)}i(k,b)};y(d,k=>{e.field==="about"&&l?k(f):k(u,!1)})}i(n,_),W()}var yt=N('<button type="button"><!></button>');function bt(n,e){V(e,!0);let r=E(e,"class",3,"");const s=je(()=>({user:e.bech32}),e.ndk),l=p(()=>s.profile);function v(){qe(`/p/${e.bech32}`)}function a(d){(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),v())}var o=yt();o.__click=v,o.__keydown=a;var c=j(o);{var h=d=>{var f=Ue();T(u=>Z(f,`@${u??""}...`),[()=>e.bech32.slice(0,8)]),i(d,f)},_=d=>{var f=g(),u=m(f);{var k=b=>{var w=Ue();T(()=>Z(w,`@${(t(l)?.name||t(l)?.displayName||e.bech32)??""}`)),i(b,w)};y(u,b=>{t(l)&&b(k)},!0)}i(d,f)};y(c,d=>{s?.loading?d(h):d(_,!1)})}C(o),T(()=>Y(o,1,`mention ${r()??""}`,"svelte-pcdwx6")),i(n,o),W()}ce(["click","keydown"]);var wt=N('<button type="button"> </button>');function xt(n,e){V(e,!0);let r=E(e,"class",3,"");function s(){e.onclick?e.onclick(e.tag):qe(`/t/${e.tag}`)}function l(o){(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),s())}var v=wt();v.__click=s,v.__keydown=l;var a=j(v);C(v),T(()=>{Y(v,1,`hashtag ${r()??""}`,"svelte-1m8dia2"),Z(a,`#${e.tag??""}`)}),i(n,v),W()}ce(["click","keydown"]);class Et{handlers=new Map;add(e,r){if(Array.isArray(e))for(const s of e)this.handlers.set(s,{component:r,wrapper:null});else{const s=e.kinds||[],l=e.from?e:null;for(const v of s)this.handlers.set(v,{component:r,wrapper:l})}}get(e){if(e!==void 0)return this.handlers.get(e)}has(e){return this.handlers.has(e)}getRegisteredKinds(){return Array.from(this.handlers.keys()).sort((e,r)=>e-r)}clear(){this.handlers.clear()}}const Ye=new Et,Re=Symbol.for("event-card");var pt=N("<article><!></article>");function Nt(n,e){V(e,!0);let r=E(e,"interactive",3,!1),s=E(e,"class",3,"");const l=Qe(e.ndk);Ge(Re,{get ndk(){return l},get event(){return e.event},get threading(){return e.threading},get interactive(){return r()}});function a(){if(r())if(e.onclick)e.onclick();else{const d=e.event.encode();window.location.href=`/e/${d}`}}const o=p(r);var c=pt();c.__click=function(...d){(t(o)?a:void 0)?.apply(this,d)},c.__keydown=function(...d){(t(o)?f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),a())}:void 0)?.apply(this,d)};var h=j(c);{var _=d=>{var f=g(),u=m(f);se(u,()=>e.children),i(d,f)};y(h,d=>{e.children&&d(_)})}C(c),T(d=>{Y(c,1,d),Q(c,"role",t(o)?"button":void 0),Q(c,"tabindex",t(o)?0:void 0)},[()=>ve(oe("relative flex flex-col gap-2",s()))]),i(n,c),W()}ce(["click","keydown"]);var Tt=N("<time> </time>"),Ct=N("<span> </span>");function Ft(n,e){V(e,!0);let r=E(e,"element",3,"span"),s=E(e,"class",3,""),l=de(0);const v=p(()=>{if(t(l),!e.timestamp)return"";const f=new Date(e.timestamp*1e3),k=new Date().getTime()-f.getTime(),b=Math.floor(k/(1e3*60*60));if(b<1){const w=Math.floor(k/6e4);return w<1?"now":`${w}m`}else return b<24?`${b}h`:b<168?`${Math.floor(b/24)}d`:f.toLocaleDateString()}),a=p(()=>e.timestamp?new Date(e.timestamp*1e3).toISOString():void 0);let o;Te(()=>(o=setInterval(()=>{Ve(l)},6e4),()=>{o&&clearInterval(o)})),We(()=>{o&&clearInterval(o)});var c=g(),h=m(c);{var _=f=>{var u=Tt(),k=j(u,!0);C(u),T(b=>{Q(u,"datetime",t(a)),Y(u,1,b),Z(k,t(v))},[()=>ve(oe(s()))]),i(f,u)},d=f=>{var u=Ct(),k=j(u,!0);C(u),T(b=>{Y(u,1,b),Z(k,t(v))},[()=>ve(oe(s()))]),i(f,u)};y(h,f=>{r()==="time"?f(_):f(d,!1)})}i(n,c),W()}var jt=N('<div class="flex flex-col"><!> <!></div>'),Rt=N('<div class="flex items-center gap-2 min-w-0"><!></div>'),zt=N('<header><div class="flex items-center gap-3 flex-1 min-w-0"><!> <div class="flex-1 min-w-0"><!></div></div> <div class="flex items-center gap-3"><!> <!></div></header>');function At(n,e){V(e,!0);let r=E(e,"variant",3,"full"),s=E(e,"showAvatar",3,!0),l=E(e,"showTimestamp",3,!0),v=E(e,"avatarSize",3,"md"),a=E(e,"class",3,"");const o=pe(Re);if(!o)throw new Error("EventCard.Header must be used within EventCard.Root");const c=je(()=>({user:o.event.author}),o.ndk);function h(x){x.stopPropagation()}var _=zt(),d=j(_);d.__click=h;var f=j(d);{var u=x=>{{let L=p(()=>v()==="sm"?32:v()==="md"?40:48);$e(x,{get ndk(){return o.ndk},get user(){return o.event.author},get profile(){return c.profile},get size(){return t(L)},class:"flex-shrink-0"})}};y(f,x=>{s()&&x(u)})}var k=ie(f,2),b=j(k);{var w=x=>{var L=jt(),R=j(L);Le(R,{get ndk(){return o.ndk},get user(){return o.event.author},get profile(){return c.profile},field:"displayName",class:"font-semibold text-[15px] text-foreground truncate"});var I=ie(R,2);kt(I,{get ndk(){return o.ndk},get user(){return o.event.author},get profile(){return c.profile},field:"nip05",class:"text-sm text-muted-foreground truncate"}),C(L),i(x,L)},z=x=>{var L=g(),R=m(L);{var I=X=>{var le=Rt(),K=j(le);re(K,()=>et.Root,(q,ee)=>{ee(q,{get user(){return o.event.author},children:(ge,xe)=>{Le(ge,{get ndk(){return o.ndk},get user(){return o.event.author},get profile(){return c.profile},field:"displayName",class:"font-semibold text-[15px] text-foreground truncate"})},$$slots:{default:!0}})}),C(le),i(X,le)},$=X=>{Le(X,{get ndk(){return o.ndk},get user(){return o.event.author},get profile(){return c.profile},field:"displayName",class:"font-semibold text-[15px] text-foreground truncate"})};y(R,X=>{r()==="compact"?X(I):X($,!1)},!0)}i(x,L)};y(b,x=>{r()==="full"?x(w):x(z,!1)})}C(k),C(d);var F=ie(d,2),A=j(F);{var U=x=>{Ft(x,{get timestamp(){return o.event.created_at},element:"time",class:"text-sm text-muted-foreground/70"})};y(A,x=>{l()&&x(U)})}var S=ie(A,2);{var M=x=>{var L=g(),R=m(L);se(R,()=>e.children),i(x,L)};y(S,x=>{e.children&&x(M)})}C(F),C(_),T(x=>Y(_,1,x),[()=>ve(oe("flex items-center gap-3",a()))]),i(n,_),W()}ce(["click"]);var St=N('<button class="mt-2 text-sm cursor-pointer bg-transparent border-none p-0" type="button"> </button>'),Mt=N('<div class="relative"><div><!></div> <!></div>');function Lt(n,e){V(e,!0);let r=E(e,"showMedia",3,!0),s=E(e,"showLinkPreview",3,!0),l=E(e,"highlightMentions",3,!0),v=E(e,"class",3,"");const a=pe(Re);if(!a)throw new Error("EventCard.Content must be used within EventCard.Root");let o=de(void 0),c=de(!1),h=de(!1);Te(()=>{if(!e.truncate||!t(o)){P(h,!1);return}const w=()=>{t(o)&&!t(c)&&P(h,t(o).scrollHeight>t(o).clientHeight+1)};return requestAnimationFrame(()=>{requestAnimationFrame(()=>{w()})}),window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)});const _=()=>{P(c,!t(c))};var d=Mt(),f=j(d),u=j(f);tt(u,()=>a.event.id,w=>{na(w,{get ndk(){return a.ndk},get event(){return a.event},get showMedia(){return r()},get showLinkPreview(){return s()},get highlightMentions(){return l()}})}),C(f),at(f,w=>P(o,w),()=>t(o));var k=ie(f,2);{var b=w=>{var z=St();z.__click=_;var F=j(z,!0);C(z),T(()=>Z(F,t(c)?"Show less":"Read more")),i(w,z)};y(k,w=>{e.truncate&&(t(h)||t(c))&&w(b)})}C(d),T(w=>Y(f,1,w),[()=>ve(oe("whitespace-pre-wrap break-words",e.truncate&&!t(c)?`line-clamp-${e.truncate}`:void 0,v()))]),i(n,d),W()}ce(["click"]);ce(["click"]);var Ut=N('<div aria-hidden="true"></div>');function It(n,e){V(e,!0);let r=E(e,"forceShow",3,!1),s=E(e,"avatarSize",3,"md"),l=E(e,"class",3,"");const v=pe(Re);if(!v)throw new Error("EventCard.ThreadLine must be used within EventCard.Root");const a=p(()=>r()||v?.threading?.showLineToNext),o=p(()=>v?.threading?oe("thread-line",v.threading.isSelfThread&&"thread-line--self",l()):"thread-line"),c=p(()=>s()==="sm"?16:s()==="lg"?24:20),h=p(()=>`${t(c)}px`);var _=g(),d=m(_);{var f=u=>{var k=Ut();let b;T(()=>{Y(k,1,ve(t(o)),"svelte-55x6wn"),b=Ke(k,"",b,{left:t(h)})}),i(u,k)};y(d,u=>{t(a)&&u(f)})}i(n,_),W()}ce(["click","keydown"]);ce(["click"]);ce(["click"]);const me={Root:Nt,Header:At,Content:Lt,ThreadLine:It};var Pt=N('<div class="alt-content svelte-12ar4xo"><div class="kind-badge svelte-12ar4xo"> </div> <p class="alt-text svelte-12ar4xo"> </p></div> <!>',1),Dt=N("<!> <!>",1),Ot=N('<!> <div class="kind-badge svelte-12ar4xo"> </div>',1),Ht=N('<div class="generic-embedded svelte-12ar4xo"><!></div>');function Kt(n,e){V(e,!0);let r=E(e,"variant",3,"card");const s=e.event.tagValue("alt");var l=Ht(),v=j(l);{var a=c=>{var h=Pt(),_=m(h),d=j(_),f=j(d);C(d);var u=ie(d,2),k=j(u,!0);C(u),C(_);var b=ie(_,2);re(b,()=>me.Root,(w,z)=>{z(w,{get ndk(){return e.ndk},get event(){return e.event},children:(F,A)=>{var U=g(),S=m(U);{let M=p(()=>r()==="compact"?"compact":"full"),x=p(()=>r()==="compact"?"sm":"md");re(S,()=>me.Header,(L,R)=>{R(L,{get variant(){return t(M)},get avatarSize(){return t(x)},showTimestamp:!0})})}i(F,U)},$$slots:{default:!0}})}),T(()=>{Z(f,`Kind ${e.event.kind??""}`),Z(k,s)}),i(c,h)},o=c=>{var h=Ot(),_=m(h);re(_,()=>me.Root,(u,k)=>{k(u,{get ndk(){return e.ndk},get event(){return e.event},children:(b,w)=>{var z=Dt(),F=m(z);{let U=p(()=>r()==="compact"?"compact":"full"),S=p(()=>r()==="compact"?"sm":"md");re(F,()=>me.Header,(M,x)=>{x(M,{get variant(){return t(U)},get avatarSize(){return t(S)},showTimestamp:!0})})}var A=ie(F,2);{let U=p(()=>r()==="compact"?100:200);re(A,()=>me.Content,(S,M)=>{M(S,{get truncate(){return t(U)}})})}i(b,z)},$$slots:{default:!0}})});var d=ie(_,2),f=j(d);C(d),T(()=>Z(f,`Kind ${e.event.kind??""}`)),i(c,h)};y(v,c=>{s?c(a):c(o,!1)})}C(l),T(()=>Q(l,"data-variant",r())),i(n,l),W()}var qt=N("<!> <!>",1),Zt=N('<div class="note-embedded svelte-kczlqm"><!></div>');function Yt(n,e){let r=E(e,"variant",3,"card");var s=Zt(),l=j(s);re(l,()=>me.Root,(v,a)=>{a(v,{get ndk(){return e.ndk},get event(){return e.event},children:(o,c)=>{var h=qt(),_=m(h);{let f=p(()=>r()==="compact"?"compact":"full"),u=p(()=>r()==="compact"?"sm":"md");re(_,()=>me.Header,(k,b)=>{b(k,{get variant(){return t(f)},get avatarSize(){return t(u)},showTimestamp:!0})})}var d=ie(_,2);{let f=p(()=>r()==="compact"?100:r()==="inline"?150:200);re(d,()=>me.Content,(u,k)=>{k(u,{get truncate(){return t(f)}})})}i(o,h)},$$slots:{default:!0}})}),C(s),T(()=>Q(s,"data-variant",r())),i(n,s)}Ye.add([1,1111],Yt);var Bt=N('<div><div class="loading-spinner svelte-10400wq"></div> <span>Loading event...</span></div>'),Gt=N("<div><span>Failed to load event</span></div>");function Vt(n,e){V(e,!0);let r=E(e,"variant",3,"card"),s=E(e,"kindRegistry",3,Ye),l=E(e,"class",3,"");const v=ut(()=>({bech32:e.bech32}),e.ndk);let a=p(()=>s().get(v.event?.kind)),o=p(()=>t(a)?.component??Kt),c=p(()=>v.event&&t(a)?.wrapper?.from?t(a).wrapper.from(v.event):v.event);var h=g(),_=m(h);{var d=u=>{var k=Bt();T(()=>Y(k,1,`embedded-loading ${l()??""}`,"svelte-10400wq")),i(u,k)},f=u=>{var k=g(),b=m(k);{var w=F=>{var A=Gt();T(()=>Y(A,1,`embedded-error ${l()??""}`,"svelte-10400wq")),i(F,A)},z=F=>{var A=g(),U=m(A);{var S=M=>{var x=g(),L=m(x);re(L,()=>t(o),(R,I)=>{I(R,{get ndk(){return e.ndk},get event(){return t(c)},get variant(){return r()}})}),i(M,x)};y(U,M=>{t(c)&&t(o)&&M(S)},!0)}i(F,A)};y(b,F=>{v.error?F(w):F(z,!1)},!0)}i(u,k)};y(_,u=>{v.loading?u(d):u(f,!1)})}i(n,h),W()}var Wt=N('<a target="_blank" rel="noopener noreferrer" class="link svelte-unlh7t"> </a>'),Xt=N('<img alt="" class="media-image svelte-unlh7t"/>'),Jt=N('<video controls class="media-video svelte-unlh7t"></video>',2),Qt=N('<iframe title="YouTube video" class="media-youtube svelte-unlh7t" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>'),$t=N('<img class="custom-emoji svelte-unlh7t"/>'),ea=N('<img alt="" class="grid-image svelte-unlh7t"/>'),ta=N('<div class="image-grid svelte-unlh7t"></div>'),aa=N("<div></div>");function na(n,e){V(e,!0);let r=E(e,"class",3,"");E(e,"showMedia",3,!0),E(e,"showLinkPreview",3,!0),E(e,"highlightMentions",3,!0);const s=ft(()=>({event:e.event,content:e.content,emojiTags:e.emojiTags}),e.ndk);var l=aa();De(l,21,()=>s.segments,Oe,(v,a)=>{var o=g(),c=m(o);{var h=d=>{var f=Ue();T(()=>Z(f,t(a).content)),i(d,f)},_=d=>{var f=g(),u=m(f);{var k=w=>{var z=g(),F=m(z);{var A=U=>{var S=g(),M=m(S);{var x=R=>{var I=g(),$=m(I);se($,()=>e.mention,()=>({bech32:t(a).data})),i(R,I)},L=R=>{bt(R,{get ndk(){return e.ndk},get bech32(){return t(a).data}})};y(M,R=>{e.mention?R(x):R(L,!1)})}i(U,S)};y(F,U=>{t(a).data&&typeof t(a).data=="string"&&U(A)})}i(w,z)},b=w=>{var z=g(),F=m(z);{var A=S=>{var M=g(),x=m(M);{var L=R=>{var I=g(),$=m(I);{var X=K=>{var q=g(),ee=m(q);se(ee,()=>e.eventRef,()=>({bech32:t(a).data})),i(K,q)},le=K=>{Vt(K,{get ndk(){return e.ndk},get bech32(){return t(a).data},get kindRegistry(){return e.kindRegistry}})};y($,K=>{e.eventRef?K(X):K(le,!1)})}i(R,I)};y(x,R=>{t(a).data&&typeof t(a).data=="string"&&R(L)})}i(S,M)},U=S=>{var M=g(),x=m(M);{var L=I=>{var $=g(),X=m($);{var le=K=>{var q=g(),ee=m(q);{var ge=ae=>{var D=g(),H=m(D);se(H,()=>e.hashtag,()=>({tag:t(a).data})),i(ae,D)},xe=ae=>{xt(ae,{get tag(){return t(a).data}})};y(ee,ae=>{e.hashtag?ae(ge):ae(xe,!1)})}i(K,q)};y(X,K=>{t(a).data&&typeof t(a).data=="string"&&K(le)})}i(I,$)},R=I=>{var $=g(),X=m($);{var le=q=>{var ee=g(),ge=m(ee);{var xe=D=>{var H=g(),he=m(H);se(he,()=>e.link,()=>({url:t(a).content})),i(D,H)},ae=D=>{var H=Wt(),he=j(H,!0);C(H),T(()=>{Q(H,"href",t(a).content),Z(he,t(a).content)}),i(D,H)};y(ge,D=>{e.link?D(xe):D(ae,!1)})}i(q,ee)},K=q=>{var ee=g(),ge=m(ee);{var xe=D=>{var H=g(),he=m(H);{var ze=B=>{var te=g(),_e=m(te);se(_e,()=>e.media,()=>({url:t(a).content})),i(B,te)},Ae=B=>{var te=g(),_e=m(te);{var Ne=O=>{var G=Xt();T(()=>Q(G,"src",t(a).content)),i(O,G)},ke=O=>{var G=g(),ye=m(G);{var be=J=>{var we=Jt();T(()=>Q(we,"src",t(a).content)),i(J,we)},fe=J=>{var we=g(),Se=m(we);{var ue=ne=>{const Ee=p(()=>t(a).content.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/)?.[1]);var Ce=g(),Fe=m(Ce);{var Be=Me=>{var Pe=Qt();T(()=>Q(Pe,"src",`https://www.youtube.com/embed/${t(Ee)??""}`)),i(Me,Pe)};y(Fe,Me=>{t(Ee)&&Me(Be)})}i(ne,Ce)};y(Se,ne=>{t(a).content.match(/youtube\.com|youtu\.be/i)&&ne(ue)},!0)}i(J,we)};y(ye,J=>{t(a).content.match(/\.(mp4|webm|mov)(\?|$)/i)?J(be):J(fe,!1)},!0)}i(O,G)};y(_e,O=>{t(a).content.match(/\.(jpg|jpeg|png|gif|webp|svg)(\?|$)/i)?O(Ne):O(ke,!1)})}i(B,te)};y(he,B=>{e.media?B(ze):B(Ae,!1)})}i(D,H)},ae=D=>{var H=g(),he=m(H);{var ze=B=>{var te=g(),_e=m(te);{var Ne=O=>{var G=g(),ye=m(G);se(ye,()=>e.emoji,()=>({shortcode:t(a).content,url:t(a).data})),i(O,G)},ke=O=>{var G=g(),ye=m(G);{var be=fe=>{var J=$t();T(()=>{Q(J,"src",t(a).data),Q(J,"alt",`:${t(a).content??""}:`)}),i(fe,J)};y(ye,fe=>{typeof t(a).data=="string"&&fe(be)},!0)}i(O,G)};y(_e,O=>{e.emoji&&typeof t(a).data=="string"?O(Ne):O(ke,!1)})}i(B,te)},Ae=B=>{var te=g(),_e=m(te);{var Ne=ke=>{var O=g(),G=m(O);{var ye=be=>{var fe=g(),J=m(fe);{var we=ue=>{var ne=g(),Ee=m(ne);se(Ee,()=>e.imageGrid,()=>({urls:t(a).data})),i(ue,ne)},Se=ue=>{var ne=ta();De(ne,21,()=>t(a).data,Oe,(Ee,Ce)=>{var Fe=ea();T(()=>Q(Fe,"src",t(Ce))),i(Ee,Fe)}),C(ne),i(ue,ne)};y(J,ue=>{e.imageGrid?ue(we):ue(Se,!1)})}i(be,fe)};y(G,be=>{t(a).data&&Array.isArray(t(a).data)&&be(ye)})}i(ke,O)};y(_e,ke=>{t(a).type==="image-grid"&&ke(Ne)},!0)}i(B,te)};y(he,B=>{t(a).type==="emoji"?B(ze):B(Ae,!1)},!0)}i(D,H)};y(ge,D=>{t(a).type==="media"?D(xe):D(ae,!1)},!0)}i(q,ee)};y(X,q=>{t(a).type==="link"?q(le):q(K,!1)},!0)}i(I,$)};y(x,I=>{t(a).type==="hashtag"?I(L):I(R,!1)},!0)}i(S,M)};y(F,S=>{t(a).type==="event-ref"?S(A):S(U,!1)},!0)}i(w,z)};y(u,w=>{t(a).type==="npub"||t(a).type==="nprofile"?w(k):w(b,!1)},!0)}i(d,f)};y(c,d=>{t(a).type==="text"?d(h):d(_,!1)})}i(v,o)}),C(l),T(()=>Y(l,1,`event-content ${r()??""}`,"svelte-unlh7t")),i(n,l),W()}export{na as E,me as a};
