import{i as G,a as o,d as lt,c as j,f as K,s as D}from"./DNmf0A2m.js";import{g as E,b as W,t as P,p as it,aJ as ft,f as w,c as ct,e as k,r as x,d as I}from"./DpkVnRja.js";import{i as C}from"./Btb_Ey2R.js";import{c as S}from"./CSx53_lc.js";import{c as F,a as X,e as Y}from"./Ci0hv7jC.js";import{p as M}from"./f_qAQkK6.js";import{l as Z}from"./QTLWRGLp.js";import{r as dt,U as q}from"./BYRURnlO.js";import{T as ut}from"./C75qor0g.js";function gt(_,t){const r=dt(t);r.$sessions&&r.$sessions.addMonitor([Z]);const h=W(()=>{let{target:e}=_();if(!e)return!1;if(typeof e=="string")if(/^[0-9a-f]{64}$/i.test(e))e=r.getUser({pubkey:e});else{const s=r.$sessionEvent(Z,{create:!0});return s?s.hasInterest(e.toLowerCase()):!1}try{const s=e.pubkey;return r.$follows.has(s)}catch{return!1}});async function c(){let{target:e}=_();if(!e)return;if(typeof e=="string")if(/^[0-9a-f]{64}$/i.test(e))e=r.getUser({pubkey:e});else{const a=r.$sessionEvent(Z,{create:!0});if(!a)return;const n=e.toLowerCase();E(h)?a.removeInterest(n):a.addInterest(n),await a.publishReplaceable();return}let s;try{s=e.pubkey}catch{throw new Error("User not loaded yet")}E(h)?await r.$follows.remove(s):await r.$follows.add(s)}return{get isFollowing(){return E(h)},follow:c}}var vt=G('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" color="currentColor" fill="none"><path d="M13.5 16.0001V14.0623C15.2808 12.6685 16.5 11 16.5 7.41681C16.5 5.09719 16.0769 3 13.5385 3C13.5385 3 12.6433 2 10.4923 2C7.45474 2 5.5 3.82696 5.5 7.41681C5.5 11 6.71916 12.6686 8.5 14.0623V16.0001L4.78401 17.1179C3.39659 17.5424 2.36593 18.6554 2.02375 20.0101C1.88845 20.5457 2.35107 21.0001 2.90639 21.0001H13.0936" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M18.5 22L18.5 15M15 18.5H22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function wt(_,t){let r=M(t,"size",3,24),h=M(t,"class",3,"");var c=vt();P(()=>{F(c,"width",r()),F(c,"height",r()),X(c,0,Y(h()))}),o(_,c)}var ht=K('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M10 3L8 21M16 3L14 21M3 8H21M2 16H20"></path></svg> <span class="text-sm inline-flex items-baseline gap-1"><span class="font-bold"> </span> <span class="font-normal"> </span></span>',1),pt=K('<!> <span class="text-sm inline-flex items-baseline gap-1"><span class="font-bold"> </span> <!></span>',1),mt=G('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0"><path d="M10 3L8 21M16 3L14 21M3 8H21M2 16H20"></path></svg>'),bt=G('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="1.5" class="flex-shrink-0"><path d="M12 15C15.866 15 19 11.866 19 8C19 4.13401 15.866 1 12 1C8.13401 1 5 4.13401 5 8C5 11.866 8.13401 15 12 15Z"></path><path d="M2 23C2 18.5817 6.47715 15 12 15C17.5228 15 22 18.5817 22 23" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8 9L10.5 11.5L16 6" stroke-linecap="round" stroke-linejoin="round"></path></svg>'),kt=K('<!> <span class="text-sm font-medium"> </span>',1),xt=K('<button data-follow-button="" type="button"><!></button>');function jt(_,t){it(t,!0);let r=M(t,"variant",3,"ghost"),h=M(t,"showIcon",3,!0),c=M(t,"showTarget",3,!1),e=M(t,"class",3,"");const s=ft("ndk"),a=t.ndk||s,n=typeof t.target=="string",$=W(()=>{if(n||!a?.$currentPubkey)return!1;try{return a.$currentPubkey===t.target.pubkey}catch{return!1}}),d=gt(()=>({target:t.target}),a),tt=ut({base:"inline-flex items-center gap-2 cursor-pointer font-medium text-sm transition-all rounded-md outline-none disabled:pointer-events-none disabled:opacity-50",variants:{variant:{ghost:"px-3 py-2 hover:bg-accent hover:text-accent-foreground",outline:"px-3 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border",pill:"px-4 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border rounded-full",solid:"px-4 py-2 bg-primary text-primary-foreground shadow-xs hover:bg-primary/90"},following:{true:"text-muted-foreground hover:text-foreground",false:"text-primary"}},compoundVariants:[{variant:"solid",following:!0,class:"bg-muted text-foreground hover:bg-muted/80"}]});async function et(){if(a?.$currentPubkey)try{await d.follow()}catch(L){console.error("Failed to toggle follow:",L)}}var Q=j(),rt=w(Q);{var ot=L=>{var l=xt();l.__click=et;var at=k(l);{var st=u=>{var U=j(),B=w(U);{var V=g=>{var i=ht(),p=I(w(i),2),m=k(p),H=k(m,!0);x(m);var y=I(m,2),f=k(y);x(y),x(p),P(()=>{D(H,d.isFollowing?"Unfollow":"Follow"),D(f,`#${t.target??""}`)}),o(g,i)},T=g=>{var i=j(),p=w(i);S(p,()=>q.Root,(m,H)=>{H(m,{get ndk(){return a},get user(){return t.target},class:"flex items-center gap-2",children:(y,f)=>{var b=pt(),z=w(b);S(z,()=>q.Avatar,(J,O)=>{O(J,{class:"w-5 h-5"})});var A=I(z,2),N=k(A),v=k(N,!0);x(N);var R=I(N,2);S(R,()=>q.Name,(J,O)=>{O(J,{field:"displayName",class:"font-normal text-sm"})}),x(A),P(()=>D(v,d.isFollowing?"Unfollow":"Follow")),o(y,b)},$$slots:{default:!0}})}),o(g,i)};C(B,g=>{n?g(V):g(T,!1)})}o(u,U)},nt=u=>{var U=kt(),B=w(U);{var V=i=>{var p=j(),m=w(p);{var H=f=>{var b=mt();o(f,b)},y=f=>{var b=j(),z=w(b);{var A=v=>{var R=bt();o(v,R)},N=v=>{wt(v,{size:16,class:"flex-shrink-0"})};C(z,v=>{d.isFollowing?v(A):v(N,!1)},!0)}o(f,b)};C(m,f=>{n?f(H):f(y,!1)})}o(i,p)};C(B,i=>{h()&&i(V)})}var T=I(B,2),g=k(T,!0);x(T),P(()=>D(g,d.isFollowing?"Unfollow":"Follow")),o(u,U)};C(at,u=>{c()?u(st):u(nt,!1)})}x(l),P(u=>{F(l,"data-following",d.isFollowing?"":void 0),F(l,"data-target-type",n?"hashtag":"user"),F(l,"data-variant",r()),X(l,1,u),F(l,"aria-label",d.isFollowing?n?`Unfollow #${t.target}`:"Unfollow user":n?`Follow #${t.target}`:"Follow user")},[()=>Y(tt({variant:r(),following:d.isFollowing,class:e()}))]),o(L,l)};C(rt,L=>{!E($)&&a?.$currentUser&&L(ot)})}o(_,Q),ct()}lt(["click"]);export{jt as F};
