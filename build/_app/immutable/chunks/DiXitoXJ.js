import{i as De,a as r,d as Le,f as m,c as be,s as ne,j as qe,t as je}from"./DNmf0A2m.js";import{u as Ke,s as f,a as pe,g as e,b as U,p as Se,t as Z,c as Ae,aJ as rt,e as a,f as X,d as s,r as o,y as Ee,x as He,aH as gt,z as Bt,aX as Zt,bs as mt}from"./DpkVnRja.js";import{c as ge}from"./CSx53_lc.js";import{e as Ge,c as Re,a as we,r as Ot,b as $e}from"./Ci0hv7jC.js";import{p as F}from"./f_qAQkK6.js";import{N as tt,L as Wt,e as vt,M as Rt,O as zt,n as ue,c as Qt,s as at,f as qt,P as Kt}from"./QTLWRGLp.js";import{R as Ht,a as St,E as et}from"./DSAIpCcp.js";import{i as B}from"./Btb_Ey2R.js";import{a as Je}from"./Danls9zm.js";import{t as ze}from"./BHGJODx2.js";import{c as st}from"./a7XEC-kH.js";import{e as Xe,i as lt}from"./DD8s4tVe.js";import{b as it}from"./-Mgh5RB7.js";import{r as At,c as pt,U as Oe}from"./BYRURnlO.js";import{u as bt}from"./ACGw3gZU.js";import{p as dt}from"./Bm7To3ke.js";import{M as Mt,D as Ut,a as Et,R as jt,b as Ft,c as Tt,d as Nt}from"./ExIc70cS.js";import{B as Ie,I as ht}from"./OHIcQ-QL.js";import{s as Dt}from"./CszMzaRi.js";import{b as It}from"./Cl1e4hnh.js";import{N as Vt,c as Gt}from"./CwXZxT0m.js";import{R as xt}from"./Bw8OG36z.js";import{T as nt}from"./C75qor0g.js";import{g as yt}from"./BFZgCa8b.js";import{c as Xt}from"./MZ4igXhu.js";import{I as Ze}from"./B7jIYntu.js";import{D as Yt,a as Jt}from"./B-DQEjp8.js";import{D as $t}from"./DuCXCqgL.js";import{L as _t}from"./CRTsssmk.js";import{D as er}from"./BGQ6BdS-.js";function tr(H,t){const n=At(t);let c=pe(null);Ke(()=>{const{event:p}=H();if(!p?.id){f(c,null);return}f(c,n.$subscribe(()=>({filters:[{kinds:[tt.Text,tt.GenericReply],...p.filter()}],closeOnEose:!1})),!0)});const g=U(()=>{const p=e(c);if(!p)return{count:0,hasReplied:!1,pubkeys:[]};const{event:v}=H();if(!v?.id)return{count:0,hasReplied:!1,pubkeys:[]};const h=Array.from(p.events).filter(b=>Wt(v,b)),k=h.map(b=>b.pubkey);return{count:h.length,hasReplied:n.$currentPubkey?h.some(b=>b.pubkey===n.$currentPubkey):!1,pubkeys:k}});async function i(p){const{event:v}=H();if(!v?.id)throw new Error("No event to reply to");if(!n.$currentPubkey)throw new Error("User must be logged in to reply");const h=v.reply();return h.content=p,await h.publish(),h}return{get count(){return e(g).count},get hasReplied(){return e(g).hasReplied},get pubkeys(){return e(g).pubkeys},reply:i}}var rr=De('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path></svg>');function or(H,t){Se(t,!0);let n=F(t,"size",3,20),c=F(t,"class",3,"");var g=rr();Z(i=>{Re(g,"width",n()),Re(g,"height",n()),we(g,0,i)},[()=>Ge(pt("",c()))]),r(H,g),Ae()}function ar(H,t){const n=At(t);let c=pe(null);Ke(()=>{const{event:v}=H();if(!v?.id){f(c,null);return}f(c,n.$subscribe(()=>({filters:[{kinds:[tt.Repost,tt.GenericRepost],...v.filter()},{"#q":[v.tagId()]}],closeOnEose:!1})),!0)});const g=U(()=>{const v=e(c);if(!v)return{count:0,hasReposted:!1,pubkeys:[]};const h=v.events;if(!h)return{count:0,hasReposted:!1,pubkeys:[]};let k;const b=new Set;for(const d of h)b.add(d.pubkey),n.$currentPubkey&&d.pubkey===n.$currentPubkey&&(k=d);const A=!!k;return{count:b.size,hasReposted:A,pubkeys:Array.from(b),userRepost:k}});async function i(){const{event:v}=H();if(!v?.id)throw new Error("No event to repost");if(!n.$currentPubkey)throw new Error("User must be logged in to repost");return e(g).hasReposted&&e(g).userRepost?(await e(g).userRepost.delete(),e(g).userRepost):await v.repost(!0)}async function p(v){const{event:h}=H();if(!h?.id)throw new Error("No event to quote");if(!n.$currentPubkey)throw new Error("User must be logged in to quote");const k=new vt(t,{kind:tt.Text,content:v});return k.tag(h,void 0,!1,"q"),await k.publish(),k}return{get count(){return e(g).count},get hasReposted(){return e(g).hasReposted},get pubkeys(){return e(g).pubkeys},repost:i,quote:p}}var nr=De('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M16.3884 3L17.3913 3.97574C17.8393 4.41165 18.0633 4.62961 17.9844 4.81481C17.9056 5 17.5888 5 16.9552 5H9.19422C5.22096 5 2 8.13401 2 12C2 13.4872 2.47668 14.8662 3.2895 16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M7.61156 21L6.60875 20.0243C6.16074 19.5883 5.93673 19.3704 6.01557 19.1852C6.09441 19 6.4112 19 7.04478 19H14.8058C18.779 19 22 15.866 22 12C22 10.5128 21.5233 9.13383 20.7105 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function sr(H,t){let n=F(t,"class",3,""),c=F(t,"size",3,18);var g=nr();Z(()=>{Re(g,"width",c()),Re(g,"height",c()),we(g,0,Ge(n()))}),r(H,g)}function lr(H,t){const n=t||rt("ndk");let c=pe(null);Ke(()=>{const{target:v}=H();if(!v){f(c,null);return}f(c,n.$subscribe(()=>({filters:[{kinds:[tt.Zap],...v.filter()}],closeOnEose:!1})),!0)});const g=U(()=>{const v=e(c);if(!v)return{count:0,totalAmount:0,hasZapped:!1};const h=Array.from(v.events),k=h.map(zt).filter(Boolean),b=k.reduce((d,u)=>d+(u?.amount||0),0),A=n.$currentPubkey?k.some(d=>d?.zapper===n.$currentPubkey):!1;return{count:h.length,totalAmount:Math.floor(b/1e3),hasZapped:A}});async function i(v,h){const{target:k}=H();if(!k)throw new Error("No target to zap");if(!n.$currentPubkey)throw new Error("User must be logged in to zap");await new Rt(k,v*1e3,"msat",{comment:h}).zap()}const p=U(()=>e(c)?Array.from(e(c).events):[]);return{get count(){return e(g).count},get totalAmount(){return e(g).totalAmount},get hasZapped(){return e(g).hasZapped},get events(){return e(p)},zap:i}}var ir=De('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14H12L11 22L21 10H12L13 2Z"></path></svg>');function dr(H,t){Se(t,!0);let n=F(t,"size",3,18),c=F(t,"filled",3,!1),g=F(t,"class",3,"");var i=ir();Z(p=>{Re(i,"width",n()),Re(i,"height",n()),Re(i,"fill",c()?"currentColor":"none"),we(i,0,p)},[()=>Ge(pt("",g()))]),r(H,i),Ae()}var ur=m('<button type="button" class="inline-flex items-center gap-1 px-2 py-1 bg-primary/20 hover:bg-primary/30 text-foreground rounded-full text-xs transition-colors"><!> <span class="max-w-[100px] truncate"> </span> <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>');function cr(H,t){Se(t,!0);let n=pe(null);Ke(()=>{ue.fetchUser(t.pubkey).then(h=>{h?.fetchProfile().then(k=>{f(n,k,!0)})})});const c=U(()=>e(n)?.displayName||e(n)?.name||`${t.pubkey.slice(0,8)}...`);var g=ur();g.__click=()=>t.onRemove(t.pubkey);var i=a(g);ge(i,()=>Oe.Root,(h,k)=>{k(h,{get ndk(){return ue},get pubkey(){return t.pubkey},children:(b,A)=>{var d=be(),u=X(d);ge(u,()=>Oe.Avatar,(R,P)=>{P(R,{class:"w-3.5 h-3.5 flex-shrink-0"})}),r(b,d)},$$slots:{default:!0}})});var p=s(i,2),v=a(p,!0);o(p),Ee(2),o(g),Z(()=>ne(v,e(c))),r(H,g),Ae()}Le(["click"]);var vr=m('<div class="text-xs text-muted-foreground truncate"> </div>'),fr=De('<svg class="w-3 h-3 text-primary-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>'),gr=m("<div><!></div>"),pr=m('<button type="button"><!> <div class="flex-1 min-w-0 text-left"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div> <!></button>');function mr(H,t){Se(t,!0);let n=pe(null);Ke(()=>{ue.fetchUser(t.pubkey).then(u=>{u?.fetchProfile().then(R=>{f(n,R,!0)})})});const c=U(()=>e(n)?.displayName||e(n)?.name||`${t.pubkey.slice(0,8)}...`);var g=pr();g.__click=()=>t.onToggle(t.pubkey);var i=a(g);ge(i,()=>Oe.Root,(u,R)=>{R(u,{get ndk(){return ue},get pubkey(){return t.pubkey},children:(P,I)=>{var S=be(),x=X(S);ge(x,()=>Oe.Avatar,(N,G)=>{G(N,{class:"flex-shrink-0"})}),r(P,S)},$$slots:{default:!0}})});var p=s(i,2),v=a(p),h=a(v,!0);o(v);var k=s(v,2);{var b=u=>{var R=vr(),P=a(R,!0);o(R),Z(()=>ne(P,e(n).nip05)),r(u,R)};B(k,u=>{e(n)?.nip05&&u(b)})}o(p);var A=s(p,2);{var d=u=>{var R=gr(),P=a(R);{var I=S=>{var x=fr();r(S,x)};B(P,S=>{t.isSelected&&S(I)})}o(R),Z(()=>we(R,1,`w-4 h-4 rounded border flex items-center justify-center flex-shrink-0 ${t.isSelected?"bg-primary border-primary":"border-border"}`)),r(u,R)};B(A,u=>{t.showCheckbox&&u(d)})}o(g),Z(()=>{we(g,1,`w-full flex items-center gap-2 p-2 rounded-md transition-colors ${t.isSelected?"bg-primary/20":"hover:bg-muted"}`),ne(h,e(c))}),r(H,g),Ae()}Le(["click"]);var br=m('<button type="button" class="absolute right-1 top-1/2 -translate-y-1/2 px-2 py-1 bg-primary hover:bg-primary/90 text-primary-foreground rounded text-xs font-medium transition-colors">Add</button>'),hr=m('<p class="text-xs text-muted-foreground mt-1.5">Search follows or paste npub/hex/NIP-05</p>'),xr=m('<div class="px-3 py-2 border-b border-border bg-muted/30"><div class="text-xs font-medium text-muted-foreground mb-2"> </div> <div class="flex flex-wrap gap-1.5"></div></div>'),yr=m('<div class="text-center py-8 px-3 text-muted-foreground text-sm"> </div>'),_r=m('<div class="p-2 space-y-1"></div>'),wr=m('<div class="flex flex-col max-h-[400px]"><div class="p-3 border-b border-border"><h3 class="font-semibold text-sm mb-2">Tag people</h3> <div class="relative"><svg class="absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> <input type="text" placeholder="Search or paste npub/identifier..." class="w-full pl-8 pr-16 py-2 bg-muted border border-border rounded-lg text-foreground text-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"/> <!></div> <!></div> <!> <div class="overflow-y-auto flex-1"><!></div></div>');function wt(H,t){Se(t,!0);let n=F(t,"searchQuery",15);var c=wr(),g=a(c),i=s(a(g),2),p=s(a(i),2);Ot(p),p.__keydown=S=>{S.key==="Enter"&&t.isIdentifierInput&&t.onAddByIdentifier()};var v=s(p,2);{var h=S=>{var x=br();x.__click=function(...N){t.onAddByIdentifier?.apply(this,N)},r(S,x)};B(v,S=>{t.isIdentifierInput&&S(h)})}o(i);var k=s(i,2);{var b=S=>{var x=hr();r(S,x)};B(k,S=>{n()||S(b)})}o(g);var A=s(g,2);{var d=S=>{var x=xr(),N=a(x),G=a(N);o(N);var w=s(N,2);Xe(w,20,()=>t.selectedPubkeys,L=>L,(L,E)=>{cr(L,{get pubkey(){return E},get onRemove(){return t.onRemoveUser}})}),o(w),o(x),Z(()=>ne(G,`Selected (${t.selectedPubkeys.length??""})`)),r(S,x)};B(A,S=>{t.selectedPubkeys.length>0&&S(d)})}var u=s(A,2),R=a(u);{var P=S=>{var x=yr(),N=a(x,!0);o(x),Z(()=>ne(N,n()?"No matches found":"You don't follow anyone yet")),r(S,x)},I=S=>{var x=_r();Xe(x,20,()=>t.filteredFollows,N=>N,(N,G)=>{{let w=U(()=>t.selectedPubkeys.includes(G));mr(N,{get pubkey(){return G},get isSelected(){return e(w)},get showCheckbox(){return t.multiple},get onToggle(){return t.onToggleUser}})}}),o(x),r(S,x)};B(R,S=>{t.filteredFollows.length===0?S(P):S(I,!1)})}o(u),o(c),It(p,n),r(H,c),Ae()}Le(["keydown","click"]);var kr=m('<span class="ml-auto text-xs bg-primary/20 text-primary rounded-full px-2 py-0.5"> </span>'),Cr=m('<svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> <span> </span> <!>',1),Pr=m('<span class="absolute -top-1 -right-1 text-[10px] bg-primary text-primary-foreground rounded-full w-4 h-4 flex items-center justify-center"> </span>'),Rr=De('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg><!>',1),zr=m('<div role="presentation" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center"><div role="dialog" tabindex="-1" style="width: 380px;" class="bg-card border border-border rounded-lg shadow-xl overflow-hidden"><!></div></div>'),Sr=m('<div class="bg-card border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),Ar=m('<div class="relative"><!> <!></div>');function Mr(H,t){Se(t,!0);let n=F(t,"selectedPubkeys",31,()=>He([])),c=F(t,"multiple",3,!0),g=F(t,"buttonClass",3,""),i=F(t,"disabled",3,!1),p=F(t,"iconOnly",3,!0),v=F(t,"open",15,!1),h=pe(""),k=null,b=pe(He({top:0,left:0,width:0}));const A=ue.$subscribe(()=>ue.$currentUser?.pubkey?{filters:[{kinds:[3],authors:[ue.$currentUser.pubkey],limit:1}],bufferMs:100}:void 0),d=U(()=>{const C=A.events[0];return C?new Set(C.tags.filter(y=>y[0]==="p").map(y=>y[1])):new Set});let u=pe(He(new Map));const R=U(()=>e(h)?Array.from(e(u).entries()).filter(([y])=>e(d).has(y)).map(([y])=>y).slice(0,50):Array.from(e(d)).slice(0,50));Ke(()=>{if(!e(h).trim()||!ue.cacheAdapter?.getProfiles){f(u,new Map,!0);return}const C=e(h).toLowerCase();ue.cacheAdapter.getProfiles({fields:["name","displayName","nip05"],contains:C}).then(y=>{f(u,y??new Map,!0)}).catch(y=>{console.error("Failed to search profiles:",y),f(u,new Map,!0)})});function P(){if(!v()&&k){const C=k.getBoundingClientRect();f(b,{top:C.bottom+4,left:C.left,width:Math.max(C.width,380)},!0)}v(!v())}const I=U(()=>g().includes("hidden"));Ke(()=>{if(v()&&e(I)){const C=window.innerWidth,y=window.innerHeight,$=380;f(b,{top:(y-400)/2,left:(C-$)/2,width:$},!0)}});function S(C){c()?n().includes(C)?n(n().filter(y=>y!==C)):n([...n(),C]):(n([C]),v(!1)),t.onSelect?.(n())}function x(C){n(n().filter(y=>y!==C)),t.onSelect?.(n())}async function N(){if(e(h).trim())try{const C=e(h).trim(),y=await ue.fetchUser(C);y?.pubkey?(c()?n().includes(y.pubkey)||(n([...n(),y.pubkey]),t.onSelect?.(n()),ze.success("User added")):(n([y.pubkey]),t.onSelect?.(n()),v(!1)),f(h,"")):ze.error("User not found")}catch(C){console.error("Failed to fetch user:",C),ze.error("Failed to fetch user")}}function G(){v(!1)}const w=U(()=>{const C=e(h).trim();return C.length>0&&(C.startsWith("npub1")||C.startsWith("nprofile1")||C.includes("@")||C.length===64&&/^[0-9a-f]+$/i.test(C))});var L=Ar(),E=a(L);{let C=U(()=>p()?"icon":"default"),y=U(()=>p()?"h-8 w-8":"w-full justify-start"),$=U(g),ae=U(()=>t.buttonLabel||"Tag people");Ie(E,{type:"button",variant:"ghost",get size(){return e(C)},get class(){return`${e(y)??""} ${e($)??""}`},get disabled(){return i()},onclick:P,get title(){return e(ae)},get ref(){return k},set ref(re){k=re},children:(re,T)=>{var j=be(),Y=X(j);{var oe=W=>{var Q=Cr(),V=s(X(Q),2),q=a(V,!0);o(V);var K=s(V,2);{var ce=Pe=>{var ke=kr(),ee=a(ke,!0);o(ke),Z(()=>ne(ee,n().length)),r(Pe,ke)};B(K,Pe=>{n().length>0&&Pe(ce)})}Z(()=>ne(q,t.buttonLabel)),r(W,Q)},D=W=>{var Q=Rr(),V=s(X(Q));{var q=K=>{var ce=Pr(),Pe=a(ce,!0);o(ce),Z(()=>ne(Pe,n().length)),r(K,ce)};B(V,K=>{n().length>0&&K(q)})}r(W,Q)};B(Y,W=>{!p()&&t.buttonLabel?W(oe):W(D,!1)})}r(re,j)},$$slots:{default:!0}})}var z=s(E,2);{var O=C=>{var y=be(),$=X(y);{var ae=T=>{var j=zr();j.__click=G,j.__keydown=D=>D.key==="Escape"&&G();var Y=a(j);Y.__click=D=>D.stopPropagation(),Y.__keydown=D=>D.stopPropagation();var oe=a(Y);wt(oe,{get isIdentifierInput(){return e(w)},get selectedPubkeys(){return n()},get filteredFollows(){return e(R)},get multiple(){return c()},onSearchQueryChange:D=>f(h,D,!0),onAddByIdentifier:N,onRemoveUser:x,onToggleUser:S,get searchQuery(){return e(h)},set searchQuery(D){f(h,D,!0)}}),o(Y),o(j),Je(j,D=>dt?.(D)),r(T,j)},re=T=>{var j=Sr(),Y=a(j);wt(Y,{get isIdentifierInput(){return e(w)},get selectedPubkeys(){return n()},get filteredFollows(){return e(R)},get multiple(){return c()},onSearchQueryChange:oe=>f(h,oe,!0),onAddByIdentifier:N,onRemoveUser:x,onToggleUser:S,get searchQuery(){return e(h)},set searchQuery(oe){f(h,oe,!0)}}),o(j),Je(j,oe=>dt?.(oe)),Je(j,(oe,D)=>st?.(oe,D),()=>G),Z(()=>$e(j,`position: fixed; top: ${e(b).top??""}px; left: ${e(b).left??""}px; width: 380px;`)),r(T,j)};B($,T=>{e(I)?T(ae):T(re,!1)})}r(C,y)};B(z,C=>{v()&&C(O)})}o(L),r(H,L),Ae()}Le(["click","keydown"]);var Ur=m('<div class="text-xs text-muted-foreground truncate"> </div>'),Er=m('<button type="button"><!> <div class="flex-1 min-w-0 text-left"><div class="text-sm font-medium text-foreground truncate"> </div> <!></div></button>');function jr(H,t){Se(t,!0);let n=pe(null);Ke(()=>{ue.fetchUser(t.pubkey).then(b=>{b?.fetchProfile().then(A=>{f(n,A,!0)})})});var c=Er();c.__click=b=>{b.preventDefault(),b.stopPropagation(),t.onSelect(t.pubkey)};var g=a(c);ge(g,()=>Oe.Root,(b,A)=>{A(b,{get ndk(){return ue},get pubkey(){return t.pubkey},children:(d,u)=>{var R=be(),P=X(R);ge(P,()=>Oe.Avatar,(I,S)=>{S(I,{class:"flex-shrink-0"})}),r(d,R)},$$slots:{default:!0}})});var i=s(g,2),p=a(i),v=a(p,!0);o(p);var h=s(p,2);{var k=b=>{var A=Ur(),d=a(A,!0);o(A),Z(()=>ne(d,e(n).nip05)),r(b,A)};B(h,b=>{e(n)?.nip05&&b(k)})}o(i),o(c),Z(()=>{we(c,1,`w-full flex items-center gap-2 p-2 transition-colors ${t.isSelected?"bg-primary/20":"hover:bg-muted"}`),ne(v,e(n)?.displayName||e(n)?.name||"Anonymous")}),qe("mouseenter",c,function(...b){t.onMouseEnter?.apply(this,b)}),r(H,c),Ae()}Le(["click"]);var Fr=m('<div class="bg-card border border-border rounded-lg shadow-xl z-[1003] overflow-hidden"><div class="max-h-[300px] overflow-y-auto"></div></div>');function Tr(H,t){Se(t,!0);let n=pe(0);const c=ue.$subscribe(()=>ue.$currentUser?.pubkey?{filters:[{kinds:[3],authors:[ue.$currentUser.pubkey],limit:1}],bufferMs:100}:void 0),g=U(()=>{const d=c.events[0];return d?new Set(d.tags.filter(u=>u[0]==="p").map(u=>u[1])):new Set});let i=pe(He(new Map));const p=U(()=>t.searchQuery?Array.from(e(i).entries()).filter(([u])=>e(g).has(u)).map(([u])=>u).slice(0,10):Array.from(e(g)).slice(0,10));Ke(()=>{if(!t.searchQuery.trim()||!ue.cacheAdapter?.getProfiles){f(i,new Map,!0);return}const d=t.searchQuery.toLowerCase();ue.cacheAdapter.getProfiles({fields:["name","displayName","nip05"],contains:d}).then(u=>{f(i,u??new Map,!0)}).catch(u=>{console.error("Failed to search profiles:",u),f(i,new Map,!0)})}),Ke(()=>{e(n)>=e(p).length&&f(n,Math.max(0,e(p).length-1),!0)});function v(d){const u=ue.getUser({pubkey:d}),R=Array.from(u.relayUrls||[]),P=Qt.nprofileEncode({pubkey:d,relays:R.slice(0,3)});t.onSelect(`nostr:${P}`)}function h(d){switch(d.key){case"ArrowDown":d.preventDefault(),f(n,(e(n)+1)%e(p).length);break;case"ArrowUp":d.preventDefault(),f(n,e(n)===0?e(p).length-1:e(n)-1,!0);break;case"Enter":d.preventDefault(),e(p).length>0&&v(e(p)[e(n)]);break;case"Escape":d.preventDefault(),t.onClose();break}}var k=be();qe("keydown",gt,h);var b=X(k);{var A=d=>{var u=Fr(),R=a(u);Xe(R,22,()=>e(p),P=>P,(P,I,S)=>{{let x=U(()=>e(S)===e(n));jr(P,{get pubkey(){return I},get isSelected(){return e(x)},onSelect:v,onMouseEnter:()=>f(n,e(S),!0)})}}),o(R),o(u),Je(u,P=>dt?.(P)),Z(()=>$e(u,`position: fixed; top: ${t.position.top??""}px; left: ${t.position.left??""}px; max-width: 320px;`)),r(d,u)};B(b,d=>{e(p).length>0&&d(A)})}r(H,k),Ae()}var Nr=m('<div class="absolute inset-0 flex items-center justify-center"><div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div></div>'),Dr=m('<button type="button" class="absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center hover:bg-red-600" aria-label="Remove image"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>'),Ir=m('<div class="relative group"><img alt="Upload preview"/> <!></div>'),Lr=m('<div class="flex flex-wrap gap-2 mt-2"></div>'),Br=De('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>'),Zr=m('<div><input type="file" accept="image/*" multiple class="hidden"/> <div><textarea class="w-full min-h-[120px] max-md:flex-1 max-md:min-h-0 bg-transparent text-foreground placeholder-neutral-500 resize-none focus:outline-none focus:ring-0 text-lg"></textarea> <!></div> <div class="flex items-center gap-2 mt-2 pt-2 border-t border-border"><!> <!> <!></div></div> <!>',1);function kt(H,t){Se(t,!0);let n=F(t,"value",15,""),c=F(t,"placeholder",3,"What's on your mind?"),g=F(t,"autofocus",3,!1),i=F(t,"disabled",3,!1),p=F(t,"class",3,""),v=F(t,"selectedMentions",31,()=>He([]));const h=new Vt(ue),k=Gt(h);let b,A,d=pe(!1),u=pe(He([])),R=pe(!1),P=pe(!1),I=pe(""),S=pe(0),x=pe(He({top:0,left:0})),N=He(new Map);async function G(l){if(!l.type.startsWith("image/")){ze.error("Please select an image file");return}const _=URL.createObjectURL(l),M=e(u).length;f(u,[...e(u),{url:"",preview:_}],!0),f(R,!0);try{await k.upload(l,{fallbackServer:"https://blossom.primal.net"}),k.result?.url&&(e(u)[M]={url:k.result.url,preview:_},w(k.result.url),ze.success("Image uploaded"))}catch(se){console.error("Upload failed:",se),ze.error("Failed to upload image"),f(u,e(u).filter((de,ve)=>ve!==M),!0)}finally{f(R,!1)}}function w(l){const _=b;if(!_)return;const M=_.selectionStart,se=_.selectionEnd,de=`
${l}
`;n(n().slice(0,M)+de+n().slice(se)),setTimeout(()=>{_.selectionStart=_.selectionEnd=M+de.length,_.focus()},0)}function L(l){const _=e(u)[l];_.url&&n(n().replace(`
${_.url}
`,"").replace(_.url,"")),URL.revokeObjectURL(_.preview),f(u,e(u).filter((M,se)=>se!==l),!0)}function E(l){const _=l.target,M=_.files?.[0];M&&G(M),_.value=""}function z(l){l.preventDefault(),f(d,!0)}function O(l){l.preventDefault(),f(d,!1)}async function C(l){l.preventDefault(),f(d,!1);const _=l.dataTransfer?.files;if(_&&_.length>0)for(const M of Array.from(_))M.type.startsWith("image/")&&await G(M)}async function y(l){const _=l.clipboardData?.items;if(_){for(const M of Array.from(_))if(M.type.startsWith("image/")){l.preventDefault();const se=M.getAsFile();se&&await G(se)}}}function $(){A?.click()}function ae(){if(!b)return{top:0,left:0};const l=b,_=l.selectionStart,M=document.createElement("div"),se=window.getComputedStyle(l);["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"].forEach(_e=>{M.style[_e]=se[_e]}),M.style.position="absolute",M.style.visibility="hidden",M.style.whiteSpace="pre-wrap",M.style.wordWrap="break-word",document.body.appendChild(M);const ve=l.value.substring(0,_);M.textContent=ve;const me=document.createElement("span");me.textContent=l.value.substring(_)||".",M.appendChild(me);const he=l.getBoundingClientRect(),Me={top:he.top+me.offsetTop+parseInt(se.borderTopWidth)-l.scrollTop+20,left:he.left+me.offsetLeft+parseInt(se.borderLeftWidth)};return document.body.removeChild(M),Me}function re(l){const _=l.target,M=_.selectionStart,se=_.value.substring(0,M),de=se.lastIndexOf("@");if(de!==-1){const ve=se.substring(de+1),me=de>0?se[de-1]:" ",he=ve.includes(" ")||ve.includes(`
`);if((me===" "||me===`
`||de===0)&&!he){f(S,de,!0),f(I,ve,!0),f(x,ae(),!0),f(P,!0);return}}f(P,!1)}async function T(l){const _=b;if(!_)return;const M=_.selectionStart;if(!l.match(/nostr:nprofile1([a-z0-9]+)/))return;const de=ue.getUser({nprofile:l.replace("nostr:","")});await de.fetchProfile();const ve=de.profile?.nip05?`@${de.profile.nip05}`:`@${de.profile?.displayName||de.profile?.name||de.npub.slice(0,12)}`;N.set(ve,l);const me=n().substring(0,e(S)),he=n().substring(M);n(me+ve+" "+he);const Me=e(S)+ve.length+1;setTimeout(()=>{_.selectionStart=_.selectionEnd=Me,_.focus()},0),f(P,!1),f(I,"")}function j(){f(P,!1),f(I,"")}function Y(){let l=n();for(const[_,M]of N)for(;l.includes(_);)l=l.replace(_,M);return l}function oe(){n(""),N.clear(),f(u,[],!0),f(P,!1),f(I,"")}function D(l){e(P)||l.key==="Enter"&&l.stopPropagation()}var W={getContentWithNostrEntities:Y,reset:oe},Q=Zr(),V=X(Q),q=a(V);q.__change=E,it(q,l=>A=l,()=>A);var K=s(q,2),ce=a(K);Bt(ce),Zt(ce,g()),ce.__input=re,ce.__keydown=D,it(ce,l=>b=l,()=>b);var Pe=s(ce,2);{var ke=l=>{var _=Lr();Xe(_,23,()=>e(u),M=>M.preview,(M,se,de)=>{var ve=Ir(),me=a(ve),he=s(me,2);{var Me=Ce=>{var xe=Nr();r(Ce,xe)},_e=Ce=>{var xe=Dr();xe.__click=()=>L(e(de)),r(Ce,xe)};B(he,Ce=>{e(se).url?Ce(_e,!1):Ce(Me)})}o(ve),Z(()=>{Re(me,"src",e(se).preview),we(me,1,`w-20 h-20 object-cover rounded-lg border border ${e(se).url?"":"opacity-50 animate-pulse"}`)}),r(M,ve)}),o(_),r(l,_)};B(Pe,l=>{e(u).length>0&&l(ke)})}o(K);var ee=s(K,2),J=a(ee);{var fe=l=>{var _=be(),M=X(_);Dt(M,()=>t.relayButton),r(l,_)};B(J,l=>{t.relayButton&&l(fe)})}var ye=s(J,2);{let l=U(()=>i()||e(R));Ie(ye,{type:"button",variant:"ghost",size:"icon",onclick:$,get disabled(){return e(l)},class:"h-8 w-8",title:"Add image",children:(_,M)=>{var se=Br();r(_,se)},$$slots:{default:!0}})}var ie=s(ye,2);Mr(ie,{get onSelect(){return t.onMentionsChange},get disabled(){return i()},get selectedPubkeys(){return v()},set selectedPubkeys(l){v(l)}}),o(ee),o(V);var te=s(V,2);{var le=l=>{Tr(l,{get position(){return e(x)},get searchQuery(){return e(I)},onSelect:T,onClose:j})};B(te,l=>{e(P)&&l(le)})}return Z(()=>{we(V,1,`relative flex-1 flex flex-col ${p()??""}`),we(K,1,`flex-1 flex flex-col ${e(d)?"ring-2 ring-primary ring-offset-2 rounded-lg":""}`),Re(ce,"placeholder",c()),ce.disabled=i()}),qe("dragover",K,z),qe("dragleave",K,O),qe("drop",K,C),qe("paste",ce,y),It(ce,n),r(H,Q),Ae(W)}Le(["change","input","keydown","click"]);function Or(H){const t=He({selectedRelayUrls:[]}),n=U(()=>at.relays.filter(c=>c.enabled));return Ke(()=>{H()&&(at.selectedRelay?t.selectedRelayUrls=[at.selectedRelay]:t.selectedRelayUrls.length===0&&(t.selectedRelayUrls=e(n).filter(c=>c.write).map(c=>c.url)))}),{get selectedRelayUrls(){return t.selectedRelayUrls},set selectedRelayUrls(c){t.selectedRelayUrls=c},get allRelays(){return e(n)}}}var Wr=m('<div class="-mx-6 px-4 py-3 mb-4 border-b border-border bg-card/50"><div class="flex gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-1"><span class="font-semibold text-foreground text-sm"> </span> <span class="text-muted-foreground text-xs"> </span></div> <p class="text-muted-foreground text-sm line-clamp-3"> </p></div></div></div>'),Qr=m('<img alt="" class="w-5 h-5 rounded border border-background"/>'),qr=m('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center border border-background"><!></div>'),Kr=m('<div class="flex items-center -space-x-1"></div>'),Hr=m('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),Vr=m('<div class="relative"><!> <!></div>'),Gr=m('<div class="absolute top-full left-0 mt-2 bg-popover border border-border rounded-lg shadow-xl z-[100] w-80 max-h-[400px] overflow-y-auto transition-all duration-200"><!></div>'),Xr=m('<div class="relative"><!> <!></div>'),Yr=m('<div class="-mx-6 px-4 py-3 mb-4 border-y border-border bg-muted/30"><div class="text-xs text-muted-foreground mb-2">Quoting</div> <div class="border border-border rounded-lg overflow-hidden bg-card"><!></div></div>'),Jr=m('<div class="flex items-center justify-between -mx-6 -mt-6 px-4 py-3 mb-4 border-b border-border"><!> <!> <!></div> <!> <div class="relative mb-4"><!></div> <!>',1),$r=m('<div class="px-4 py-3 mb-4 border-b border-border bg-card/50 shrink-0"><div class="flex gap-3"><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-1"><span class="font-semibold text-foreground text-sm"> </span> <span class="text-muted-foreground text-xs"> </span></div> <p class="text-muted-foreground text-sm line-clamp-3"> </p></div></div></div>'),eo=m('<img alt="" class="w-5 h-5 rounded border border-background"/>'),to=m('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center border border-background"><!></div>'),ro=m('<div class="flex items-center -space-x-1"></div>'),oo=m('<span class="absolute -top-1 -right-1 bg-primary text-primary-foreground text-[10px] font-medium rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5"> </span>'),ao=m('<div class="relative"><!> <!></div>'),no=m('<div role="presentation" class="fixed inset-0 bg-black/50 z-[1002] flex items-center justify-center transition-opacity"><div role="dialog" tabindex="-1" class="bg-popover border border-border rounded-lg shadow-xl w-80 max-h-[400px] overflow-y-auto"><!></div></div>'),so=m('<div class="relative"><!> <!></div>'),lo=m('<div class="px-4 py-3 mb-4 border-y border-border bg-muted/30 shrink-0"><div class="text-xs text-muted-foreground mb-2">Quoting</div> <div class="border border-border rounded-lg overflow-hidden bg-card"><!></div></div>'),io=m('<div class="flex items-center justify-between px-4 py-3 mb-4 border-b border-border shrink-0"><!> <!> <!></div> <!> <div class="relative mb-4 flex-1 flex flex-col overflow-hidden px-4"><div class="flex-1 overflow-hidden"><!></div></div> <!>',1);function ft(H,t){Se(t,!0);const n=new Mt("(min-width: 768px)");let c=F(t,"open",15,!1),g=pe(""),i=pe(!1),p=pe(!1),v=pe(!1),h=pe(He([])),k,b=pe(null);Ke(()=>{if(!t.replyTo){f(b,null);return}t.replyTo.author.fetchProfile().then(z=>{f(b,z,!0)})});const A=Or(()=>c()),d=U(()=>A.selectedRelayUrls),u=U(()=>A.allRelays);async function R(){if(!(!e(g).trim()||e(i)||e(d).length===0))try{f(i,!0);const z=k?.getContentWithNostrEntities()??e(g);let O;t.replyTo?O=t.replyTo.reply():t.quotedEvent?(O=new vt(ue),O.kind=1,O.tag(t.quotedEvent,void 0,!1,"q")):(O=new vt(ue),O.kind=1),O.content=t.quotedEvent?`${z}
nostr:${t.quotedEvent.encode()}`:z,t.replyTo||(O.isProtected=e(v)),e(h).forEach(y=>{O.tags.push(["p",y])}),await O.sign();const C=qt.fromRelayUrls(e(d),ue);if(await O.publish(C),O.publishStatus==="error"){const y=O.publishError;console.error("Publish error object:",y),console.error("Relay errors:",y?.relayErrors);const $=y?.relayErrors||{},ae=Object.entries($);if(ae.length>0){const re=ae.map(([T,j])=>`â€¢ ${T.replace("wss://","")}: ${j}`).join(`
`);ze.error(`Failed to publish to relays:

${re}`)}else ze.error(`Failed to publish: ${y?.message||"Not enough relays received the event"}`);return}k?.reset(),f(g,""),f(h,[],!0),c(!1),ze.success(t.replyTo?"Reply published":t.quotedEvent?"Quote published":"Note published"),t.onPublished?.(),t.onClose?.()}catch(z){console.error("Failed to publish note:",z),ze.error(`Failed to publish: ${z instanceof Error?z.message:"Unknown error"}`)}finally{f(i,!1)}}function P(z){A.selectedRelayUrls.includes(z)?A.selectedRelayUrls=A.selectedRelayUrls.filter(O=>O!==z):A.selectedRelayUrls=[...A.selectedRelayUrls,z]}function I(z){A.selectedRelayUrls=[z],f(p,!1)}function S(){f(p,!1)}function x(){e(i)||(c(!1),f(g,""),f(h,[],!0),t.onClose?.())}function N(z){(z.metaKey||z.ctrlKey)&&z.key==="Enter"&&R()}var G=be();qe("keydown",gt,N);var w=X(G);{var L=z=>{var O=be(),C=X(O);ge(C,()=>jt,(y,$)=>{$(y,{get open(){return c()},onOpenChange:ae=>{ae?c(!0):x()},children:(ae,re)=>{var T=be(),j=X(T);ge(j,()=>Ut,(Y,oe)=>{oe(Y,{class:"md:max-w-2xl !overflow-visible",showCloseButton:!1,children:(D,W)=>{var Q=Jr(),V=X(Q),q=a(V);Ie(q,{variant:"ghost",size:"icon",onclick:x,get disabled(){return e(i)},class:"h-10 w-10",children:(ie,te)=>{Ze(ie,{name:"close",size:"lg"})},$$slots:{default:!0}});var K=s(q,2);ge(K,()=>Et,(ie,te)=>{te(ie,{class:"text-lg",children:(le,l)=>{Ee();var _=je();Z(()=>ne(_,t.replyTo?"Reply":t.quotedEvent?"Quote":"Compose")),r(le,_)},$$slots:{default:!0}})});var ce=s(K,2);{let ie=U(()=>!e(g).trim()||e(i)||e(d).length===0);Ie(ce,{onclick:R,get disabled(){return e(ie)},class:"rounded-full px-6",size:"sm",children:(te,le)=>{Ee();var l=je();Z(()=>ne(l,e(i)?"Publishing...":"Post")),r(te,l)},$$slots:{default:!0}})}o(V);var Pe=s(V,2);{var ke=ie=>{var te=Wr(),le=a(te),l=a(le);ge(l,()=>Oe.Root,(_e,Ce)=>{Ce(_e,{get ndk(){return ue},get pubkey(){return t.replyTo.pubkey},children:(xe,Fe)=>{var We=be(),Be=X(We);ge(Be,()=>Oe.Avatar,(Te,Ue)=>{Ue(Te,{class:"w-10 h-10"})}),r(xe,We)},$$slots:{default:!0}})});var _=s(l,2),M=a(_),se=a(M),de=a(se,!0);o(se);var ve=s(se,2),me=a(ve);o(ve),o(M);var he=s(M,2),Me=a(he,!0);o(he),o(_),o(le),o(te),Z((_e,Ce)=>{ne(de,_e),ne(me,`@${Ce??""}`),ne(Me,t.replyTo.content)},[()=>e(b).displayName||e(b).name||`${t.replyTo.pubkey.slice(0,8)}...`,()=>e(b).name||t.replyTo.pubkey.slice(0,8)]),r(ie,te)};B(Pe,ie=>{t.replyTo&&e(b)&&ie(ke)})}var ee=s(Pe,2),J=a(ee);{const ie=le=>{var l=Xr(),_=a(l);Ie(_,{type:"button",variant:"ghost",size:"icon",onclick:()=>f(p,!e(p)),get disabled(){return e(i)},class:"h-8 w-8",title:"Select relays",children:(de,ve)=>{var me=be(),he=X(me);{var Me=Ce=>{var xe=Kr();Xe(xe,21,()=>e(d),lt,(Fe,We)=>{const Be=U(()=>e(u).find(Ve=>Ve.url===e(We))),Te=U(()=>e(Be)?bt(e(Be).url):null);var Ue=be(),Qe=X(Ue);{var ot=Ve=>{var Ne=Qr();Z(()=>Re(Ne,"src",e(Te).info.icon)),r(Ve,Ne)},ct=Ve=>{var Ne=qr(),Ye=a(Ne);Ze(Ye,{name:"relay",size:"xs",class:"text-muted-foreground"}),o(Ne),r(Ve,Ne)};B(Qe,Ve=>{e(Te)?.info?.icon?Ve(ot):Ve(ct,!1)})}r(Fe,Ue)}),o(xe),r(Ce,xe)},_e=Ce=>{var xe=Vr(),Fe=a(xe);Ze(Fe,{name:"relay",size:"md"});var We=s(Fe,2);{var Be=Te=>{var Ue=Hr(),Qe=a(Ue,!0);o(Ue),Z(()=>ne(Qe,e(d).length)),r(Te,Ue)};B(We,Te=>{e(d).length>2&&Te(Be)})}o(xe),r(Ce,xe)};B(he,Ce=>{e(d).length<=2&&e(d).length>0?Ce(Me):Ce(_e,!1)})}r(de,me)},$$slots:{default:!0}});var M=s(_,2);{var se=de=>{var ve=Gr(),me=a(ve);xt(me,{get selectedRelayUrls(){return e(d)},onToggleRelay:P,onSelectOnly:I,get isProtected(){return e(v)},set isProtected(he){f(v,he,!0)}}),o(ve),Je(ve,(he,Me)=>st?.(he,Me),()=>S),r(de,ve)};B(M,de=>{e(p)&&de(se)})}o(l),r(le,l)};let te=U(()=>t.replyTo?"Write your reply...":t.quotedEvent?"Add your thoughts...":"What's on your mind?");it(kt(J,{get placeholder(){return e(te)},autofocus:!0,get disabled(){return e(i)},get value(){return e(g)},set value(le){f(g,le,!0)},get selectedMentions(){return e(h)},set selectedMentions(le){f(h,le,!0)},relayButton:ie,$$slots:{relayButton:!0}}),le=>k=le,()=>k)}o(ee);var fe=s(ee,2);{var ye=ie=>{var te=Yr(),le=s(a(te),2),l=a(le);Pt(l,{get event(){return t.quotedEvent},showActions:!1}),o(le),o(te),r(ie,te)};B(fe,ie=>{t.quotedEvent&&ie(ye)})}r(D,Q)},$$slots:{default:!0}})}),r(ae,T)},$$slots:{default:!0}})}),r(z,O)},E=z=>{var O=be(),C=X(O);ge(C,()=>Nt,(y,$)=>{$(y,{get open(){return c()},onOpenChange:ae=>{ae?c(!0):x()},children:(ae,re)=>{var T=be(),j=X(T);ge(j,()=>Ft,(Y,oe)=>{oe(Y,{class:"h-[95vh] flex flex-col !overflow-visible",children:(D,W)=>{var Q=io(),V=X(Q),q=a(V);Ie(q,{variant:"ghost",size:"icon",onclick:x,get disabled(){return e(i)},class:"h-10 w-10",children:(te,le)=>{Ze(te,{name:"close",size:"lg"})},$$slots:{default:!0}});var K=s(q,2);ge(K,()=>Tt,(te,le)=>{le(te,{class:"text-lg",children:(l,_)=>{Ee();var M=je();Z(()=>ne(M,t.replyTo?"Reply":t.quotedEvent?"Quote":"Compose")),r(l,M)},$$slots:{default:!0}})});var ce=s(K,2);{let te=U(()=>!e(g).trim()||e(i)||e(d).length===0);Ie(ce,{onclick:R,get disabled(){return e(te)},class:"rounded-full px-6",size:"sm",children:(le,l)=>{Ee();var _=je();Z(()=>ne(_,e(i)?"Publishing...":"Post")),r(le,_)},$$slots:{default:!0}})}o(V);var Pe=s(V,2);{var ke=te=>{var le=$r(),l=a(le),_=a(l);ge(_,()=>Oe.Root,(Ce,xe)=>{xe(Ce,{get ndk(){return ue},get pubkey(){return t.replyTo.pubkey},children:(Fe,We)=>{var Be=be(),Te=X(Be);ge(Te,()=>Oe.Avatar,(Ue,Qe)=>{Qe(Ue,{class:"w-10 h-10"})}),r(Fe,Be)},$$slots:{default:!0}})});var M=s(_,2),se=a(M),de=a(se),ve=a(de,!0);o(de);var me=s(de,2),he=a(me);o(me),o(se);var Me=s(se,2),_e=a(Me,!0);o(Me),o(M),o(l),o(le),Z((Ce,xe)=>{ne(ve,Ce),ne(he,`@${xe??""}`),ne(_e,t.replyTo.content)},[()=>e(b).displayName||e(b).name||`${t.replyTo.pubkey.slice(0,8)}...`,()=>e(b).name||t.replyTo.pubkey.slice(0,8)]),r(te,le)};B(Pe,te=>{t.replyTo&&e(b)&&te(ke)})}var ee=s(Pe,2),J=a(ee),fe=a(J);{const te=l=>{var _=so(),M=a(_);Ie(M,{type:"button",variant:"ghost",size:"icon",onclick:()=>f(p,!e(p)),get disabled(){return e(i)},class:"h-8 w-8",title:"Select relays",children:(ve,me)=>{var he=be(),Me=X(he);{var _e=xe=>{var Fe=ro();Xe(Fe,21,()=>e(d),lt,(We,Be)=>{const Te=U(()=>e(u).find(Ne=>Ne.url===e(Be))),Ue=U(()=>e(Te)?bt(e(Te).url):null);var Qe=be(),ot=X(Qe);{var ct=Ne=>{var Ye=eo();Z(()=>Re(Ye,"src",e(Ue).info.icon)),r(Ne,Ye)},Ve=Ne=>{var Ye=to(),Lt=a(Ye);Ze(Lt,{name:"relay",size:"xs",class:"text-muted-foreground"}),o(Ye),r(Ne,Ye)};B(ot,Ne=>{e(Ue)?.info?.icon?Ne(ct):Ne(Ve,!1)})}r(We,Qe)}),o(Fe),r(xe,Fe)},Ce=xe=>{var Fe=ao(),We=a(Fe);Ze(We,{name:"relay",size:"md"});var Be=s(We,2);{var Te=Ue=>{var Qe=oo(),ot=a(Qe,!0);o(Qe),Z(()=>ne(ot,e(d).length)),r(Ue,Qe)};B(Be,Ue=>{e(d).length>2&&Ue(Te)})}o(Fe),r(xe,Fe)};B(Me,xe=>{e(d).length<=2&&e(d).length>0?xe(_e):xe(Ce,!1)})}r(ve,he)},$$slots:{default:!0}});var se=s(M,2);{var de=ve=>{var me=no();me.__click=S,me.__keydown=_e=>_e.key==="Escape"&&S();var he=a(me);he.__click=_e=>_e.stopPropagation(),he.__keydown=_e=>_e.stopPropagation();var Me=a(he);xt(Me,{get selectedRelayUrls(){return e(d)},onToggleRelay:P,onSelectOnly:I,get isProtected(){return e(v)},set isProtected(_e){f(v,_e,!0)}}),o(he),o(me),Je(me,_e=>dt?.(_e)),r(ve,me)};B(se,ve=>{e(p)&&ve(de)})}o(_),r(l,_)};let le=U(()=>t.replyTo?"Write your reply...":t.quotedEvent?"Add your thoughts...":"What's on your mind?");it(kt(fe,{get placeholder(){return e(le)},autofocus:!0,get disabled(){return e(i)},class:"flex-1 overflow-hidden",get value(){return e(g)},set value(l){f(g,l,!0)},get selectedMentions(){return e(h)},set selectedMentions(l){f(h,l,!0)},relayButton:te,$$slots:{relayButton:!0}}),l=>k=l,()=>k)}o(J),o(ee);var ye=s(ee,2);{var ie=te=>{var le=lo(),l=s(a(le),2),_=a(l);Pt(_,{get event(){return t.quotedEvent},showActions:!1}),o(l),o(le),r(te,le)};B(ye,te=>{t.quotedEvent&&te(ie)})}r(D,Q)},$$slots:{default:!0}})}),r(ae,T)},$$slots:{default:!0}})}),r(z,O)};B(w,z=>{n.current?z(L):z(E,!1)})}r(H,G),Ae()}Le(["click","keydown"]);var uo=m('<div class="absolute inset-0 bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity"></div> <div class="relative flex flex-col items-center gap-2"><span class="text-2xl"> </span> <span> </span></div>',1),co=m('<div class="p-4 rounded-2xl bg-primary/20 border-2 border-primary/30"><div class="flex items-center justify-between"><span class="text-sm text-foreground/70">Selected Amount:</span> <span class="text-2xl font-bold text-foreground"> </span></div></div>'),vo=m('<span class="text-xl mr-2">âš¡</span> ',1),fo=m("<!> <!>",1),go=m('<div class="relative -mx-6 -mt-6 px-6 py-6 mb-6 border-b border-border bg-primary/10"><div class="absolute inset-0 bg-primary/5 blur-xl"></div> <div class="relative flex items-center gap-3"><div class="w-12 h-12 rounded-full bg-primary flex items-center justify-center shadow-lg shadow-primary/50"><span class="text-2xl">âš¡</span></div> <div><!> <!></div></div></div> <div class="space-y-6"><div class="grid grid-cols-4 gap-3"></div> <div class="space-y-2"><!> <div class="relative"><!> <div class="absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground font-semibold">sats</div></div></div> <!> <!></div>',1),po=m('<div class="absolute inset-0 bg-primary/5 opacity-0 group-hover:opacity-100 transition-opacity"></div> <div class="relative flex flex-col items-center gap-2"><span class="text-2xl"> </span> <span> </span></div>',1),mo=m('<div class="p-4 rounded-2xl bg-primary/20 border-2 border-primary/30"><div class="flex items-center justify-between"><span class="text-sm text-foreground/70">Selected Amount:</span> <span class="text-2xl font-bold text-foreground"> </span></div></div>'),bo=m('<span class="text-xl mr-2">âš¡</span> ',1),ho=m('<div class="flex gap-3"><!> <!></div>'),xo=m('<div class="relative px-6 py-6 mb-6 border-b border-border bg-primary/10"><div class="absolute inset-0 bg-primary/5 blur-xl"></div> <div class="relative flex items-center gap-3"><div class="w-12 h-12 rounded-full bg-primary flex items-center justify-center shadow-lg shadow-primary/50"><span class="text-2xl">âš¡</span></div> <div><!> <!></div></div></div> <div class="space-y-6 px-4"><div class="grid grid-cols-4 gap-3"></div> <div class="space-y-2"><!> <div class="relative"><!> <div class="absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground font-semibold">sats</div></div></div> <!></div> <!>',1);function yo(H,t){Se(t,!0);const n=new Mt("(min-width: 768px)");let c=F(t,"open",15,!1);const g=[{value:10,label:"10",emoji:"â˜•"},{value:21,label:"21",emoji:"âš¡"},{value:50,label:"50",emoji:"ðŸ¤™"},{value:100,label:"100",emoji:"ðŸ’¯"},{value:500,label:"500",emoji:"ðŸ”¥"},{value:1e3,label:"1K",emoji:"ðŸ’Ž"},{value:2100,label:"2.1K",emoji:"ðŸš€"},{value:5e3,label:"5K",emoji:"ðŸ‘‘"}];let i=pe(He(at.zap.defaultAmount)),p=pe(""),v=pe(!1);function h(I){f(i,I,!0),f(v,!1),f(p,"")}function k(){f(v,!0);const I=Number.parseInt(e(p));!Number.isNaN(I)&&I>0&&f(i,I,!0)}function b(){e(i)>0&&t.onZap(e(i))}function A(I){I.key==="Enter"&&e(i)>0&&b()}var d=be();qe("keydown",gt,A);var u=X(d);{var R=I=>{var S=be(),x=X(S);ge(x,()=>jt,(N,G)=>{G(N,{get open(){return c()},onOpenChange:w=>{w?c(!0):t.onCancel()},children:(w,L)=>{var E=be(),z=X(E);ge(z,()=>Ut,(O,C)=>{C(O,{class:"max-w-md bg-background border-2 border-primary/30 shadow-2xl shadow-primary/50",children:(y,$)=>{var ae=go(),re=X(ae),T=s(a(re),2),j=s(a(T),2),Y=a(j);ge(Y,()=>Et,(ee,J)=>{J(ee,{class:"text-xl text-foreground",children:(fe,ye)=>{Ee();var ie=je("Zap Amount");r(fe,ie)},$$slots:{default:!0}})});var oe=s(Y,2);ge(oe,()=>Yt,(ee,J)=>{J(ee,{class:"text-sm text-muted-foreground",children:(fe,ye)=>{Ee();var ie=je("Choose your zap amount");r(fe,ie)},$$slots:{default:!0}})}),o(j),o(T),o(re);var D=s(re,2),W=a(D);Xe(W,21,()=>g,lt,(ee,J)=>{{let fe=U(()=>e(i)===e(J).value&&!e(v)?"bg-primary shadow-lg shadow-primary/50 scale-105":"bg-muted hover:bg-muted/80 hover:scale-105");Ie(ee,{variant:"ghost",onclick:()=>h(e(J).value),get class(){return`group relative overflow-hidden rounded-2xl p-4 h-auto transition-all duration-200 ${e(fe)??""}`},children:(ye,ie)=>{var te=uo(),le=s(X(te),2),l=a(le),_=a(l,!0);o(l);var M=s(l,2),se=a(M,!0);o(M),o(le),Z(()=>{ne(_,e(J).emoji),we(M,1,`text-xs font-bold ${e(i)===e(J).value&&!e(v)?"text-primary-foreground":"text-foreground"}`),ne(se,e(J).label)}),r(ye,te)},$$slots:{default:!0}})}}),o(W);var Q=s(W,2),V=a(Q);_t(V,{for:"custom-amount",class:"text-sm font-semibold text-muted-foreground",children:(ee,J)=>{Ee();var fe=je("Custom Amount");r(ee,fe)},$$slots:{default:!0}});var q=s(V,2),K=a(q);{let ee=U(()=>e(v)?"border-primary":"border-border");ht(K,{id:"custom-amount",type:"number",oninput:k,placeholder:"Enter custom amount...",get class(){return`w-full px-4 py-4 bg-muted border-2 ${e(ee)??""} rounded-2xl text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:border-primary transition-colors text-lg font-semibold pr-16`},get value(){return e(p)},set value(J){f(p,J,!0)}})}Ee(2),o(q),o(Q);var ce=s(Q,2);{var Pe=ee=>{var J=co(),fe=a(J),ye=s(a(fe),2),ie=a(ye);o(ye),o(fe),o(J),Z(te=>ne(ie,`${te??""} sats`),[()=>e(i).toLocaleString()]),r(ee,J)};B(ce,ee=>{e(i)>0&&ee(Pe)})}var ke=s(ce,2);ge(ke,()=>er,(ee,J)=>{J(ee,{class:"flex gap-3 sm:space-x-0",children:(fe,ye)=>{var ie=fo(),te=X(ie);Ie(te,{variant:"outline",get onclick(){return t.onCancel},class:"flex-1 px-6 py-4 rounded-2xl",children:(l,_)=>{Ee();var M=je("Cancel");r(l,M)},$$slots:{default:!0}});var le=s(te,2);{let l=U(()=>e(i)<=0);Ie(le,{onclick:b,get disabled(){return e(l)},class:"flex-1 px-6 py-4 rounded-2xl bg-primary hover:opacity-90 shadow-lg shadow-primary/50 hover:shadow-primary/70 disabled:opacity-50 disabled:shadow-none",children:(_,M)=>{var se=vo(),de=s(X(se));Z(ve=>ne(de,` Zap ${ve??""}`),[()=>e(i)>0?e(i).toLocaleString():""]),r(_,se)},$$slots:{default:!0}})}r(fe,ie)},$$slots:{default:!0}})}),o(D),r(y,ae)},$$slots:{default:!0}})}),r(w,E)},$$slots:{default:!0}})}),r(I,S)},P=I=>{var S=be(),x=X(S);ge(x,()=>Nt,(N,G)=>{G(N,{get open(){return c()},onOpenChange:w=>{w?c(!0):t.onCancel()},children:(w,L)=>{var E=be(),z=X(E);ge(z,()=>Ft,(O,C)=>{C(O,{children:(y,$)=>{var ae=xo(),re=X(ae),T=s(a(re),2),j=s(a(T),2),Y=a(j);ge(Y,()=>Tt,(ee,J)=>{J(ee,{class:"text-xl text-foreground",children:(fe,ye)=>{Ee();var ie=je("Zap Amount");r(fe,ie)},$$slots:{default:!0}})});var oe=s(Y,2);ge(oe,()=>Jt,(ee,J)=>{J(ee,{class:"text-sm text-muted-foreground",children:(fe,ye)=>{Ee();var ie=je("Choose your zap amount");r(fe,ie)},$$slots:{default:!0}})}),o(j),o(T),o(re);var D=s(re,2),W=a(D);Xe(W,21,()=>g,lt,(ee,J)=>{{let fe=U(()=>e(i)===e(J).value&&!e(v)?"bg-primary shadow-lg shadow-primary/50 scale-105":"bg-muted hover:bg-muted/80 hover:scale-105");Ie(ee,{variant:"ghost",onclick:()=>h(e(J).value),get class(){return`group relative overflow-hidden rounded-2xl p-4 h-auto transition-all duration-200 ${e(fe)??""}`},children:(ye,ie)=>{var te=po(),le=s(X(te),2),l=a(le),_=a(l,!0);o(l);var M=s(l,2),se=a(M,!0);o(M),o(le),Z(()=>{ne(_,e(J).emoji),we(M,1,`text-xs font-bold ${e(i)===e(J).value&&!e(v)?"text-primary-foreground":"text-foreground"}`),ne(se,e(J).label)}),r(ye,te)},$$slots:{default:!0}})}}),o(W);var Q=s(W,2),V=a(Q);_t(V,{for:"custom-amount",class:"text-sm font-semibold text-muted-foreground",children:(ee,J)=>{Ee();var fe=je("Custom Amount");r(ee,fe)},$$slots:{default:!0}});var q=s(V,2),K=a(q);{let ee=U(()=>e(v)?"border-primary":"border-border");ht(K,{id:"custom-amount",type:"number",oninput:k,placeholder:"Enter custom amount...",get class(){return`w-full px-4 py-4 bg-muted border-2 ${e(ee)??""} rounded-2xl text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:border-primary transition-colors text-lg font-semibold pr-16`},get value(){return e(p)},set value(J){f(p,J,!0)}})}Ee(2),o(q),o(Q);var ce=s(Q,2);{var Pe=ee=>{var J=mo(),fe=a(J),ye=s(a(fe),2),ie=a(ye);o(ye),o(fe),o(J),Z(te=>ne(ie,`${te??""} sats`),[()=>e(i).toLocaleString()]),r(ee,J)};B(ce,ee=>{e(i)>0&&ee(Pe)})}o(D);var ke=s(D,2);ge(ke,()=>$t,(ee,J)=>{J(ee,{class:"pt-2",children:(fe,ye)=>{var ie=ho(),te=a(ie);Ie(te,{variant:"outline",get onclick(){return t.onCancel},class:"flex-1 px-6 py-4 rounded-2xl",children:(l,_)=>{Ee();var M=je("Cancel");r(l,M)},$$slots:{default:!0}});var le=s(te,2);{let l=U(()=>e(i)<=0);Ie(le,{onclick:b,get disabled(){return e(l)},class:"flex-1 px-6 py-4 rounded-2xl bg-primary hover:opacity-90 shadow-lg shadow-primary/50 hover:shadow-primary/70 disabled:opacity-50 disabled:shadow-none",children:(_,M)=>{var se=bo(),de=s(X(se));Z(ve=>ne(de,` Zap ${ve??""}`),[()=>e(i)>0?e(i).toLocaleString():""]),r(_,se)},$$slots:{default:!0}})}o(ie),r(fe,ie)},$$slots:{default:!0}})}),r(y,ae)},$$slots:{default:!0}})}),r(w,E)},$$slots:{default:!0}})}),r(I,S)};B(u,I=>{n.current?I(R):I(P,!1)})}r(H,d),Ae()}var _o=De('<svg class="w-6 h-6 animate-spin text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>'),wo=De('<path d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),ko=De('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),Co=De('<svg stroke="currentColor" viewBox="0 0 24 24"><!></svg>'),Po=m('<button type="button"><div><!></div> <span class="text-xs font-semibold text-white"><!></span></button>'),Ro=De('<svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>'),zo=De('<svg class="w-5 h-5 animate-pulse" fill="currentColor" viewBox="0 0 24 24"><path d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>'),So=De('<path d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),Ao=De('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>'),Mo=De('<svg class="w-5 h-5" stroke="currentColor" viewBox="0 0 24 24"><!></svg>'),Uo=m('<span class="text-xs opacity-70"> </span>'),Eo=m(" <!>",1),jo=m('<button type="button"><!> <span class="text-sm group-hover:underline"><!></span></button>'),Fo=m("<!> <!>",1);function Ct(H,t){Se(t,!0);const n=F(t,"variant",3,"default"),c=ue.$zaps(()=>({target:t.event,validated:!0})),g=U(()=>{const w=ue.$currentPubkey;return w?Kt(c.events,w):!1}),i=U(()=>{const w=c.totalAmount;return w>=1e6?`${(w/1e6).toFixed(1)}M`:w>=1e3?`${(w/1e3).toFixed(1)}K`:w.toString()});let p=pe(!1),v=pe(!1),h=pe(!1),k=null;async function b(w){if(!ue.signer){ze.error("Please login to zap");return}f(v,!0);try{await new Rt(t.event,w*1e3,"msat").zap(),f(h,!0),setTimeout(()=>f(h,!1),2e3),ze.success(`Zapped ${w} sats!`)}catch(L){console.error("Failed to zap:",L);const E=L instanceof Error?L.message:"Failed to send zap";E.includes("wallet")||E.includes("NWC")?ze.error("Lightning wallet error. Please check your wallet connection in settings."):E.includes("invoice")?ze.error("Failed to create invoice. The recipient may not have a Lightning address configured."):ze.error("Failed to send zap. Please try again.")}finally{f(v,!1)}}async function A(w){w.stopPropagation(),!(e(v)||!ue.signer)&&await b(at.zap.defaultAmount)}function d(w){f(p,!1),b(w)}function u(w){w.preventDefault(),w.stopPropagation(),k=setTimeout(()=>{f(p,!0),k=null},500)}function R(w){k&&(clearTimeout(k),k=null,(w.type==="mouseup"||w.type==="touchend")&&A(w))}function P(){k&&(clearTimeout(k),k=null)}var I=Fo(),S=X(I);{var x=w=>{var L=Po();L.__mousedown=u,L.__mouseup=R,L.__touchstart=u,L.__touchend=R;var E=a(L),z=a(E);{var O=T=>{var j=_o();r(T,j)},C=T=>{var j=Co(),Y=a(j);{var oe=W=>{var Q=wo();r(W,Q)},D=W=>{var Q=ko();r(W,Q)};B(Y,W=>{e(g)?W(oe):W(D,!1)})}o(j),Z(()=>{we(j,0,`w-6 h-6 transition-colors ${e(g)?"text-yellow-400":"text-white"}`),Re(j,"fill",e(g)?"currentColor":"none")}),r(T,j)};B(z,T=>{e(v)?T(O):T(C,!1)})}o(E);var y=s(E,2),$=a(y);{var ae=T=>{var j=je();Z(()=>ne(j,e(i))),r(T,j)},re=T=>{var j=je("Zap");r(T,j)};B($,T=>{c.totalAmount>0?T(ae):T(re,!1)})}o(y),o(L),Z(()=>{L.disabled=e(v),we(L,1,`flex flex-col items-center gap-1 hover:scale-110 transition-transform group ${e(v)?"opacity-50 cursor-wait":""}`),we(E,1,`w-12 h-12 rounded-full backdrop-blur-sm flex items-center justify-center transition-colors ${e(h)?"bg-yellow-400/30":e(g)?"bg-yellow-400/20":"bg-white/20"}`)}),qe("mouseleave",L,P),qe("touchcancel",L,P),r(w,L)},N=w=>{var L=jo();L.__mousedown=u,L.__mouseup=R,L.__touchstart=u,L.__touchend=R;var E=a(L);{var z=re=>{var T=Ro();r(re,T)},O=re=>{var T=be(),j=X(T);{var Y=D=>{var W=zo();r(D,W)},oe=D=>{var W=Mo(),Q=a(W);{var V=K=>{var ce=So();r(K,ce)},q=K=>{var ce=Ao();r(K,ce)};B(Q,K=>{e(g)?K(V):K(q,!1)})}o(W),Z(()=>Re(W,"fill",e(g)?"currentColor":"none")),r(D,W)};B(j,D=>{e(h)?D(Y):D(oe,!1)},!0)}r(re,T)};B(E,re=>{e(v)?re(z):re(O,!1)})}var C=s(E,2),y=a(C);{var $=re=>{var T=je("Zapped!");r(re,T)},ae=re=>{var T=be(),j=X(T);{var Y=D=>{var W=je("Zapping...");r(D,W)},oe=D=>{var W=be(),Q=X(W);{var V=K=>{var ce=Eo(),Pe=X(ce),ke=s(Pe);{var ee=J=>{var fe=Uo(),ye=a(fe);o(fe),Z(()=>ne(ye,`(${c.count??""})`)),r(J,fe)};B(ke,J=>{c.count>0&&J(ee)})}Z(()=>ne(Pe,`${e(i)??""} `)),r(K,ce)},q=K=>{var ce=je("Zap");r(K,ce)};B(Q,K=>{c.totalAmount>0?K(V):K(q,!1)},!0)}r(D,W)};B(j,D=>{e(v)?D(Y):D(oe,!1)},!0)}r(re,T)};B(y,re=>{e(h)?re($):re(ae,!1)})}o(C),o(L),Z(()=>{L.disabled=e(v),we(L,1,`relative flex items-center gap-2 transition-colors group ${e(h)||e(g)?"text-yellow-400":"text-muted-foreground hover:text-yellow-400"} ${e(v)?"opacity-50 cursor-wait":""}`)}),qe("mouseleave",L,P),qe("touchcancel",L,P),r(w,L)};B(S,w=>{n()==="tiktok"?w(x):w(N,!1)})}var G=s(S,2);yo(G,{get event(){return t.event},onZap:d,onCancel:()=>f(p,!1),get open(){return e(p)},set open(w){f(p,w,!0)}}),r(H,I),Ae()}Le(["mousedown","mouseup","touchstart","touchend"]);var To=m('<div class="absolute bottom-full mb-2 right-0 bg-popover border border-border rounded-lg shadow-xl z-50 min-w-[180px] overflow-hidden"><button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <div><div class="font-medium">Repost</div> <div class="text-xs text-muted-foreground">Share instantly</div></div></button> <button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3 border-t border-border"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg> <div><div class="font-medium">Quote</div> <div class="text-xs text-muted-foreground">Add your thoughts</div></div></button></div>'),No=m('<div class="flex flex-col items-center gap-6 text-white"><button type="button" class="flex flex-col items-center gap-1 hover:scale-110 transition-transform group"><div class="w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center"><!></div> <span class="text-xs font-semibold"> </span></button> <div class="relative"><button type="button" class="flex flex-col items-center gap-1 hover:scale-110 transition-transform group"><div class="w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center"><!></div> <span class="text-xs font-semibold"> </span></button> <!></div> <button type="button" class="flex flex-col items-center gap-1 hover:scale-110 transition-transform group"><div><!></div> <span class="text-xs font-semibold"> </span></button> <!></div>'),Do=m('<div class="absolute bottom-full mb-2 left-0 bg-popover border border-border rounded-lg shadow-xl z-50 min-w-[180px] overflow-hidden"><button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3"><!> <div><div class="font-medium">Repost</div> <div class="text-xs text-muted-foreground">Share instantly</div></div></button> <button class="w-full px-4 py-3 text-left hover:bg-muted transition-colors flex items-center gap-3 border-t border-border"><!> <div><div class="font-medium">Quote</div> <div class="text-xs text-muted-foreground">Add your thoughts</div></div></button></div>'),Io=m('<div><button type="button" class="flex items-center gap-2 hover:text-primary transition-colors group"><!> <span class="text-sm group-hover:underline"> </span></button> <div class="relative"><button type="button" class="flex items-center gap-2 hover:text-green-400 transition-colors group"><!> <span class="text-sm group-hover:underline"> </span></button> <!></div> <!> <!></div>'),Lo=m("<!> <!> <!>",1);function Ka(H,t){Se(t,!0);const n=F(t,"variant",3,"default");let c=pe(!1),g=pe(!1),i=pe(!1);const p=ue.$subscribe(()=>({filters:[{kinds:[1,1111,6,16],...t.event.filter()}],subId:"interactions"})),v=U(()=>Array.from(p.events??[]).filter(x=>x.kind===1||x.kind===1111).length),h=U(()=>Array.from(p.events??[]).filter(x=>x.kind===6||x.kind===16).length),k=U(()=>n()!=="tiktok"?null:St(()=>({event:t.event}),ue)),b=U(()=>e(k)?e(k).get("â¤ï¸")??{count:0,hasReacted:!1,pubkeys:[],emoji:"â¤ï¸"}:{count:0,hasReacted:!1});async function A(){if(!ue.signer){ze.error("Please login to repost");return}try{await t.event.repost(),ze.success("Note reposted")}catch(x){console.error("Failed to repost:",x),ze.error("Failed to repost")}}var d=Lo(),u=X(d);{var R=x=>{var N=No(),G=a(N);G.__click=q=>{q.stopPropagation(),f(c,!0)};var w=a(G),L=a(w);Ze(L,{name:"message",size:"lg"}),o(w);var E=s(w,2),z=a(E,!0);o(E),o(G);var O=s(G,2),C=a(O);C.__click=q=>{q.stopPropagation(),f(i,!e(i))};var y=a(C),$=a(y);Ze($,{name:"repost",size:"lg"}),o(y);var ae=s(y,2),re=a(ae,!0);o(ae),o(C);var T=s(C,2);{var j=q=>{var K=To();K.__click=ke=>ke.stopPropagation();var ce=a(K);ce.__click=ke=>{ke.stopPropagation(),f(i,!1),A()};var Pe=s(ce,2);Pe.__click=ke=>{ke.stopPropagation(),f(i,!1),f(g,!0)},o(K),Je(K,(ke,ee)=>st?.(ke,ee),()=>()=>f(i,!1)),r(q,K)};B(T,q=>{e(i)&&q(j)})}o(O);var Y=s(O,2);Y.__click=q=>{q.stopPropagation(),e(k)&&e(k).react("â¤ï¸").catch(K=>{console.error("Failed to react:",K),ze.error("Failed to add reaction")})};var oe=a(Y),D=a(oe);{let q=U(()=>e(b).hasReacted?"animate-[heartbeat_0.3s_ease-in-out]":"");Ze(D,{name:"heart-filled",size:"lg",get class(){return e(q)}})}o(oe);var W=s(oe,2),Q=a(W,!0);o(W),o(Y);var V=s(Y,2);Ct(V,{get event(){return t.event},variant:"tiktok"}),o(N),Z(()=>{ne(z,e(v)),ne(re,e(h)),we(oe,1,`w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center text-red-400 transition-colors ${e(b).hasReacted?"bg-red-400/30":""}`),ne(Q,e(b).count)}),r(x,N)},P=x=>{var N=Io(),G=a(N);G.__click=Y=>{Y.stopPropagation(),f(c,!0)};var w=a(G);Ze(w,{name:"message",size:"md"});var L=s(w,2),E=a(L,!0);o(L),o(G);var z=s(G,2),O=a(z);O.__click=Y=>{Y.stopPropagation(),f(i,!e(i))};var C=a(O);Ze(C,{name:"repost",size:"md"});var y=s(C,2),$=a(y,!0);o(y),o(O);var ae=s(O,2);{var re=Y=>{var oe=Do();oe.__click=q=>q.stopPropagation();var D=a(oe);D.__click=q=>{q.stopPropagation(),f(i,!1),A()};var W=a(D);Ze(W,{name:"repost",size:"md"}),Ee(2),o(D);var Q=s(D,2);Q.__click=q=>{q.stopPropagation(),f(i,!1),f(g,!0)};var V=a(Q);Ze(V,{name:"message",size:"md"}),Ee(2),o(Q),o(oe),Je(oe,(q,K)=>st?.(q,K),()=>()=>f(i,!1)),r(Y,oe)};B(ae,Y=>{e(i)&&Y(re)})}o(z);var T=s(z,2);Ht(T,{get event(){return t.event},emoji:"â¤ï¸",class:"hover:text-red-400 transition-colors group [&>span]:text-sm [&>span]:group-hover:underline"});var j=s(T,2);Ct(j,{get event(){return t.event}}),o(N),Z(()=>{we(N,1,`flex items-center gap-3 sm:gap-6 ${n()==="thread-main"?"border-t border-border pt-3":""} text-muted-foreground`),ne(E,e(v)),ne($,e(h))}),r(x,N)};B(u,x=>{n()==="tiktok"?x(R):x(P,!1)})}var I=s(u,2);ft(I,{get replyTo(){return t.event},get open(){return e(c)},set open(x){f(c,x,!0)}});var S=s(I,2);ft(S,{get quotedEvent(){return t.event},get open(){return e(g)},set open(x){f(g,x,!0)}}),r(H,d),Ae()}Le(["click"]);function Bo(H,t){const n=U(H),c=U(()=>e(n).pubkeys),g=U(()=>mt(e(n).skipCurrentUser,!1)),i=U(()=>mt(e(n).onlyFollows,!1)),p=U(()=>t?.$follows||new Set),v=U(()=>t?.$currentPubkey),h=U(()=>{if(!t)return[];let d=e(c);return e(g)&&e(v)&&(d=d.filter(u=>u!==e(v))),e(i)&&e(v)&&(d=d.filter(u=>e(p).has(u))),d.map(u=>t.getUser({pubkey:u}))}),k=U(()=>e(h).filter(d=>e(p).has(d.pubkey))),b=U(()=>e(h).filter(d=>!e(p).has(d.pubkey))),A=U(()=>[...e(k),...e(b)]);return{get users(){return e(A)},get followedUsers(){return e(k)},get unfollowedUsers(){return e(b)}}}var Zo=m('<button type="button" class="block p-0 border-none bg-none cursor-pointer transition-transform duration-200 hover:scale-110 hover:!z-[9999] focus-visible:outline-2 focus-visible:outline-primary focus-visible:outline-offset-2 focus-visible:rounded-full"><!></button>'),Oo=m('<div data-avatar-group="" class="avatar-wrapper"><!></div>'),Wo=m('<div data-avatar-group="" class="relative transition-transform duration-200"><!></div>'),Qo=m('<button type="button" class="p-0 border-none bg-none cursor-pointer font-semibold text-muted-foreground transition-colors hover:text-foreground focus-visible:outline-2 focus-visible:outline-primary focus-visible:outline-offset-2 focus-visible:rounded"> </button>'),qo=m('<span class="inline-block"> </span>'),Ko=m('<div data-avatar-group="" class="flex items-center font-semibold text-muted-foreground"><!></div>'),Ho=m('<button type="button" class="w-full h-full rounded-full border-none bg-none cursor-pointer flex items-center justify-center font-semibold text-muted-foreground transition-all duration-200 hover:bg-muted-hover hover:text-foreground hover:scale-110 focus-visible:outline-2 focus-visible:outline-primary focus-visible:outline-offset-2"> </button>'),Vo=m('<div class="w-full h-full flex items-center justify-center"> </div>'),Go=m('<div data-avatar-group="" class="relative rounded-full bg-muted border-2 border-background flex items-center justify-center font-semibold text-muted-foreground flex-shrink-0"><!></div>'),Xo=m('<div data-avatar-group="" role="group" aria-label="User avatars"><!> <!></div>');function ut(H,t){Se(t,!0);let n=F(t,"pubkeys",19,()=>[]),c=F(t,"skipCurrentUser",3,!1),g=F(t,"onlyFollows",3,!1),i=F(t,"max",3,5),p=F(t,"size",3,40),v=F(t,"spacing",3,"normal"),h=F(t,"overflowVariant",3,"avatar"),k=F(t,"direction",3,"horizontal"),b=F(t,"class",3,"");const A=Bo(()=>({pubkeys:n(),skipCurrentUser:c(),onlyFollows:g()}),t.ndk),d=U(()=>A.users.slice(0,i())),u=U(()=>Math.max(0,A.users.length-i())),P={tight:-8,normal:-12,loose:-6}[v()],I=U(()=>k()==="vertical");var S=Xo(),x=a(S);Xe(x,19,()=>e(d),w=>w.pubkey,(w,L,E)=>{var z=Wo();let O;var C=a(z);ge(C,()=>Oe.Root,(y,$)=>{$(y,{get ndk(){return t.ndk},get user(){return e(L)},children:(ae,re)=>{var T=be(),j=X(T);{var Y=D=>{var W=Zo();W.__click=()=>t.onAvatarClick?.(e(L));let Q;var V=a(W);ge(V,()=>Oe.Avatar,(q,K)=>{K(q,{class:"ring-2 ring-background w-full h-full"})}),o(W),Z(()=>Q=$e(W,"",Q,{width:`${p()??""}px`,height:`${p()??""}px`})),r(D,W)},oe=D=>{var W=Oo();let Q;var V=a(W);ge(V,()=>Oe.Avatar,(q,K)=>{K(q,{class:"ring-2 ring-background w-full h-full"})}),o(W),Z(()=>Q=$e(W,"",Q,{width:`${p()??""}px`,height:`${p()??""}px`})),r(D,W)};B(j,D=>{t.onAvatarClick?D(Y):D(oe,!1)})}r(ae,T)},$$slots:{default:!0}})}),o(z),Z(()=>O=$e(z,"",O,{"margin-left":!e(I)&&e(E)!==0?`${P}px`:"0","margin-top":e(I)&&e(E)!==0?`${P}px`:"0","z-index":e(d).length-e(E)})),r(w,z)});var N=s(x,2);{var G=w=>{var L=be(),E=X(L);{var z=C=>{var y=be(),$=X(y);Dt($,()=>t.overflowSnippet,()=>e(u)),r(C,y)},O=C=>{var y=be(),$=X(y);{var ae=T=>{var j=Ko();let Y;var oe=a(j);{var D=Q=>{var V=Qo();V.__click=function(...K){t.onOverflowClick?.apply(this,K)};var q=a(V);o(V),Z(()=>ne(q,`+${e(u)??""}`)),r(Q,V)},W=Q=>{var V=qo(),q=a(V);o(V),Z(()=>ne(q,`+${e(u)??""}`)),r(Q,V)};B(oe,Q=>{t.onOverflowClick?Q(D):Q(W,!1)})}o(j),Z(()=>Y=$e(j,"",Y,{"margin-left":e(I)?"0":"8px","margin-top":e(I)?"8px":"0"})),r(T,j)},re=T=>{var j=Go();let Y;var oe=a(j);{var D=Q=>{var V=Ho();V.__click=function(...K){t.onOverflowClick?.apply(this,K)};var q=a(V);o(V),Z(()=>ne(q,`+${e(u)??""}`)),r(Q,V)},W=Q=>{var V=Vo(),q=a(V);o(V),Z(()=>ne(q,`+${e(u)??""}`)),r(Q,V)};B(oe,Q=>{t.onOverflowClick?Q(D):Q(W,!1)})}o(j),Z(()=>Y=$e(j,"",Y,{"margin-left":e(I)?"0":`${P}px`,"margin-top":e(I)?`${P}px`:"0",width:`${p()??""}px`,height:`${p()??""}px`,"font-size":`${p()*.35}px`,"z-index":0})),r(T,j)};B($,T=>{h()==="text"?T(ae):T(re,!1)},!0)}r(C,y)};B(E,C=>{t.overflowSnippet?C(z):C(O,!1)})}r(w,L)};B(N,w=>{e(u)>0&&h()!=="none"&&w(G)})}o(S),Z(w=>we(S,1,w),[()=>Ge(pt("relative flex",e(I)?"flex-col items-start":"items-center",b()))]),r(H,S),Ae()}Le(["click"]);var Yo=m('<span class="text-sm font-medium text-muted-foreground"> </span>'),Jo=m("<!> <!>",1),$o=m('<button data-repost-button-avatars="" type="button"><!> <!></button>');function ea(H,t){Se(t,!0);let n=F(t,"variant",3,"ghost"),c=F(t,"max",3,3),g=F(t,"avatarSize",3,24),i=F(t,"spacing",3,"tight"),p=F(t,"showCount",3,!0),v=F(t,"onlyFollows",3,!0),h=F(t,"class",3,"");const k=rt("ndk"),b=t.ndk||k,A=ar(()=>({event:t.event}),b),d=nt({base:"inline-flex items-center gap-2 cursor-pointer font-medium text-sm transition-all rounded-md outline-none disabled:pointer-events-none disabled:opacity-50",variants:{variant:{ghost:"px-3 py-2 hover:bg-accent hover:text-accent-foreground",outline:"px-3 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border",pill:"px-4 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border rounded-full",solid:"px-4 py-2 bg-primary text-primary-foreground shadow-xs hover:bg-primary/90"}}});async function u(){if(t.onclick)t.onclick();else{if(!b?.$currentPubkey)return;try{await A.repost()}catch(x){console.error("Failed to repost:",x)}}}var R=$o();R.__click=u;var P=a(R);sr(P,{size:16,class:"flex-shrink-0"});var I=s(P,2);{var S=x=>{var N=Jo(),G=X(N);ut(G,{get ndk(){return b},get pubkeys(){return A.pubkeys},get max(){return c()},get size(){return g()},get spacing(){return i()},overflowVariant:"none",skipCurrentUser:!1,get onlyFollows(){return v()}});var w=s(G,2);{var L=E=>{var z=Yo(),O=a(z,!0);o(z),Z(()=>ne(O,A.count)),r(E,z)};B(w,E=>{p()&&A.count>0&&E(L)})}r(x,N)};B(I,x=>{A.pubkeys.length>0&&x(S)})}o(R),Z(x=>{Re(R,"data-variant",n()),we(R,1,x),Re(R,"aria-label",`${A.count} ${A.count===1?"repost":"reposts"}`)},[()=>Ge(d({variant:n(),class:h()}))]),r(H,R),Ae()}Le(["click"]);var ta=m('<span class="text-sm font-medium text-muted-foreground"> </span>'),ra=m("<!> <!>",1),oa=m('<button data-reaction-button-avatars="" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" color="currentColor"><path d="M10.4107 19.9677C7.58942 17.858 2 13.0348 2 8.69444C2 5.82563 4.10526 3.5 7 3.5C8.5 3.5 10 4 12 6C14 4 15.5 3.5 17 3.5C19.8947 3.5 22 5.82563 22 8.69444C22 13.0348 16.4106 17.858 13.5893 19.9677C12.6399 20.6776 11.3601 20.6776 10.4107 19.9677Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg> <!></button>');function aa(H,t){Se(t,!0);let n=F(t,"variant",3,"ghost"),c=F(t,"emoji",3,"â¤ï¸"),g=F(t,"max",3,3),i=F(t,"avatarSize",3,24),p=F(t,"spacing",3,"tight"),v=F(t,"showCount",3,!0),h=F(t,"countMode",3,"total"),k=F(t,"onlyFollows",3,!0),b=F(t,"class",3,"");const A=rt("ndk"),d=t.ndk||A,u=St(()=>({event:t.event}),d),R=U(()=>u?.get(c())??{count:0,hasReacted:!1,pubkeys:[],emoji:c()}),P=U(()=>h()==="total"?u.totalCount:e(R).count),I=nt({base:"inline-flex items-center gap-2 cursor-pointer font-medium text-sm transition-all rounded-md outline-none disabled:pointer-events-none disabled:opacity-50",variants:{variant:{ghost:"px-3 py-2 hover:bg-accent hover:text-accent-foreground",outline:"px-3 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border",pill:"px-4 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border rounded-full",solid:"px-4 py-2 bg-primary text-primary-foreground shadow-xs hover:bg-primary/90"},active:{true:"text-red-500",false:""}}}),S=nt({base:"flex-shrink-0",variants:{active:{true:"animate-[heartbeat_0.3s_ease-in-out]",false:""}}});function x(){u.react(c()),t.onclick?.()}var N=oa();N.__click=x;var G=a(N),w=s(G,2);{var L=E=>{var z=ra(),O=X(z);ut(O,{get ndk(){return d},get pubkeys(){return e(R).pubkeys},get max(){return g()},get size(){return i()},get spacing(){return p()},overflowVariant:"none",skipCurrentUser:!1,get onlyFollows(){return k()}});var C=s(O,2);{var y=$=>{var ae=ta(),re=a(ae,!0);o(ae),Z(()=>ne(re,e(P))),r($,ae)};B(C,$=>{v()&&e(P)>0&&$(y)})}r(E,z)};B(w,E=>{e(R).pubkeys.length>0&&E(L)})}o(N),Z((E,z)=>{Re(N,"data-variant",n()),we(N,1,E),Re(N,"aria-label",`${e(P)} ${e(P)===1?"reaction":"reactions"}`),we(G,0,z),Re(G,"fill",e(R).hasReacted?"currentColor":"none")},[()=>Ge(I({variant:n(),active:e(R).hasReacted,class:b()})),()=>Ge(S({active:e(R).hasReacted}))]),r(H,N),Ae()}Le(["click"]);var na=m('<span class="text-sm font-medium text-muted-foreground"> </span>'),sa=m("<!> <!>",1),la=m('<button data-reply-button-avatars="" type="button"><!> <!></button>');function ia(H,t){Se(t,!0);let n=F(t,"variant",3,"ghost"),c=F(t,"max",3,3),g=F(t,"avatarSize",3,24),i=F(t,"spacing",3,"tight"),p=F(t,"showCount",3,!0),v=F(t,"onlyFollows",3,!0),h=F(t,"class",3,"");const k=rt("ndk"),b=t.ndk||k,A=tr(()=>({event:t.event}),b),d=nt({base:"inline-flex items-center gap-2 cursor-pointer font-medium text-sm transition-all rounded-md outline-none disabled:pointer-events-none disabled:opacity-50",variants:{variant:{ghost:"px-3 py-2 hover:bg-accent hover:text-accent-foreground",outline:"px-3 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border",pill:"px-4 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border rounded-full",solid:"px-4 py-2 bg-primary text-primary-foreground shadow-xs hover:bg-primary/90"}}});function u(){t.onclick?.()}var R=la();R.__click=u;var P=a(R);or(P,{size:16,class:"flex-shrink-0"});var I=s(P,2);{var S=x=>{var N=sa(),G=X(N);ut(G,{get ndk(){return b},get pubkeys(){return A.pubkeys},get max(){return c()},get size(){return g()},get spacing(){return i()},overflowVariant:"none",skipCurrentUser:!1,get onlyFollows(){return v()}});var w=s(G,2);{var L=E=>{var z=na(),O=a(z,!0);o(z),Z(()=>ne(O,A.count)),r(E,z)};B(w,E=>{p()&&A.count>0&&E(L)})}r(x,N)};B(I,x=>{A.pubkeys.length>0&&x(S)})}o(R),Z(x=>{Re(R,"data-variant",n()),we(R,1,x),Re(R,"aria-label",`${A.count} ${A.count===1?"reply":"replies"}`)},[()=>Ge(d({variant:n(),class:h()}))]),r(H,R),Ae()}Le(["click"]);var da=m('<span class="text-sm font-medium"> </span>'),ua=m("<!> <!>",1),ca=m('<button data-zap-button-avatars="" type="button"><!> <!></button>');function va(H,t){Se(t,!0);let n=F(t,"variant",3,"ghost"),c=F(t,"max",3,3),g=F(t,"avatarSize",3,24),i=F(t,"spacing",3,"tight"),p=F(t,"showCount",3,!0),v=F(t,"onlyFollows",3,!0),h=F(t,"class",3,"");const k=Symbol.for("event-card"),b=rt(k),A=rt("ndk"),d=t.ndk||b?.ndk||A,u=t.event||b?.event,R=U(()=>u||t.user),P=lr(()=>({target:e(R)}),d),I=U(()=>Array.from(new Set(P.events.map(zt).filter(Boolean).map(E=>E?.zapper).filter(E=>typeof E=="string")))),S=nt({base:"inline-flex items-center gap-2 cursor-pointer font-medium text-sm transition-all rounded-md outline-none disabled:pointer-events-none disabled:opacity-50",variants:{variant:{ghost:"px-3 py-2 hover:bg-accent hover:text-accent-foreground",outline:"px-3 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border",pill:"px-4 py-2 bg-background shadow-xs hover:bg-accent hover:text-accent-foreground border border-border rounded-full",solid:"px-4 py-2 bg-primary text-primary-foreground shadow-xs hover:bg-primary/90"}}});function x(){t.onclick?.(P.zap)}var N=ca();N.__click=x;var G=a(N);{let E=U(()=>e(I).length>0);dr(G,{size:16,get filled(){return e(E)},class:"flex-shrink-0"})}var w=s(G,2);{var L=E=>{var z=ua(),O=X(z);ut(O,{get ndk(){return d},get pubkeys(){return e(I)},get max(){return c()},get size(){return g()},get spacing(){return i()},overflowVariant:"none",skipCurrentUser:!1,get onlyFollows(){return v()}});var C=s(O,2);{var y=$=>{var ae=da(),re=a(ae,!0);o(ae),Z(()=>ne(re,P.totalAmount)),r($,ae)};B(C,$=>{p()&&P.totalAmount>0&&$(y)})}r(E,z)};B(w,E=>{e(I).length>0&&E(L)})}o(N),Z(E=>{Re(N,"data-variant",n()),we(N,1,E),Re(N,"aria-label",`${P.totalAmount} sats from ${P.count} ${P.count===1?"zapper":"zappers"}`)},[()=>Ge(S({variant:n(),class:h()}))]),r(H,N),Ae()}Le(["click"]);var fa=m("<!> <!> <!> <!>",1),ga=m('<div><!> <!></div> <!> <div class="mb-2"><!></div> <!>',1),pa=m("<!> <!>",1);function Pt(H,t){Se(t,!0),F(t,"showActions",3,!0);const n=F(t,"variant",3,"default");F(t,"showThreadLine",3,!1);let c=pe(!1);const g=U(()=>n()==="thread-main"?"lg":n()==="thread-reply"?"md":"sm"),i=U(()=>n()==="thread-main"?"text-lg leading-relaxed":"text-base"),p=U(()=>n()==="thread-main"?"bg-card/50":(n()==="default","hover:bg-card/30")),v=U(()=>n()==="default"||t.onNavigate!==void 0),h=U(()=>n()==="thread-main"?"full":"compact"),k=U(()=>n()==="thread-main"?"mb-2":"mb-1.5");function b(P){P(1,"test zap from agora")}function A(P){const I=ue.getUser(P);yt(`/p/${I.npub}`)}var d=pa(),u=X(d);ge(u,()=>et.Root,(P,I)=>{I(P,{get ndk(){return ue},get event(){return t.event},get interactive(){return e(v)},onclick:()=>yt(`/e/${t.event.encode()}`),onUserClick:A,get class(){return`p-3 sm:p-4 flex flex-col max-sm:max-w-screen ${e(p)??""} transition-colors min-w-0 border-b border-border`},children:(S,x)=>{var N=ga(),G=X(N),w=a(G);ge(w,()=>et.Header,(y,$)=>{$(y,{get variant(){return e(h)},get avatarSize(){return e(g)}})});var L=s(w,2);ge(L,()=>et.Dropdown,(y,$)=>{$(y,{})}),o(G);var E=s(G,2);ge(E,()=>et.ReplyIndicator,(y,$)=>{$(y,{})});var z=s(E,2),O=a(z);ge(O,()=>et.Content,(y,$)=>{$(y,{get class(){return e(i)}})}),o(z);var C=s(z,2);ge(C,()=>et.Actions,(y,$)=>{$(y,{children:(ae,re)=>{var T=fa(),j=X(T);ia(j,{get ndk(){return ue},get event(){return t.event},class:"hover:bg-muted",onclick:()=>f(c,!0)});var Y=s(j,2);aa(Y,{get ndk(){return ue},get event(){return t.event},class:"hover:bg-muted"});var oe=s(Y,2);ea(oe,{get ndk(){return ue},get event(){return t.event},class:"hover:bg-muted"});var D=s(oe,2);va(D,{get ndk(){return ue},get event(){return t.event},class:"hover:bg-muted",onclick:b}),r(ae,T)},$$slots:{default:!0}})}),Z(y=>we(G,1,y),[()=>Ge(Xt(e(k),"flex flex-row justify-between"))]),r(S,N)},$$slots:{default:!0}})});var R=s(u,2);ft(R,{get replyTo(){return t.event},get open(){return e(c)},set open(P){f(c,P,!0)}}),r(H,d),Ae()}export{ut as A,ft as C,Ka as E,Pt as N,Mr as U,kt as a,Or as u};
