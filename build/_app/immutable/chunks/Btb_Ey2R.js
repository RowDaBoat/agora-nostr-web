import{M as l,a0 as v,a5 as o,a1 as b,S as u,$ as _,aG as m,V as k,h as d,l as g,T as y,i as T,ai as A,aa as E,ab as M,ac as w,o as F,ad as p}from"./DpkVnRja.js";class R{anchor;#s=new Map;#t=new Map;#e=new Map;#a=!0;constructor(s,a=!0){this.anchor=s,this.#a=a}#r=()=>{var s=l;if(this.#s.has(s)){var a=this.#s.get(s),e=this.#t.get(a);if(e)v(e);else{var f=this.#e.get(a);f&&(this.#t.set(a,f.effect),this.#e.delete(a),f.fragment.lastChild.remove(),this.anchor.before(f.fragment),e=f.effect)}for(const[i,t]of this.#s){if(this.#s.delete(i),i===s)break;const r=this.#e.get(t);r&&(o(r.effect),this.#e.delete(t))}for(const[i,t]of this.#t){if(i===a)continue;const r=()=>{if(Array.from(this.#s.values()).includes(i)){var h=document.createDocumentFragment();m(t,h),h.append(u()),this.#e.set(i,{effect:t,fragment:h})}else o(t);this.#t.delete(i)};this.#a||!e?b(t,r,!1):r()}}};#i=s=>{this.#s.delete(s);const a=Array.from(this.#s.values());for(const[e,f]of this.#e)a.includes(e)||(o(f.effect),this.#e.delete(e))};ensure(s,a){var e=l,f=k();if(a&&!this.#t.has(s)&&!this.#e.has(s))if(f){var i=document.createDocumentFragment(),t=u();i.append(t),this.#e.set(s,{effect:_(()=>a(t)),fragment:i})}else this.#t.set(s,_(()=>a(this.anchor)));if(this.#s.set(e,s),f){for(const[r,c]of this.#t)r===s?e.skipped_effects.delete(c):e.skipped_effects.add(c);for(const[r,c]of this.#e)r===s?e.skipped_effects.delete(c.effect):e.skipped_effects.add(c.effect);e.oncommit(this.#r),e.ondiscard(this.#i)}else d&&(this.anchor=g),this.#r()}}function x(n,s,a=!1){d&&T();var e=new R(n),f=a?A:0;function i(t,r){if(d){const h=E(n)===M;if(t===h){var c=w();F(c),e.anchor=c,p(!1),e.ensure(t,r),p(!0);return}}e.ensure(t,r)}y(()=>{var t=!1;s((r,c=!0)=>{t=!0,i(c,r)}),t||i(!1,null)},f)}export{R as B,x as i};
