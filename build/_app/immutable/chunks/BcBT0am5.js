import{s as b,b as oe,g as e,p as Ke,x as be,a as ze,e as l,t as m,c as Qe,d as v,r as i,u as x,f as T,y as Xe}from"./CSbKtK4P.js";import{c as Ze,n as ve,M as ce,i as o,d as j,h as $,g as $e,e as Me,A as et,O as tt,P as rt}from"./D0X4VYcq.js";import{d as ot,f as d,a as r,c as fe,s as ee,j as ae}from"./CiPFrJr-.js";import{p as Re,i as c}from"./87vUJtvC.js";import{a as Ce,p as at}from"./DzBAiUtV.js";import{b as st}from"./I2MJeYPS.js";import{g as lt}from"./CTwadDAE.js";import{u as je}from"./B6l-2YVB.js";import{c as Ie}from"./a7XEC-kH.js";import{f as it}from"./BU5VmKcG.js";const rr=Ze();let He=oe("conversations");const or={get selected(){return e(He)},set(O){b(He,O,!0)}};function nt(O,g,P,Y,w,z){if(g()||P()){if(!e(Y)&&e(w)&&!P()){const se=e(w).getBoundingClientRect();b(z,{top:se.bottom+4,left:se.left,width:se.width},!0)}b(Y,!e(Y))}else lt("/")}function dt(O,g){o.setSelectedRelay(tt),b(g,!1)}function vt(O,g){o.setSelectedRelay(null),b(g,!1)}var ct=ae('<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),ft=ae('<svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),ut=d('<button><svg class="w-5 h-5 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <div class="flex-1"><div class="font-medium text-foreground">Following</div> <div class="text-xs text-muted-foreground">All posts from people you follow</div></div> <!></button>'),mt=d('<div class="border-t border-border my-1"></div>'),gt=(O,g,P)=>g(e(P).id),ht=d('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),pt=d('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),_t=ae('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),xt=d('<button><!> <div class="flex-1 min-w-0"><div class="text-sm font-medium text-foreground truncate"> </div> <div class="text-xs text-muted-foreground truncate"> </div></div> <!></button>'),wt=d('<!> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Follow Packs</div> <!></div>',1),kt=(O,g,P)=>g(P),yt=d('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),bt=d('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),Mt=d('<div class="text-xs text-muted-foreground truncate"> </div>'),Rt=ae('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),Ct=d('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div> <span class="flex-shrink-0 px-1.5 py-0.5 text-[10px] font-semibold bg-primary/20 text-primary rounded uppercase tracking-wide">Agora</span></div> <!></div> <!></button>'),jt=(O,g,P)=>g(e(P).url),At=d('<img alt="" class="w-5 h-5 rounded flex-shrink-0"/>'),Pt=d('<div class="w-5 h-5 rounded bg-muted flex items-center justify-center flex-shrink-0"><svg class="w-3 h-3 text-muted-foreground" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),Vt=d('<div class="text-xs text-muted-foreground truncate"> </div>'),Bt=ae('<svg class="w-5 h-5 text-primary flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>'),St=d('<button><!> <div class="flex-1 min-w-0"><div class="flex items-center gap-1.5"><div class="text-sm font-medium text-foreground truncate"> </div></div> <!></div> <!></button>'),Ft=d('<div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Other relays</div> <!></div>',1),zt=(O,g)=>b(g,!1),It=d('<button><img src="/logo-icon.svg" alt="Agoras" class="w-5 h-5"/> <div class="flex-1"><div class="font-medium text-foreground">Agoras</div> <div class="text-xs text-muted-foreground">Posts from both Agora communities</div></div> <!></button> <!> <!> <div class="border-t border-border my-1"></div> <div class="px-2 py-1"><div class="text-xs text-muted-foreground px-2 py-1 font-medium">Agoras</div> <!></div> <!> <div class="border-t border-border mt-1"><a href="/settings" class="block w-full px-4 py-2.5 text-sm text-center text-primary hover:bg-muted transition-colors">Manage Relays â†’</a></div>',1),Ht=d('<img src="/logo-icon.svg" alt="Agoras"/>'),Lt=d('<img alt=""/>'),Et=d('<div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div>'),Ot=d('<img alt=""/>'),Gt=d('<div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg></div>'),Nt=ae('<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>'),Tt=d('<span class="font-medium flex-1 text-left whitespace-nowrap overflow-hidden text-ellipsis"> </span> <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>',1),Dt=d('<div class="absolute left-0 mt-1 w-64 bg-popover border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),Ut=d('<div class="w-80 bg-card border border-border rounded-lg shadow-xl z-50 overflow-hidden"><!></div>'),Wt=d('<div class="relative"><button><!> <!></button>  <!></div>');function ar(O,g){Ke(g,!0);const P=Re(g,"active",3,!1),Y=Re(g,"collapsed",3,!1),w=Re(g,"iconOnly",3,!1);let z=oe(!1),se=x(()=>o.relays.filter(n=>n.enabled&&n.read)),Ae=x(()=>e(se).filter(n=>!rt(n.url))),_e=oe(null),ue=oe(be({top:0,left:0,width:0}));const Le=x(()=>ve.$sessions?.follows||[]),Ee=x(()=>e(Le).size>0),Oe=x(()=>!!ve.$currentUser),Pe=x(()=>e(Oe)&&e(Ee));let me=oe(be([])),ge=oe(be([]));ze(()=>{const n=it.favoritePacks;if(n.length===0){b(me,[],!0);return}Promise.all(n.map(t=>ve.fetchEvent(t))).then(t=>{b(me,t.filter(k=>k!==null),!0)}).catch(t=>{console.error("Failed to fetch favorite packs:",t),b(me,[],!0)})}),ze(()=>{const n=ve.$currentUser;if(!n){b(ge,[],!0);return}ve.fetchEvents({kinds:[39089],authors:[n.pubkey]}).then(t=>{b(ge,Array.from(t),!0)}).catch(t=>{console.error("Failed to fetch user packs:",t),b(ge,[],!0)})});const xe=x(()=>{const n=new Map;for(const t of e(ge))n.set(t.id,t);for(const t of e(me))n.set(t.id,t);return Array.from(n.values())}),he=x(()=>!o.selectedRelay||ce(o.selectedRelay)||le(o.selectedRelay)?null:je(o.selectedRelay));function le(n){return n?.startsWith("followpack:")??!1}const ie=x(()=>{if(!o.selectedRelay||!le(o.selectedRelay))return null;const n=o.selectedRelay.replace("followpack:","");return e(xe).find(t=>t.id===n||t.encode()===n)}),Ve=x(()=>ce(o.selectedRelay)?"Agoras":le(o.selectedRelay)&&e(ie)?e(ie).tagValue("title")||"Untitled Pack":o.selectedRelay&&e(he)?.info?.name?e(he).info.name:o.selectedRelay?o.selectedRelay.replace("wss://","").replace("ws://",""):"Following");function Be(n){o.setSelectedRelay(n),b(z,!1)}function Ge(n){o.setSelectedRelay(`followpack:${n}`),b(z,!1)}function Se(){b(z,!1)}var we=Wt();{const n=t=>{var k=It(),V=T(k);V.__click=[dt,z];var q=v(l(V),4);{var J=a=>{var s=ct();r(a,s)};c(q,a=>{ce(o.selectedRelay)&&a(J)})}i(V);var y=v(V,2);{var u=a=>{var s=ut();s.__click=[vt,z];var R=v(l(s),4);{var L=B=>{var E=ft();r(B,E)};c(R,B=>{o.selectedRelay||B(L)})}i(s),m(()=>j(s,1,`w-full px-4 py-3 hover:bg-muted transition-colors text-left flex items-center gap-3 ${o.selectedRelay?"":"bg-muted/50"}`)),r(a,s)};c(y,a=>{e(Pe)&&a(u)})}var G=v(y,2);{var I=a=>{var s=wt(),R=T(s);{var L=C=>{var p=mt();r(C,p)};c(R,C=>{e(Pe)&&C(L)})}var B=v(R,2),E=v(l(B),2);Me(E,17,()=>e(xe),C=>C.id,(C,p)=>{const U=x(()=>e(p).tagValue("title")||"Untitled Pack"),Q=x(()=>e(p).tagValue("image")),ne=x(()=>e(p).tagValue("description")),X=x(()=>e(p).tags.filter(F=>F[0]==="p").length),W=x(()=>le(o.selectedRelay)&&e(ie)?.id===e(p).id);var N=xt();N.__click=[gt,Ge,p];var te=l(N);{var f=F=>{var re=ht();m(()=>$(re,"src",e(Q))),r(F,re)},A=F=>{var re=pt();r(F,re)};c(te,F=>{e(Q)?F(f):F(A,!1)})}var Z=v(te,2),de=l(Z),_=l(de,!0);i(de);var S=v(de,2),ye=l(S,!0);i(S),i(Z);var qe=v(Z,2);{var Je=F=>{var re=_t();r(F,re)};c(qe,F=>{e(W)&&F(Je)})}i(N),m(()=>{j(N,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${e(W)?"bg-muted/50":""}`),ee(_,e(U)),ee(ye,e(ne)||`${e(X)} members`)}),r(C,N)}),i(B),r(a,s)};c(G,a=>{e(xe).length>0&&a(I)})}var H=v(G,4),M=v(l(H),2);Me(M,16,()=>et,a=>a,(a,s)=>{const R=x(()=>je(s));var L=Ct();L.__click=[kt,Be,s];var B=l(L);{var E=f=>{var A=yt();m(()=>$(A,"src",e(R).info.icon)),r(f,A)},C=f=>{var A=bt();r(f,A)};c(B,f=>{e(R).info?.icon?f(E):f(C,!1)})}var p=v(B,2),U=l(p),Q=l(U),ne=l(Q,!0);i(Q),Xe(2),i(U);var X=v(U,2);{var W=f=>{var A=Mt(),Z=l(A,!0);i(A),m(()=>ee(Z,e(R).info.description)),r(f,A)};c(X,f=>{e(R).info?.description&&f(W)})}i(p);var N=v(p,2);{var te=f=>{var A=Rt();r(f,A)};c(N,f=>{o.selectedRelay===s&&f(te)})}i(L),m(f=>{j(L,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${o.selectedRelay===s?"bg-muted/50":""}`),ee(ne,f)},[()=>e(R).info?.name||s.replace("wss://","").replace("ws://","")]),r(a,L)}),i(H);var h=v(H,2);{var K=a=>{var s=Ft(),R=v(T(s),2),L=v(l(R),2);Me(L,17,()=>e(Ae),B=>B.url,(B,E)=>{const C=x(()=>je(e(E).url));var p=St();p.__click=[jt,Be,E];var U=l(p);{var Q=_=>{var S=At();m(()=>$(S,"src",e(C).info.icon)),r(_,S)},ne=_=>{var S=Pt();r(_,S)};c(U,_=>{e(C).info?.icon?_(Q):_(ne,!1)})}var X=v(U,2),W=l(X),N=l(W),te=l(N,!0);i(N),i(W);var f=v(W,2);{var A=_=>{var S=Vt(),ye=l(S,!0);i(S),m(()=>ee(ye,e(C).info.description)),r(_,S)};c(f,_=>{e(C).info?.description&&_(A)})}i(X);var Z=v(X,2);{var de=_=>{var S=Bt();r(_,S)};c(Z,_=>{o.selectedRelay===e(E).url&&_(de)})}i(p),m(_=>{j(p,1,`w-full px-3 py-2.5 rounded-lg hover:bg-muted transition-colors text-left flex items-center gap-3 ${o.selectedRelay===e(E).url?"bg-muted/50":""}`),ee(te,_)},[()=>e(C).info?.name||e(E).url.replace("wss://","").replace("ws://","")]),r(B,p)}),i(R),r(a,s)};c(h,a=>{e(Ae).length>0&&a(K)})}var pe=v(h,2),ke=l(pe);ke.__click=[zt,z],i(pe),m(a=>j(V,1,`w-full px-4 py-3 hover:bg-muted transition-colors text-left flex items-center gap-3 ${a??""}`),[()=>ce(o.selectedRelay)?"bg-muted/50":""]),r(t,k)};var D=l(we);D.__click=[nt,P,w,z,_e,ue];var Fe=l(D);{var Ne=t=>{var k=Ht();m(()=>j(k,1,`${w()?"w-5 h-5":"w-6 h-6"} flex-shrink-0`)),r(t,k)},Te=t=>{var k=fe(),V=T(k);{var q=y=>{var u=fe(),G=T(u);{var I=M=>{var h=Lt();m(K=>{$(h,"src",K),j(h,1,`${w()?"w-5 h-5":"w-6 h-6"} rounded flex-shrink-0`)},[()=>e(ie).tagValue("image")]),r(M,h)},H=M=>{var h=Et(),K=l(h);i(h),m(()=>{j(h,1,`${w()?"w-5 h-5":"w-6 h-6"} rounded bg-primary flex items-center justify-center flex-shrink-0`),j(K,0,`${w()?"w-3 h-3":"w-4 h-4"} text-foreground`)}),r(M,h)};c(G,M=>{e(ie)?.tagValue("image")?M(I):M(H,!1)})}r(y,u)},J=y=>{var u=fe(),G=T(u);{var I=M=>{var h=Ot();m(()=>{$(h,"src",e(he).info.icon),j(h,1,`${w()?"w-5 h-5":"w-6 h-6"} rounded flex-shrink-0`)}),r(M,h)},H=M=>{var h=fe(),K=T(h);{var pe=a=>{var s=Gt(),R=l(s);i(s),m(()=>{j(s,1,`${w()?"w-5 h-5":"w-6 h-6"} rounded bg-primary flex items-center justify-center flex-shrink-0`),j(R,0,`${w()?"w-3 h-3":"w-4 h-4"} text-foreground`)}),r(a,s)},ke=a=>{var s=Nt();m(()=>j(s,0,w()?"w-5 h-5 text-muted-foreground":"w-6 h-6")),r(a,s)};c(K,a=>{o.selectedRelay?a(pe):a(ke,!1)},!0)}r(M,h)};c(G,M=>{o.selectedRelay&&e(he)?.info?.icon?M(I):M(H,!1)},!0)}r(y,u)};c(V,y=>{le(o.selectedRelay)?y(q):y(J,!1)},!0)}r(t,k)};c(Fe,t=>{ce(o.selectedRelay)?t(Ne):t(Te,!1)})}var De=v(Fe,2);{var Ue=t=>{var k=Tt(),V=T(k),q=l(V,!0);i(V);var J=v(V,2);m(()=>{ee(q,e(Ve)),j(J,0,`w-4 h-4 transition-transform ${e(z)?"rotate-180":""}`)}),r(t,k)};c(De,t=>{!Y()&&!w()&&t(Ue)})}i(D),st(D,t=>b(_e,t),()=>e(_e));var We=v(D,2);{var Ye=t=>{var k=fe(),V=T(k);{var q=y=>{var u=Dt(),G=l(u);n(G),i(u),Ce(u,(I,H)=>Ie?.(I,H),()=>Se),r(y,u)},J=y=>{var u=Ut(),G=l(u);n(G),i(u),Ce(u,I=>at?.(I)),Ce(u,(I,H)=>Ie?.(I,H),()=>Se),m(()=>$e(u,`position: fixed; top: ${e(ue).top??""}px; left: ${e(ue).left??""}px; min-width: ${e(ue).width??""}px;`)),r(y,u)};c(V,y=>{w()?y(q):y(J,!1)})}r(t,k)};c(We,t=>{e(z)&&(P()||w())&&t(Ye)})}i(we),m(()=>{j(D,1,w()?"flex items-center justify-center w-8 h-8 rounded-full hover:bg-muted/50 transition-colors":Y()?"flex items-center justify-center p-3 rounded-lg transition-colors w-full "+(P()?"text-primary bg-primary/10":"text-muted-foreground hover:bg-muted/50"):"flex items-center gap-3 px-4 py-3 rounded-lg transition-colors w-full "+(P()?"text-primary bg-primary/10":"text-muted-foreground hover:bg-muted/50")),$(D,"aria-label",o.selectedRelay?"Change filter":"Change following filter"),$(D,"title",Y()?e(Ve):void 0)})}r(O,we),Qe()}ot(["click"]);export{ar as R,rr as c,or as h};
